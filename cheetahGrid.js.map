{"version":3,"sources":["cheetahGrid/webpack/universalModuleDefinition","cheetahGrid/webpack/bootstrap","cheetahGrid/./columns/action/internal/InlineInputElement.css","cheetahGrid/./columns/action/internal/InlineMenuElement.css","cheetahGrid/./columns/action/internal/SmallDialogInputElement.css","cheetahGrid/./columns/message/internal/ErrorMessageElement.css","cheetahGrid/./columns/message/internal/MessageElement.css","cheetahGrid/./columns/message/internal/WarningMessageElement.css","cheetahGrid/./internal/style.css","cheetahGrid/node_modules/css-loader/lib/css-base.js","cheetahGrid/node_modules/style-loader/lib/addStyles.js","cheetahGrid/node_modules/style-loader/lib/urls.js","cheetahGrid/node_modules/material-design-icons/content/svg/production/ic_add_48px.svg","cheetahGrid/node_modules/material-design-icons/image/svg/production/ic_edit_48px.svg","cheetahGrid/node_modules/material-design-icons/navigation/svg/production/ic_arrow_downward_48px.svg","cheetahGrid/node_modules/material-design-icons/navigation/svg/production/ic_arrow_upward_48px.svg","cheetahGrid/node_modules/material-design-icons/toggle/svg/production/ic_star_24px.svg","cheetahGrid/node_modules/material-design-icons/toggle/svg/production/ic_star_border_24px.svg","cheetahGrid/node_modules/material-design-icons/toggle/svg/production/ic_star_half_24px.svg","cheetahGrid/./GridCanvasHelper.js","cheetahGrid/./ListGrid.js","cheetahGrid/./columns.js","cheetahGrid/./columns/action.js","cheetahGrid/./columns/action/Action.js","cheetahGrid/./columns/action/BaseAction.js","cheetahGrid/./columns/action/BaseInputEditor.js","cheetahGrid/./columns/action/ButtonAction.js","cheetahGrid/./columns/action/CheckEditor.js","cheetahGrid/./columns/action/Editor.js","cheetahGrid/./columns/action/InlineInputEditor.js","cheetahGrid/./columns/action/InlineMenuEditor.js","cheetahGrid/./columns/action/SmallDialogInputEditor.js","cheetahGrid/./columns/action/actionBind.js","cheetahGrid/./columns/action/internal/InlineInputElement.css*","cheetahGrid/./columns/action/internal/InlineInputElement.js","cheetahGrid/./columns/action/internal/InlineMenuElement.css*","cheetahGrid/./columns/action/internal/InlineMenuElement.js","cheetahGrid/./columns/action/internal/SmallDialogInputElement.css*","cheetahGrid/./columns/action/internal/SmallDialogInputElement.js","cheetahGrid/./columns/message/BaseMessage.js","cheetahGrid/./columns/message/ErrorMessage.js","cheetahGrid/./columns/message/InfoMessage.js","cheetahGrid/./columns/message/MessageHandler.js","cheetahGrid/./columns/message/WarningMessage.js","cheetahGrid/./columns/message/internal/ErrorMessageElement.css*","cheetahGrid/./columns/message/internal/ErrorMessageElement.js","cheetahGrid/./columns/message/internal/MessageElement.css*","cheetahGrid/./columns/message/internal/MessageElement.js","cheetahGrid/./columns/message/internal/WarningMessageElement.css*","cheetahGrid/./columns/message/internal/WarningMessageElement.js","cheetahGrid/./columns/style.js","cheetahGrid/./columns/style/BaseStyle.js","cheetahGrid/./columns/style/BranchGraphStyle.js","cheetahGrid/./columns/style/ButtonStyle.js","cheetahGrid/./columns/style/CheckStyle.js","cheetahGrid/./columns/style/IconStyle.js","cheetahGrid/./columns/style/ImageStyle.js","cheetahGrid/./columns/style/NumberStyle.js","cheetahGrid/./columns/style/PercentCompleteBarStyle.js","cheetahGrid/./columns/style/StdBaseStyle.js","cheetahGrid/./columns/style/Style.js","cheetahGrid/./columns/type.js","cheetahGrid/./columns/type/BaseColumn.js","cheetahGrid/./columns/type/BranchGraphColumn.js","cheetahGrid/./columns/type/ButtonColumn.js","cheetahGrid/./columns/type/CheckColumn.js","cheetahGrid/./columns/type/Column.js","cheetahGrid/./columns/type/IconColumn.js","cheetahGrid/./columns/type/ImageColumn.js","cheetahGrid/./columns/type/MenuColumn.js","cheetahGrid/./columns/type/NumberColumn.js","cheetahGrid/./columns/type/PercentCompleteBarColumn.js","cheetahGrid/./columns/type/columnUtils.js","cheetahGrid/./core.js","cheetahGrid/./core/DrawGrid.js","cheetahGrid/./core/EventTarget.js","cheetahGrid/./data.js","cheetahGrid/./data/CachedDataSource.js","cheetahGrid/./data/DataSource.js","cheetahGrid/./element/Inline.js","cheetahGrid/./element/InlineDrawer.js","cheetahGrid/./element/InlineIcon.js","cheetahGrid/./element/InlineImage.js","cheetahGrid/./element/InlinePath2D.js","cheetahGrid/./element/InlineSvg.js","cheetahGrid/./element/inlines.js","cheetahGrid/./header/style.js","cheetahGrid/./header/style/BaseStyle.js","cheetahGrid/./header/style/Style.js","cheetahGrid/./header/type.js","cheetahGrid/./header/type/BaseHeader.js","cheetahGrid/./header/type/Header.js","cheetahGrid/./header/type/SortHeader.js","cheetahGrid/./icons.js","cheetahGrid/./internal/EventHandler.js","cheetahGrid/./internal/LRUCache.js","cheetahGrid/./internal/NumberMap.js","cheetahGrid/./internal/Rect.js","cheetahGrid/./internal/Scrollable.js","cheetahGrid/./internal/animate.js","cheetahGrid/./internal/calc.js","cheetahGrid/./internal/canvases.js","cheetahGrid/./internal/color.js","cheetahGrid/./internal/com.js","cheetahGrid/./internal/dom.js","cheetahGrid/./internal/fonts.js","cheetahGrid/./internal/hiDPI.js","cheetahGrid/./internal/icons.js","cheetahGrid/./internal/imgs.js","cheetahGrid/./internal/legacy/canvas/Path2D.js","cheetahGrid/./internal/legacy/canvas/PathCommands.js","cheetahGrid/./internal/legacy/canvas/PathCommandsParser.js","cheetahGrid/./internal/legacy/fontwatch/FontRuler.js","cheetahGrid/./internal/legacy/fontwatch/FontWatchRunner.js","cheetahGrid/./internal/menu-items.js","cheetahGrid/./internal/path2DManager.js","cheetahGrid/./internal/sort.js","cheetahGrid/./internal/style.css*","cheetahGrid/./internal/style.js","cheetahGrid/./internal/symbolManager.js","cheetahGrid/./internal/utils.js","cheetahGrid/./list-grid/EVENT_TYPE.js","cheetahGrid/./main.js","cheetahGrid/./plugins/icons.js","cheetahGrid/./plugins/themes.js","cheetahGrid/./register.js","cheetahGrid/./themes.js","cheetahGrid/./themes/BASIC.js","cheetahGrid/./themes/MATERIAL_DESIGN.js","cheetahGrid/./themes/theme.js","cheetahGrid/./tools.js","cheetahGrid/./tools/canvashelper.js"],"names":["calcStartPosition","require","inlines","canvashelper","themes","colorToRGB","Rect","getChainSafe","getOrApply","style","toBoxArray","fonts","calc","invalidateCell","context","grid","col","row","getColor","color","getThemeColor","names","theme","default","testFontLoad","font","value","check","load","drawInlines","ctx","rect","offset","drawInline","inline","offsetLeft","offsetRight","canDraw","save","fillStyle","draw","restore","onReady","length","inlineWidths","map","width","reduce","a","b","forEach","index","inlineWidth","_inlineRect","textAlign","textBaseline","icons","actInlines","buildInlines","drawCheckbox","helper","animElapsedTime","uncheckBgColor","checkbox","checkBgColor","borderColor","boxWidth","measureCheckbox","pos","uncheckBgRGB","checkBgRGB","checkRGB","colorName","start","end","diff","Math","ceil","uncheckRGB","x","y","Theme","constructor","_grid","name","underlayBackgroundColor","frozenRowsColor","defaultBgColor","frozenRowsBgColor","selectionBgColor","frozenRowsBorderColor","hiliteBorderColor","_checkbox","button","_button","bgColor","strokeRect","left","top","height","strokeStyle","borderColors","strokeColorsRect","GridCanvasHelper","_theme","createCalculator","calcWidth","toPx","full","getRect","em","getContext","measureText","calcHeight","obj","toBoxPixelArray","calculator","box","drawWithClip","drawRect","getDrawRect","beginPath","clip","drawBorderWithClip","clipLeft","clipWidth","clipTop","clipHeight","text","padding","isFrozenCell","fillText","fillCell","fillColor","fill","fillCellWithState","option","getFillColorState","fillRect","fillRectWithState","state","getSelectState","selected","selection","border","lineWidth","startOffset","borderWithState","sel","select","moveTo","lineTo","bottom","stroke","right","caption","shadow","drawButton","radius","module","exports","isDef","isPromise","then","isObject","columns","BaseStyle","headerType","HeaderBaseStyle","DrawGrid","DataSource","CachedDataSource","MessageHandler","EVENT_TYPE","PROTECTED_SYMBOL","_","headerId","_getHeaderCellRange","headerMap","getHeaderCellRange","_updateRect","startCol","endCol","startRow","endRow","c","getColWidth","r","getRowHeight","setRect","_getCellValue","rowCount","getCell","field","get","set","_getField","_setCellValue","_getRowRecordIndex","res","dataSource","setField","_getCellMessage","message","_getCellIcon0","icon","i","retIcon","iconPropKeys","k","f","_hasField","_getCellIcon","getField","hasField","_onDrawValue","cellValue","gridCanvasHelper","drawCellBg","fillOpt","drawCellBorder","frozenColCount","frozenRowCount","_headerBorderWithState","drawCellBase","info","getRecord","getRowRecord","getIcon","getMessage","messageHandler","id","selId","_refreshHeader","headerEvents","unlisten","HeaderMap","header","headerObjects","cell","ids","bindGridEvent","push","listen","CHANGE_STYLE","invalidate","action","isTarget","columnType","colCount","_refreshRowCount","column","minWidth","maxWidth","setColWidth","setMinColWidth","setMaxColWidth","isArrayHeaderRowHeight","headerRowHeight","setRowHeight","_tryWithUpdateDataSource","fn","dataSourceEventIds","handler","off","on","UPDATED_LENGTH","UPDATED_ORDER","_setRecords","records","ofArray","_setDataSource","EMPTY","undefined","_columns","_headerCells","_headerObjects","_addHeaders","_setupHeaderType","getHeaderCellRangeById","result","isCellInRange","roots","rowCells","_newRow","hd","headerStyle","sort","type","of","define","range","create","newRow","prev","adjustListGridOption","options","ListGrid","sortState","order","window","updateSize","updateScroll","dispose","getGridCanvasHelper","getCopyCellValue","onDrawCell","doGetCellValue","valueCallback","doChangeValue","changeValueCallback","before","after","ret","self","fireListeners","CHANGED_VALUE","record","bindEventsInternal","SELECTED_CELL","e","invalidateGridRect","getMoveLeftColByKeyDownInternal","getMoveRightColByKeyDownInternal","getMoveUpRowByKeyDownInternal","getMoveDownRowByKeyDownInternal","getOffsetInvalidateCells","getColumnIndexByField","columnIndex","focusGridCell","newCol","focusCell","makeVisibleGridCell","makeVisibleCell","BaseAction","Action","Editor","CheckEditor","ButtonAction","SmallDialogInputEditor","InlineInputEditor","InlineMenuEditor","ImmutableCheckEditor","disabled","_disabled","readOnly","_readOnly","ImmutableInputEditor","ACTIONS","CHECK","INPUT","console","warn","columnAction","DEFAULT","toUpperCase","bindCellClickAction","bindCellKeyAction","_action","clone","getState","util","mouseOver","mouseActiveCell","mouseOut","onChangeDisabledInternal","INPUT_CELL","EDITABLEINPUT_CELL","DBLCLICK_CELL","DBLTAP_CELL","KEYDOWN","MODIFY_STATUS_EDITABLEINPUT_CELL","SCROLL","KEY_ENTER","KEY_F2","BaseInputEditor","onInputCellInternal","inputValue","Error","onOpenCellInternal","onChangeSelectCellInternal","onSetInputAttrsInternal","input","onGridScrollInternal","open","event","preventDefault","stopPropagation","keyCode","setReadonly","BUTTON_COLUMN_STATE_ID","animate","CHECK_COLUMN_STATE_ID","KEY_SPACE","toggleValue","val","match","replace","key","blockKey","onChange","point","elapsed","selrange","acceptKeys","onChangeReadOnlyInternal","InlineInputElement","INLINE_INPUT_EDITOR_STATE_ID","globalElement","bindGridCount","attachInput","editor","element","addDisposable","attach","detachInput","gridFocus","detach","_classList","classList","_type","setInputAttrs","normalize","CLICK_CELL","MOUSEOVER_CELL","MOUSEOUT_CELL","MOUSEMOVE_CELL","InlineMenuElement","INLINE_MENU_EDITOR_STATE_ID","attachMenu","detachMenu","_options","getElement","cursor","SmallDialogInputElement","SMALL_DIALOG_INPUT_EDITOR_STATE_ID","_helperText","helperText","_inputValidator","inputValidator","_validator","validator","_inputDialogManager","cancel","indexOf","getKeyCode","cancelEvent","EventHandler","createElement","CLASSNAME","createInputElement","add","args","_handler","_input","_bindInputEvents","_beforePropEditor","remove","getAttachCellArea","toFixed","appendChild","_activeData","focus","selectionStart","selectionEnd","document","createTextRange","collapse","moveEnd","moveStart","tryWithOffEvents","_isActive","parentElement","removeChild","stopPropagationOnly","contains","appendHtml","empty","disableFocus","isFocusable","findPrevSiblingFocusable","findNextSiblingFocusable","KEY_TAB","KEY_UP","KEY_DOWN","KEY_ESC","ITEM_CLASSNAME","HIDDEN_CLASSNAME","SHOWN_CLASSNAME","EMPTY_ITEM_CLASSNAME","findItemParents","target","el","createMenuElement","attachElement","menu","optionToLi","html","item","tabIndex","dataset","valueindex","span","openMenu","emptyItemEl","valueItemEl","focusEl","children","Array","prototype","slice","call","focusIndex","allHeight","offsetHeight","offsetTop","menuClientRect","getBoundingClientRect","scaleDiff","orgMenuTop","menuTop","menuBottom","winBottom","innerHeight","winMargin","closeMenu","_menu","_bindMenuEvents","_doChangeValue","n","shiftKey","querySelector","items","querySelectorAll","INPUT_CLASSNAME","_focus","createDialogElement","readonly","bindProps","dialog","unbindProps","_dialog","_bindDialogEvents","errorMessage","activeData","_onInputValue","_beforeValue","_validate","onKeyupAndPress","_onInputValueChange","inputOnly","BaseMessage","detachMessageElement","_messageElement","_getMessageElement","createMessageElementInternal","drawCellMessageInternal","attachMessageElement","messageElement","moveMessageElement","move","_detach","drawCellMessage","ErrorMessageElement","RED_A100","ErrorMessage","boxRect","copy","MessageElement","GREY_L2","InfoMessage","WarningMessage","_messageInstances","_bindGridEvent","messageInstances","instance","_getMessageInstanceOfMessage","_attach","_attachInfo","_toMessageText","_move","onSelectMessage","_createMessageInstance","toLowerCase","Message","WarningMessageElement","DEEP_ORANGE_A100","MESSAGE_CLASSNAME","_rootElement","createrootElement","rootElement","_attachCell","textContent","frozenRect","offsetWidth","Style","NumberStyle","CheckStyle","ButtonStyle","ImageStyle","IconStyle","PercentCompleteBarStyle","columnStyle","StyleClass","EventTarget","defaultStyle","_bgColor","doChangeStyle","adj","DEFAULT_BRANCH_COLORS","BranchGraphStyle","_branchColors","branchColors","_margin","margin","_circleSize","circleSize","_branchLineWidth","branchLineWidth","_mergeStyle","mergeStyle","buttonBgColor","_buttonBgColor","StdBaseStyle","_uncheckBgColor","_checkBgColor","_borderColor","_imageSizing","imageSizing","DEFAULT_BAR_COLOR","num","_barColor","barColor","_barBgColor","barBgColor","_barHeight","barHeight","_textAlign","_textBaseline","_color","_font","_padding","Column","NumberColumn","CheckColumn","ButtonColumn","ImageColumn","PercentCompleteBarColumn","IconColumn","BranchGraphColumn","MenuColumn","TYPES","NUMBER","BUTTON","IMAGE","styleContents","COLUMN_FADEIN_STATE_ID","isFadeinWhenCallbackInPromise","_fadeinWhenCallbackInPromise","configure","getFadinState","_generateFadinPointAction","drawInternal","stateKey","opacity","cellState","globalAlpha","fadinMgr","activeFadeins","margeAnimate","BaseColumn","bind","fadeinWhenCallbackInPromise","drawing","Date","now","currentContext","toCurrentContext","time","actStyle","convertInternal","drawMessageInternal","BRANCH_GRAPH_COLUMN_STATE_ID","getAllColumnData","callback","allData","promise","data","dataIndex","d","BranchLine","fromIndex","toIndex","colorIndex","BranchPoint","commit","lines","tag","mergeLines","filter","l","froms","tos","t","splice","concat","merge","joinLine","timeline","branchIndex","reverse","j","tl","branch","branches","from","to","findBranchRootIndex","fromTargetIndex","branchTargetFromIndex","branchPoint","targetLine","commitTag","commitMerge","fromTargetLine","pop","calcCommand","command","timelineData","commands","cmd","calcBranchesInfo","calcBranchXPoints","w","max","p","textWidth","renderMerge","upLineIndex","downLineIndex","branchXPoints","lineCap","upX","upRect","getCellRelativeRect","upY","bezierCurveTo","downX","downRect","downY","_start","_cache","cache","clearCache","upLineIndexKey","downLineIndexKey","line","pointIndex","arc","PI","closePath","utils","_caption","withCaption","active","loadIcons","blur","offsetY","toBoolean","opt","repeatArray","count","Infinity","_tagName","tagName","_className","className","_content","content","_name","_iconWidth","iconWidth","isNaN","getCacheOrLoad","MAX_LRU_CACHE_SIZE","getImage","url","calcKeepAspectRatioSize","maxHeight","newWidth","newHeight","drawImage","withOptions","_convertInternal","basePadding","textPadding","iconPadding","path","defaultFotmat","Intl","NumberFormat","fmt","_format","format","withFormat","str","MARGIN","_min","min","_max","_formatter","formatter","v","svalue","endsWith","substr","rate","barMaxWidth","barTop","barLeft","barSize","loadIcon","iconList","toNormarizeArray","browser","isDescendantElement","array","isTouchEvent","getMouseButtons","Scrollable","NumberMap","hiDPI","createRootElement","KEY_END","KEY_HOME","KEY_LEFT","KEY_RIGHT","KEY_ALPHA_C","MOUSEDOWN_CELL","MOUSEUP_CELL","MOUSEENTER_CELL","MOUSELEAVE_CELL","RESIZE_COLUMN","_vibrate","navigator","vibrate","_getTargetRowAt","absoluteY","internal","getTargetRowAtInternal","findBefore","startBottom","_getRowHeight","findAfter","candRow","defaultRowHeight","_getRowsHeight","_getTargetColAt","absoluteX","_getColWidth","_getTargetFrozenRowAt","scroll","_getTargetFrozenColAt","_getFrozenRowsRect","canvas","_getFrozenColsRect","_isCellDrawing","drawCells","_putCellDrawing","_removeCellDrawing","Object","keys","_drawCell","absoluteLeft","absoluteTop","visibleRect","skipAbsoluteTop","skipAbsoluteLeft","drawLayers","bounds","dcContext","DrawCellContext","pCol","_delayMode","terminate","_drawRow","initFrozenCol","initCol","drawRight","drawOuter","outerLeft","_invalidateRect","_getVisibleRect","_getInitContext","initRow","_getColsWidth","drawBottom","initFrozenRow","DrawLayers","outerTop","_toPxWidth","round","calcWidthContext","_getDefaultColPxWidth","defaultColWidth","_adjustColWidth","orgWidth","limit","colWidthsLimit","colWidthsMap","_setColWidth","put","each","getRowHeightInternal","rowHeightsMap","_setRowHeight","getRowsHeightInternal","h","_getScrollWidth","eachAll","_getScrollHeight","getScrollHeightInternal","_onScroll","lastLeft","lastTop","moveX","scrollable","scrollLeft","moveY","scrollTop","abs","redrawRect","_onKeyDownMove","_sel","_moveFocusCell","ctrlKey","extendRange","beforeRange","beforeRect","getCellsRect","_setFocusCell","afterRange","afterRect","intersection","invalidateRect","_getMouseAbstractPoint","changedTouches","clientX","pageX","scrollX","clientY","pageY","scrollY","_bindEvents","getCellEventArgsSet","abstractPos","getCellAt","eventArgs","canResizeColumn","eventArgsSet","results","findIndex","resizeCol","_getResizeColAt","columnResizer","cellSelector","doubleTapBefore","longTouchId","setTimeout","defaultPrevented","clearTimeout","isMouseover","mouseEnterCell","mouseOverCell","onMouseenterCell","onMouseleaveCell","beforeMouseCell","onMouseoverCell","onMouseoutCell","scrollElement","moving","lastMoving","hasListeners","focusControl","onScroll","onKeyDownMove","copyValue","copyCellValue","Promise","strCellValue","onCopy","find","onInput","abstractX","abstractY","inPoint","cellRect","getCellRect","_getScrollableVisibleRect","frozenColsWidth","frozenRowsHeight","_toRelativeRect","absoluteRect","BaseMouseDownMover","_events","_started","_moved","last","_mouseEndPoint","pt","_bindMoveAndUp","mousemove","body","_mouseMove","mouseup","_mouseUp","touchmove","passive","touchend","touchcancel","_moveInternal","_upInternal","CellSelector","_getTargetCell","_cell","makeVisibleCol","makeVisibleRow","ColumnResizer","_targetCol","_x","_preX","_invalidateAbsoluteLeft","pre","afterSize","setSafeInputValue","FocusControl","_scrollable","_isComposition","metaKey","inputClear","IE","clipboardData","setData","setFocusRect","calcTop","getScrollBarSize","editMode","resetInputStatus","composition","atts","attributes","removeNames","att","_inputStatus","hasOwnProperty","nodeName","removeName","removeAttribute","setAttribute","storeInputStatus","setDefaultInputStatus","Selection","_end","inCell","_wrapFireSelectedEvent","_setSelectCell","keepSelect","_isWraped","_layers","addDraw","level","DrawLayer","list","_level","_list","_col","_row","_mode","_ctx","_rect","_drawRect","_drawing","_selection","_drawLayers","_toRelativeDrawRect","addLayerDraw","fRect","onTerminate","_onTerminate","initDocument","transform","alpha","cfg","config","floor","setScrollSize","getMaxColWidth","maxwidth","getMinColWidth","minwidth","isFrozenStartCell","isFrozenEndCell","isFrozenRow","isFrozenCol","getRowAt","frozen","getColAt","oldEditMode","selCol","selRow","cellsRect","invalidateTarget","disposable","disposables","nextId","listeners","listenerData","listener","addEventListener","removeEventListener","_setFieldCache","_fCache","recCache","_rCache","getOriginal","getOriginalField","setOriginalField","fCache","fieldPromiseCallBackInternal","recordPromiseCallBackInternal","applyChainSafe","emptyFn","UPDATE_LENGTH","getValue","setPromiseBack","ss","split","_getIndex","_sortedIndexMap","mapIndex","_get","_length","hasOriginalField","sortedIndexMap","orderFn","v1","v2","sortPromise","rel","Inline","fillTextRect","InlineDrawer","_draw","_width","_height","InlineIcon","_icon","InlineImage","src","imageLeft","imageTop","imageWidth","imageHeight","_src","_imageLeft","_imageTop","_imageWidth","_imageHeight","_onloaded","_loaded","s","_loadImage","img","_inlineImg","drawInlineImageRect","path2DManager","InlinePath2D","_path","Path2D","translate","buildSvgDataUrl","svg","XMLSerializer","serializeToString","encodeURIComponent","getSvgElement","parser","DOMParser","parseFromString","InlineSvg","svgElem","elmWidth","getAttribute","elmHeight","drawRegisteredIcon","drawWidth","drawHeight","iconOf","regedIcons","regedIcon","il","Header","SortHeader","headerCell","BaseHeader","_headerCell","_sort","_range","arrowSize","_executeSort","newState","extend","plugins","builtins","arrow_upward","arrow_downward","edit","star","star_border","star_half","_listeners","fire","hasListener","clear","LRUCache","cacheSize","_map","_cacheSize","idx","remKey","shift","indexFirst","ary","elm","low","high","_keys","_vals","_sorted","keyFrom","keyTo","_left","_top","rect1","rect2","_right","_bottom","x0","x1","y0","y1","another","MAX_SCROLL","heightLimit","_update","domHeight","sbSize","vScrollRange","rScrollRange","_p","_endPointElement","relativeTop","scrollWidth","scrollHeight","cubicBezier","x2","y2","x3","y3","step","err","EASINGS","linear","easeIn","easeOut","easeInOut","raf","requestAnimationFrame","duration","easing","startedAt","canceledFlg","createAnim","resolve","reject","anim","parse","calcStr","replacer","unit","script","eval","test","trim","calcBasePosition","paddingLeft","paddingRight","rgbMap","styleColorToRGB","dummy","position","styleColor","defaultView","getComputedStyle","colorToRGB0","hexToNum","hex","parseInt","createRGB","g","tripleHexToRGB","sextupleHexToRGB","r1","r2","g1","g2","b1","b2","testRGB","rateToByte","rgb","isArray","innerHTML","dom","firstChild","isNode","arg","nodeType","toNode","childNodes","toNodeList","jQuery","inner","node","disableBeforeTabIndex","enableFocus","previousSibling","nextSibling","loads","legacy","testStr","all","ready","ratio","setRatio","devicePixelRatio","wh","scale","defineProperty","configurable","enumerable","ICON_PROP_KEYS","quote","quoted","part","join","doms","props","getIconProps","tagProps","beforeStyle","getPropertyValue","clientWidth","isLiga","toPropArray","prop","toSimpleArray","iconProps","workData","normarize","allCache","isDataUrl","search","loadImage","error","Image","onload","onerror","getCacheOrLoad0","cacheName","PathCommandsParser","_ops","op","CanvasRenderingContext2D","originalFill","apply","mag","sqrt","pow","dot","u","clamp","angle","sign","acos","rotClockwise","cost","cos","sint","sin","rotCounterClockwise","midPoint","meanVec","pointMul","sum","ellipseFromEllipticalArc","rx","ry","phi","fA","fS","xPrime","xPrime2","rx2","ry2","lambda","factor","cPrime","x1UnitVector","x2UnitVector","theta","deltaTheta","rotate","PathCommands","lMx","lMy","lx","ly","reflected","lastCommand","makeReflected","M","px","py","m","L","H","V","Z","z","C","cp1x","cp1y","cp2x","cp2y","S","cpx","cpy","Q","quadraticCurveTo","q","T","A","xAxisRotation","largeArcFlag","sweepFlag","pathTokens","next","builder","argsProvider","canvasOperations","_commands","ops","tokens","subsequentCommand","fst","log","computeStyle","display","FontRuler","el_","getWidth","LastResortFonts","SERIF","SANS_SERIF","watchRunners","FontWatchRunner","activeCallback","inactiveCallback","runner","activeCallbacks","inactiveCallbacks","status","lastResortWidths_","fontRulerA_","fontRulerB_","lastResortRulerA","lastResortRulerB","started_","check_","widthA","widthB","isFallbackFont_","isLastResortFont_","finish_","widthMatches_","widthsMatchLastResortWidths_","lastResortFont","hasWebKitFallbackBug","callbacks","cb","HAS_WEBKIT_FALLBACK_BUG","exec","userAgent","JSON","getPath2D","ud","upsideDown","offsetX","xrate","yrate","path2d","wait","createArray","createArrayPromise","plist","setArrayField","compare","old","sortArray","dummyPromise","catch","getScrollBarWidth","SCROLLBAR_SIZE","head","Symbol","mem","arrayFind","arrayFindIndex","arr","predicate","ua","Chrome","Firefox","source","root","searchString","subjectString","toString","isFinite","lastIndex","lastIndexOf","buttons","which","getIgnoreCase","core","tools","register","_internal","symbolManager","themePlugins","iconPlugins","registers","values","BASIC","MATERIAL_DESIGN","builtin","defTheme","defaultTheme","choices","DEFAULT_BG_COLOR","cacheLinearGradient","getLinearGradient","colorStops","stop","stopsKey","grad","createLinearGradient","addColorStop","FROZEN_ROWS_BG_COLOR","FROZEN_ROWS_BORDER_COLOR","BORDER_COLOR","getProp","superObj","defNames","createTheme","superTheme","extends","strokeRectLines","positions","preColor","pos1","pos2","roundRect","fillRoundRect","strokeRoundRect","image","srcLeft","srcTop","srcWidth","srcHeight","destWidth","destHeight","boxSize","checkPoint","leftWidth","rightWidth","leftLeftPos","leftTopPos","backgroundColor","ox","oy","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],"mappings":"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;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,8CAA8C;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA,iBAAiB,mBAAmB;AACpC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,iBAAiB,sBAAsB;AACvC;;AAEA;AACA,mBAAmB,2BAA2B;;AAE9C;AACA;AACA;AACA;AACA;;AAEA;AACA,gBAAgB,mBAAmB;AACnC;AACA;;AAEA;AACA;;AAEA,iBAAiB,2BAA2B;AAC5C;AACA;;AAEA,QAAQ,uBAAuB;AAC/B;AACA;AACA,GAAG;AACH;;AAEA,iBAAiB,uBAAuB;AACxC;AACA;;AAEA,2BAA2B;AAC3B;AACA;AACA;;AAEA;AACA;AACA;;AAEA,gBAAgB,iBAAiB;AACjC;AACA;AACA;AACA;AACA;AACA,cAAc;;AAEd,kDAAkD,sBAAsB;AACxE;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA,EAAE;AACF;AACA,EAAE;AACF;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,EAAE;AACF;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;;AAEA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,EAAE;AACF;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD;AACvD;;AAEA,6BAA6B,mBAAmB;;AAEhD;;AAEA;;AAEA;AACA;;;;;;;;;;;;;;ACtXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,WAAW,EAAE;AACrD,wCAAwC,WAAW,EAAE;;AAErD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,sCAAsC;AACtC,GAAG;AACH;AACA,8DAA8D;AAC9D;;AAEA;AACA;AACA,EAAE;;AAEF;AACA;AACA;;;;;;;;;;;;;ACxFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,E;;;;;;;;;;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,E;;;;;;;;;;;;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,E;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","file":"cheetahGrid.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"cheetahGrid\"] = factory();\n\telse\n\t\troot[\"cheetahGrid\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./main.js\");\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".cheetah-grid__inline-input::-ms-clear{visibility:hidden}.cheetah-grid__inline-input{position:absolute;box-sizing:border-box}\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".cheetah-grid__inline-menu{position:absolute;color:rgba(0,0,0,.87);box-sizing:content-box;margin:-1px auto auto -1px;padding:8px 0;background-color:#fafafa;list-style-type:none;border-radius:2px;max-height:calc(100vh - 40px);overflow-y:auto}.cheetah-grid__inline-menu--hidden{transform:scale(.9);box-shadow:none;opacity:0;pointer-events:none;transition:all 50ms ease-out}.cheetah-grid__inline-menu--hidden *{pointer-events:none}.cheetah-grid__inline-menu--shown{transform:translateY(-7px);box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);opacity:1;transition:all .15s ease-out}.cheetah-grid__inline-menu__menu-item{height:100%;box-sizing:border-box;display:flex;align-items:center;justify-content:flex-start;outline:none;cursor:pointer;position:relative;overflow:hidden;padding:0 16px}.cheetah-grid__inline-menu__menu-item--empty{color:rgba(0,0,0,.38)}.cheetah-grid__inline-menu__menu-item:before{content:\\\"\\\";position:absolute;top:-50%;left:-50%;width:200%;height:200%;background-color:#000;opacity:0;pointer-events:none;transition:opacity 15ms linear}.cheetah-grid__inline-menu__menu-item:hover:before,.cheetah-grid__inline-menu__menu-item[data-select]:before{opacity:.04}.cheetah-grid__inline-menu__menu-item:focus:before{opacity:.12}\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".cheetah-grid__small-dialog-input__input::-ms-clear{visibility:hidden}@keyframes cheetah-grid__small-dialog-input--hidden-animation{0%{opacity:1}99%{opacity:1}to{opacity:0}}.cheetah-grid__small-dialog-input{position:absolute;box-sizing:content-box;margin:-1px auto auto -1px;border-radius:3px;background-color:#fafafa;transition:padding .15s ease-out,box-shadow .15s ease-out}.cheetah-grid__small-dialog-input--hidden{box-shadow:none;padding:0;pointer-events:none;animation:cheetah-grid__small-dialog-input--hidden-animation .15s ease-out;opacity:0}.cheetah-grid__small-dialog-input--shown{box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);padding:8px 24px}.cheetah-grid__small-dialog-input__input{width:100%;height:100%;box-sizing:border-box;padding:3px 2px 0 4px;border:none;border-bottom:1px solid rgba(0,0,0,.87);outline:none;background-color:transparent;transition:all .3s ease-out}.cheetah-grid__small-dialog-input__input:focus{border-bottom:1px solid #2196f3;box-shadow:0 1px 0 0 #2196f3}.cheetah-grid__small-dialog-input:after{content:\\\"\\\";font-family:Roboto;font-size:12px;font-size:.75rem;min-height:1em;line-height:1;display:block;width:100%;padding-top:8px}.cheetah-grid__small-dialog-input.helper-text--right-justified:after{text-align:right}.cheetah-grid__small-dialog-input[data-helper-text]:after{content:attr(data-helper-text);color:rgba(0,0,0,.87)}.cheetah-grid__small-dialog-input[data-error-message] input{border-bottom:1px solid #ff1744;box-shadow:0 1px 0 0 #ff1744}.cheetah-grid__small-dialog-input[data-error-message]:after{content:attr(data-error-message);color:#ff1744;text-align:left}\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".cheetah-grid__error-message-element{border-top:1px solid #ff1744;color:#ff1744}\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".cheetah-grid__message-element{position:absolute;margin-top:-2px;box-sizing:border-box;border-radius:0 0 3px 3px;background-color:hsla(0,0%,98%,.85);padding:8px 2px;pointer-events:none;user-select:none}.cheetah-grid__message-element--hidden{opacity:0;display:none}.cheetah-grid__message-element__message{font-family:Roboto;font-size:12px;font-size:.75rem;min-height:1em;line-height:1;display:block;width:100%}.cheetah-grid__message-element{border-top:1px solid rgba(0,0,0,.87);color:rgba(0,0,0,.87)}.cheetah-grid__message-element.helper-text--right-justified{text-align:right}\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".cheetah-grid__warning-message-element{border-top:1px solid #dd2c00;color:#dd2c00}\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".cheetah-grid .grid-scrollable{height:100%;width:100%;position:absolute;overflow:scroll}.cheetah-grid .grid-scroll-end-point{opacity:0;position:relative}.cheetah-grid{position:relative;width:100%;height:100%}.cheetah-grid>canvas{position:absolute;width:0;height:0}.cheetah-grid .grid-focus-control{position:relative!important;width:1px;height:1px;opacity:0;padding:0;margin:0;box-sizing:border-box;pointer-events:none;max-width:0;max-height:0;float:none!important}.cheetah-grid input.grid-focus-control::-ms-clear{visibility:hidden}.cheetah-grid input.grid-focus-control.composition{opacity:1;max-width:none;max-height:none}\", \"\"]);\n\n// exports\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\nmodule.exports = function(useSourceMap) {\n\tvar list = [];\n\n\t// return the list of modules as css string\n\tlist.toString = function toString() {\n\t\treturn this.map(function (item) {\n\t\t\tvar content = cssWithMappingToString(item, useSourceMap);\n\t\t\tif(item[2]) {\n\t\t\t\treturn \"@media \" + item[2] + \"{\" + content + \"}\";\n\t\t\t} else {\n\t\t\t\treturn content;\n\t\t\t}\n\t\t}).join(\"\");\n\t};\n\n\t// import a list of modules into the list\n\tlist.i = function(modules, mediaQuery) {\n\t\tif(typeof modules === \"string\")\n\t\t\tmodules = [[null, modules, \"\"]];\n\t\tvar alreadyImportedModules = {};\n\t\tfor(var i = 0; i < this.length; i++) {\n\t\t\tvar id = this[i][0];\n\t\t\tif(typeof id === \"number\")\n\t\t\t\talreadyImportedModules[id] = true;\n\t\t}\n\t\tfor(i = 0; i < modules.length; i++) {\n\t\t\tvar item = modules[i];\n\t\t\t// skip already imported module\n\t\t\t// this implementation is not 100% perfect for weird media query combinations\n\t\t\t//  when a module is imported multiple times with different media queries.\n\t\t\t//  I hope this will never occur (Hey this way we have smaller bundles)\n\t\t\tif(typeof item[0] !== \"number\" || !alreadyImportedModules[item[0]]) {\n\t\t\t\tif(mediaQuery && !item[2]) {\n\t\t\t\t\titem[2] = mediaQuery;\n\t\t\t\t} else if(mediaQuery) {\n\t\t\t\t\titem[2] = \"(\" + item[2] + \") and (\" + mediaQuery + \")\";\n\t\t\t\t}\n\t\t\t\tlist.push(item);\n\t\t\t}\n\t\t}\n\t};\n\treturn list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n\tvar content = item[1] || '';\n\tvar cssMapping = item[3];\n\tif (!cssMapping) {\n\t\treturn content;\n\t}\n\n\tif (useSourceMap && typeof btoa === 'function') {\n\t\tvar sourceMapping = toComment(cssMapping);\n\t\tvar sourceURLs = cssMapping.sources.map(function (source) {\n\t\t\treturn '/*# sourceURL=' + cssMapping.sourceRoot + source + ' */'\n\t\t});\n\n\t\treturn [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n\t}\n\n\treturn [content].join('\\n');\n}\n\n// Adapted from convert-source-map (MIT)\nfunction toComment(sourceMap) {\n\t// eslint-disable-next-line no-undef\n\tvar base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n\tvar data = 'sourceMappingURL=data:application/json;charset=utf-8;base64,' + base64;\n\n\treturn '/*# ' + data + ' */';\n}\n","/*\n\tMIT License http://www.opensource.org/licenses/mit-license.php\n\tAuthor Tobias Koppers @sokra\n*/\n\nvar stylesInDom = {};\n\nvar\tmemoize = function (fn) {\n\tvar memo;\n\n\treturn function () {\n\t\tif (typeof memo === \"undefined\") memo = fn.apply(this, arguments);\n\t\treturn memo;\n\t};\n};\n\nvar isOldIE = memoize(function () {\n\t// Test for IE <= 9 as proposed by Browserhacks\n\t// @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n\t// Tests for existence of standard globals is to allow style-loader\n\t// to operate correctly into non-standard environments\n\t// @see https://github.com/webpack-contrib/style-loader/issues/177\n\treturn window && document && document.all && !window.atob;\n});\n\nvar getTarget = function (target) {\n  return document.querySelector(target);\n};\n\nvar getElement = (function (fn) {\n\tvar memo = {};\n\n\treturn function(target) {\n                // If passing function in options, then use it for resolve \"head\" element.\n                // Useful for Shadow Root style i.e\n                // {\n                //   insertInto: function () { return document.querySelector(\"#foo\").shadowRoot }\n                // }\n                if (typeof target === 'function') {\n                        return target();\n                }\n                if (typeof memo[target] === \"undefined\") {\n\t\t\tvar styleTarget = getTarget.call(this, target);\n\t\t\t// Special case to return head of iframe instead of iframe itself\n\t\t\tif (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n\t\t\t\ttry {\n\t\t\t\t\t// This will throw an exception if access to iframe is blocked\n\t\t\t\t\t// due to cross-origin restrictions\n\t\t\t\t\tstyleTarget = styleTarget.contentDocument.head;\n\t\t\t\t} catch(e) {\n\t\t\t\t\tstyleTarget = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tmemo[target] = styleTarget;\n\t\t}\n\t\treturn memo[target]\n\t};\n})();\n\nvar singleton = null;\nvar\tsingletonCounter = 0;\nvar\tstylesInsertedAtTop = [];\n\nvar\tfixUrls = require(\"./urls\");\n\nmodule.exports = function(list, options) {\n\tif (typeof DEBUG !== \"undefined\" && DEBUG) {\n\t\tif (typeof document !== \"object\") throw new Error(\"The style-loader cannot be used in a non-browser environment\");\n\t}\n\n\toptions = options || {};\n\n\toptions.attrs = typeof options.attrs === \"object\" ? options.attrs : {};\n\n\t// Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n\t// tags it will allow on a page\n\tif (!options.singleton && typeof options.singleton !== \"boolean\") options.singleton = isOldIE();\n\n\t// By default, add <style> tags to the <head> element\n        if (!options.insertInto) options.insertInto = \"head\";\n\n\t// By default, add <style> tags to the bottom of the target\n\tif (!options.insertAt) options.insertAt = \"bottom\";\n\n\tvar styles = listToStyles(list, options);\n\n\taddStylesToDom(styles, options);\n\n\treturn function update (newList) {\n\t\tvar mayRemove = [];\n\n\t\tfor (var i = 0; i < styles.length; i++) {\n\t\t\tvar item = styles[i];\n\t\t\tvar domStyle = stylesInDom[item.id];\n\n\t\t\tdomStyle.refs--;\n\t\t\tmayRemove.push(domStyle);\n\t\t}\n\n\t\tif(newList) {\n\t\t\tvar newStyles = listToStyles(newList, options);\n\t\t\taddStylesToDom(newStyles, options);\n\t\t}\n\n\t\tfor (var i = 0; i < mayRemove.length; i++) {\n\t\t\tvar domStyle = mayRemove[i];\n\n\t\t\tif(domStyle.refs === 0) {\n\t\t\t\tfor (var j = 0; j < domStyle.parts.length; j++) domStyle.parts[j]();\n\n\t\t\t\tdelete stylesInDom[domStyle.id];\n\t\t\t}\n\t\t}\n\t};\n};\n\nfunction addStylesToDom (styles, options) {\n\tfor (var i = 0; i < styles.length; i++) {\n\t\tvar item = styles[i];\n\t\tvar domStyle = stylesInDom[item.id];\n\n\t\tif(domStyle) {\n\t\t\tdomStyle.refs++;\n\n\t\t\tfor(var j = 0; j < domStyle.parts.length; j++) {\n\t\t\t\tdomStyle.parts[j](item.parts[j]);\n\t\t\t}\n\n\t\t\tfor(; j < item.parts.length; j++) {\n\t\t\t\tdomStyle.parts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\t\t} else {\n\t\t\tvar parts = [];\n\n\t\t\tfor(var j = 0; j < item.parts.length; j++) {\n\t\t\t\tparts.push(addStyle(item.parts[j], options));\n\t\t\t}\n\n\t\t\tstylesInDom[item.id] = {id: item.id, refs: 1, parts: parts};\n\t\t}\n\t}\n}\n\nfunction listToStyles (list, options) {\n\tvar styles = [];\n\tvar newStyles = {};\n\n\tfor (var i = 0; i < list.length; i++) {\n\t\tvar item = list[i];\n\t\tvar id = options.base ? item[0] + options.base : item[0];\n\t\tvar css = item[1];\n\t\tvar media = item[2];\n\t\tvar sourceMap = item[3];\n\t\tvar part = {css: css, media: media, sourceMap: sourceMap};\n\n\t\tif(!newStyles[id]) styles.push(newStyles[id] = {id: id, parts: [part]});\n\t\telse newStyles[id].parts.push(part);\n\t}\n\n\treturn styles;\n}\n\nfunction insertStyleElement (options, style) {\n\tvar target = getElement(options.insertInto)\n\n\tif (!target) {\n\t\tthrow new Error(\"Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.\");\n\t}\n\n\tvar lastStyleElementInsertedAtTop = stylesInsertedAtTop[stylesInsertedAtTop.length - 1];\n\n\tif (options.insertAt === \"top\") {\n\t\tif (!lastStyleElementInsertedAtTop) {\n\t\t\ttarget.insertBefore(style, target.firstChild);\n\t\t} else if (lastStyleElementInsertedAtTop.nextSibling) {\n\t\t\ttarget.insertBefore(style, lastStyleElementInsertedAtTop.nextSibling);\n\t\t} else {\n\t\t\ttarget.appendChild(style);\n\t\t}\n\t\tstylesInsertedAtTop.push(style);\n\t} else if (options.insertAt === \"bottom\") {\n\t\ttarget.appendChild(style);\n\t} else if (typeof options.insertAt === \"object\" && options.insertAt.before) {\n\t\tvar nextSibling = getElement(options.insertInto + \" \" + options.insertAt.before);\n\t\ttarget.insertBefore(style, nextSibling);\n\t} else {\n\t\tthrow new Error(\"[Style Loader]\\n\\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\\n Must be 'top', 'bottom', or Object.\\n (https://github.com/webpack-contrib/style-loader#insertat)\\n\");\n\t}\n}\n\nfunction removeStyleElement (style) {\n\tif (style.parentNode === null) return false;\n\tstyle.parentNode.removeChild(style);\n\n\tvar idx = stylesInsertedAtTop.indexOf(style);\n\tif(idx >= 0) {\n\t\tstylesInsertedAtTop.splice(idx, 1);\n\t}\n}\n\nfunction createStyleElement (options) {\n\tvar style = document.createElement(\"style\");\n\n\toptions.attrs.type = \"text/css\";\n\n\taddAttrs(style, options.attrs);\n\tinsertStyleElement(options, style);\n\n\treturn style;\n}\n\nfunction createLinkElement (options) {\n\tvar link = document.createElement(\"link\");\n\n\toptions.attrs.type = \"text/css\";\n\toptions.attrs.rel = \"stylesheet\";\n\n\taddAttrs(link, options.attrs);\n\tinsertStyleElement(options, link);\n\n\treturn link;\n}\n\nfunction addAttrs (el, attrs) {\n\tObject.keys(attrs).forEach(function (key) {\n\t\tel.setAttribute(key, attrs[key]);\n\t});\n}\n\nfunction addStyle (obj, options) {\n\tvar style, update, remove, result;\n\n\t// If a transform function was defined, run it on the css\n\tif (options.transform && obj.css) {\n\t    result = options.transform(obj.css);\n\n\t    if (result) {\n\t    \t// If transform returns a value, use that instead of the original css.\n\t    \t// This allows running runtime transformations on the css.\n\t    \tobj.css = result;\n\t    } else {\n\t    \t// If the transform function returns a falsy value, don't add this css.\n\t    \t// This allows conditional loading of css\n\t    \treturn function() {\n\t    \t\t// noop\n\t    \t};\n\t    }\n\t}\n\n\tif (options.singleton) {\n\t\tvar styleIndex = singletonCounter++;\n\n\t\tstyle = singleton || (singleton = createStyleElement(options));\n\n\t\tupdate = applyToSingletonTag.bind(null, style, styleIndex, false);\n\t\tremove = applyToSingletonTag.bind(null, style, styleIndex, true);\n\n\t} else if (\n\t\tobj.sourceMap &&\n\t\ttypeof URL === \"function\" &&\n\t\ttypeof URL.createObjectURL === \"function\" &&\n\t\ttypeof URL.revokeObjectURL === \"function\" &&\n\t\ttypeof Blob === \"function\" &&\n\t\ttypeof btoa === \"function\"\n\t) {\n\t\tstyle = createLinkElement(options);\n\t\tupdate = updateLink.bind(null, style, options);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\n\t\t\tif(style.href) URL.revokeObjectURL(style.href);\n\t\t};\n\t} else {\n\t\tstyle = createStyleElement(options);\n\t\tupdate = applyToTag.bind(null, style);\n\t\tremove = function () {\n\t\t\tremoveStyleElement(style);\n\t\t};\n\t}\n\n\tupdate(obj);\n\n\treturn function updateStyle (newObj) {\n\t\tif (newObj) {\n\t\t\tif (\n\t\t\t\tnewObj.css === obj.css &&\n\t\t\t\tnewObj.media === obj.media &&\n\t\t\t\tnewObj.sourceMap === obj.sourceMap\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tupdate(obj = newObj);\n\t\t} else {\n\t\t\tremove();\n\t\t}\n\t};\n}\n\nvar replaceText = (function () {\n\tvar textStore = [];\n\n\treturn function (index, replacement) {\n\t\ttextStore[index] = replacement;\n\n\t\treturn textStore.filter(Boolean).join('\\n');\n\t};\n})();\n\nfunction applyToSingletonTag (style, index, remove, obj) {\n\tvar css = remove ? \"\" : obj.css;\n\n\tif (style.styleSheet) {\n\t\tstyle.styleSheet.cssText = replaceText(index, css);\n\t} else {\n\t\tvar cssNode = document.createTextNode(css);\n\t\tvar childNodes = style.childNodes;\n\n\t\tif (childNodes[index]) style.removeChild(childNodes[index]);\n\n\t\tif (childNodes.length) {\n\t\t\tstyle.insertBefore(cssNode, childNodes[index]);\n\t\t} else {\n\t\t\tstyle.appendChild(cssNode);\n\t\t}\n\t}\n}\n\nfunction applyToTag (style, obj) {\n\tvar css = obj.css;\n\tvar media = obj.media;\n\n\tif(media) {\n\t\tstyle.setAttribute(\"media\", media)\n\t}\n\n\tif(style.styleSheet) {\n\t\tstyle.styleSheet.cssText = css;\n\t} else {\n\t\twhile(style.firstChild) {\n\t\t\tstyle.removeChild(style.firstChild);\n\t\t}\n\n\t\tstyle.appendChild(document.createTextNode(css));\n\t}\n}\n\nfunction updateLink (link, options, obj) {\n\tvar css = obj.css;\n\tvar sourceMap = obj.sourceMap;\n\n\t/*\n\t\tIf convertToAbsoluteUrls isn't defined, but sourcemaps are enabled\n\t\tand there is no publicPath defined then lets turn convertToAbsoluteUrls\n\t\ton by default.  Otherwise default to the convertToAbsoluteUrls option\n\t\tdirectly\n\t*/\n\tvar autoFixUrls = options.convertToAbsoluteUrls === undefined && sourceMap;\n\n\tif (options.convertToAbsoluteUrls || autoFixUrls) {\n\t\tcss = fixUrls(css);\n\t}\n\n\tif (sourceMap) {\n\t\t// http://stackoverflow.com/a/26603875\n\t\tcss += \"\\n/*# sourceMappingURL=data:application/json;base64,\" + btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))) + \" */\";\n\t}\n\n\tvar blob = new Blob([css], { type: \"text/css\" });\n\n\tvar oldSrc = link.href;\n\n\tlink.href = URL.createObjectURL(blob);\n\n\tif(oldSrc) URL.revokeObjectURL(oldSrc);\n}\n","\n/**\n * When source maps are enabled, `style-loader` uses a link element with a data-uri to\n * embed the css on the page. This breaks all relative urls because now they are relative to a\n * bundle instead of the current page.\n *\n * One solution is to only use full urls, but that may be impossible.\n *\n * Instead, this function \"fixes\" the relative urls to be absolute according to the current page location.\n *\n * A rudimentary test suite is located at `test/fixUrls.js` and can be run via the `npm test` command.\n *\n */\n\nmodule.exports = function (css) {\n  // get current location\n  var location = typeof window !== \"undefined\" && window.location;\n\n  if (!location) {\n    throw new Error(\"fixUrls requires window.location\");\n  }\n\n\t// blank or null?\n\tif (!css || typeof css !== \"string\") {\n\t  return css;\n  }\n\n  var baseUrl = location.protocol + \"//\" + location.host;\n  var currentDir = baseUrl + location.pathname.replace(/\\/[^\\/]*$/, \"/\");\n\n\t// convert each url(...)\n\t/*\n\tThis regular expression is just a way to recursively match brackets within\n\ta string.\n\n\t /url\\s*\\(  = Match on the word \"url\" with any whitespace after it and then a parens\n\t   (  = Start a capturing group\n\t     (?:  = Start a non-capturing group\n\t         [^)(]  = Match anything that isn't a parentheses\n\t         |  = OR\n\t         \\(  = Match a start parentheses\n\t             (?:  = Start another non-capturing groups\n\t                 [^)(]+  = Match anything that isn't a parentheses\n\t                 |  = OR\n\t                 \\(  = Match a start parentheses\n\t                     [^)(]*  = Match anything that isn't a parentheses\n\t                 \\)  = Match a end parentheses\n\t             )  = End Group\n              *\\) = Match anything and then a close parens\n          )  = Close non-capturing group\n          *  = Match anything\n       )  = Close capturing group\n\t \\)  = Match a close parens\n\n\t /gi  = Get all matches, not the first.  Be case insensitive.\n\t */\n\tvar fixedCss = css.replace(/url\\s*\\(((?:[^)(]|\\((?:[^)(]+|\\([^)(]*\\))*\\))*)\\)/gi, function(fullMatch, origUrl) {\n\t\t// strip quotes (if they exist)\n\t\tvar unquotedOrigUrl = origUrl\n\t\t\t.trim()\n\t\t\t.replace(/^\"(.*)\"$/, function(o, $1){ return $1; })\n\t\t\t.replace(/^'(.*)'$/, function(o, $1){ return $1; });\n\n\t\t// already a full url? no change\n\t\tif (/^(#|data:|http:\\/\\/|https:\\/\\/|file:\\/\\/\\/|\\s*$)/i.test(unquotedOrigUrl)) {\n\t\t  return fullMatch;\n\t\t}\n\n\t\t// convert the url to a full url\n\t\tvar newUrl;\n\n\t\tif (unquotedOrigUrl.indexOf(\"//\") === 0) {\n\t\t  \t//TODO: should we add protocol?\n\t\t\tnewUrl = unquotedOrigUrl;\n\t\t} else if (unquotedOrigUrl.indexOf(\"/\") === 0) {\n\t\t\t// path should be relative to the base url\n\t\t\tnewUrl = baseUrl + unquotedOrigUrl; // already starts with '/'\n\t\t} else {\n\t\t\t// path should be relative to current directory\n\t\t\tnewUrl = currentDir + unquotedOrigUrl.replace(/^\\.\\//, \"\"); // Strip leading './'\n\t\t}\n\n\t\t// send back the fixed url(...)\n\t\treturn \"url(\" + JSON.stringify(newUrl) + \")\";\n\t});\n\n\t// send back the fixed css\n\treturn fixedCss;\n};\n","module.exports = {\n\t/*\n\toriginal svg\n\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"48\" height=\"48\" viewBox=\"0 0 48 48\"><path d=\"M38 26H26v12h-4V26H10v-4h12V10h4v12h12v4z\"/></svg>\n\t@ material-design-icons\\content\\svg\\production\\ic_add_48px.svg\n\t*/\n\td: 'M38 26H26v12h-4V26H10v-4h12V10h4v12h12v4z',\n\twidth: 48,\n\theight: 48,\n\t\n};","module.exports = {\n\t/*\n\toriginal svg\n\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"48\" height=\"48\" viewBox=\"0 0 48 48\"><path d=\"M6 34.5V42h7.5l22.13-22.13-7.5-7.5L6 34.5zm35.41-20.41c.78-.78.78-2.05 0-2.83l-4.67-4.67c-.78-.78-2.05-.78-2.83 0l-3.66 3.66 7.5 7.5 3.66-3.66z\"/></svg>\n\t@ material-design-icons\\image\\svg\\production\\ic_edit_48px.svg\n\t*/\n\td: 'M6 34.5V42h7.5l22.13-22.13-7.5-7.5L6 34.5zm35.41-20.41c.78-.78.78-2.05 0-2.83l-4.67-4.67c-.78-.78-2.05-.78-2.83 0l-3.66 3.66 7.5 7.5 3.66-3.66z',\n\twidth: 48,\n\theight: 48,\n\t\n};","module.exports = {\n\t/*\n\toriginal svg\n\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"48\" height=\"48\" viewBox=\"0 0 48 48\"><path fill=\"#010101\" d=\"M40 24l-2.82-2.82L26 32.34V8h-4v24.34L10.84 21.16 8 24l16 16 16-16z\"/></svg>\n\t@ material-design-icons\\navigation\\svg\\production\\ic_arrow_downward_48px.svg\n\t*/\n\td: 'M40 24l-2.82-2.82L26 32.34V8h-4v24.34L10.84 21.16 8 24l16 16 16-16z',\n\twidth: 48,\n\theight: 48,\n\t\n};","module.exports = {\n\t/*\n\toriginal svg\n\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"48\" height=\"48\" viewBox=\"0 0 48 48\"><path d=\"M8 24l2.83 2.83L22 15.66V40h4V15.66l11.17 11.17L40 24 24 8 8 24z\"/></svg>\n\t@ material-design-icons\\navigation\\svg\\production\\ic_arrow_upward_48px.svg\n\t*/\n\td: 'M8 24l2.83 2.83L22 15.66V40h4V15.66l11.17 11.17L40 24 24 8 8 24z',\n\twidth: 48,\n\theight: 48,\n\t\n};","module.exports = {\n\t/*\n\toriginal svg\n\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path d=\"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z\"/></svg>\n\t@ material-design-icons\\toggle\\svg\\production\\ic_star_24px.svg\n\t*/\n\td: 'M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z',\n\twidth: 24,\n\theight: 24,\n\t\n};","module.exports = {\n\t/*\n\toriginal svg\n\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path d=\"M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z\"/></svg>\n\t@ material-design-icons\\toggle\\svg\\production\\ic_star_border_24px.svg\n\t*/\n\td: 'M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z',\n\twidth: 24,\n\theight: 24,\n\t\n};","module.exports = {\n\t/*\n\toriginal svg\n\t<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\"><path d=\"M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4V6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z\"/></svg>\n\t@ material-design-icons\\toggle\\svg\\production\\ic_star_half_24px.svg\n\t*/\n\td: 'M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4V6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z',\n\twidth: 24,\n\theight: 24,\n\t\n};","/*eslint no-bitwise:0*/\r\n'use strict';\r\n{\r\n\tconst {calcStartPosition} = require('./internal/canvases');\r\n\tconst inlines = require('./element/inlines');\r\n\tconst canvashelper = require('./tools/canvashelper');\r\n\tconst themes = require('./themes');\r\n\tconst {colorToRGB} = require('./internal/color');\r\n\tconst Rect = require('./internal/Rect');\r\n\tconst {getChainSafe, getOrApply, style: {toBoxArray}} = require('./internal/utils');\r\n\tconst fonts = require('./internal/fonts');\r\n\tconst calc = require('./internal/calc');\r\n\r\n\tfunction invalidateCell(context, grid) {\r\n\t\tconst {col, row} = context;\r\n\t\tgrid.invalidateCell(col, row);\r\n\t}\r\n\tfunction getColor(color, col, row, grid, context) {\r\n\t\treturn getOrApply(color, {\r\n\t\t\tcol,\r\n\t\t\trow,\r\n\t\t\tgrid,\r\n\t\t\tcontext,\r\n\t\t});\r\n\t}\r\n\tfunction getThemeColor(grid, ...names) {\r\n\t\treturn getChainSafe(grid.theme, ...names) || getChainSafe(themes.default, ...names);\r\n\t}\r\n\tfunction testFontLoad(font, value, context, grid) {\r\n\t\tif (font) {\r\n\t\t\tif (!fonts.check(font, value)) {\r\n\t\t\t\tfonts.load(font, value, () => invalidateCell(context, grid));\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\r\n\tfunction drawInlines(ctx, inlines, rect, offset, col, row, grid) {\r\n\t\tfunction drawInline(inline, offsetLeft, offsetRight) {\r\n\t\t\tif (inline.canDraw()) {\r\n\t\t\t\tctx.save();\r\n\t\t\t\ttry {\r\n\t\t\t\t\tctx.fillStyle = getColor(inline.color() || ctx.fillStyle, col, row, grid, ctx);\r\n\t\t\t\t\tctx.font = inline.font() || ctx.font;\r\n\t\t\t\t\tinline.draw({\r\n\t\t\t\t\t\tctx,\r\n\t\t\t\t\t\tcanvashelper,\r\n\t\t\t\t\t\trect,\r\n\t\t\t\t\t\toffset,\r\n\t\t\t\t\t\toffsetLeft,\r\n\t\t\t\t\t\toffsetRight,\r\n\t\t\t\t\t});\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tinline.onReady(() => grid.invalidateCell(col, row));\r\n\t\t\t\t//noop\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (inlines.length === 1) {\r\n\t\t\t//1\r\n\t\t\tconst inline = inlines[0];\r\n\t\t\tdrawInline(inline, 0, 0);\r\n\t\t} else {\r\n\t\t\tconst inlineWidths = inlines.map((inline) => (inline.width({ctx}) || 0) - 0);\r\n\t\t\tlet offsetRight = inlineWidths.reduce((a, b) => a + b);\r\n\r\n\t\t\tlet offsetLeft = 0;\r\n\t\t\tinlines.forEach((inline, index) => {\r\n\t\t\t\tconst inlineWidth = inlineWidths[index];\r\n\t\t\t\toffsetRight -= inlineWidth;\r\n\t\t\t\tdrawInline(inline, offsetLeft, offsetRight);\r\n\t\t\t\toffsetLeft += inlineWidth;\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tfunction _inlineRect(grid, ctx, inline, rect, col, row,\r\n\t\t\t{\r\n\t\t\t\toffset,\r\n\t\t\t\tcolor,\r\n\t\t\t\ttextAlign,\r\n\t\t\t\ttextBaseline,\r\n\t\t\t\tfont,\r\n\t\t\t\ticons,\r\n\t\t\t} = {}) {\r\n\r\n\t\t//style\r\n\t\tctx.fillStyle = getColor(color, col, row, grid, ctx);\r\n\t\tctx.textAlign = textAlign;\r\n\t\tctx.textBaseline = textBaseline;\r\n\t\tctx.font = font || ctx.font;\r\n\r\n\t\tconst actInlines = inlines.buildInlines(icons, inline);\r\n\t\tdrawInlines(ctx, actInlines, rect, offset, col, row, grid);\r\n\t}\r\n\r\n\r\n\tfunction drawCheckbox(ctx, rect, check, helper,\r\n\t\t\t{\r\n\t\t\t\tanimElapsedTime = 1,\r\n\t\t\t\tuncheckBgColor = helper.theme.checkbox.uncheckBgColor,\r\n\t\t\t\tcheckBgColor = helper.theme.checkbox.checkBgColor,\r\n\t\t\t\tborderColor = helper.theme.checkbox.borderColor,\r\n\t\t\t\ttextAlign = 'center',\r\n\t\t\t\ttextBaseline = 'middle',\r\n\t\t\t} = {}) {\r\n\t\tconst boxWidth = canvashelper.measureCheckbox(ctx).width;\r\n\t\tctx.textAlign = textAlign;\r\n\t\tctx.textBaseline = textBaseline;\r\n\t\tconst pos = calcStartPosition(ctx, rect, boxWidth + 1/*+1*/, boxWidth + 1/*+1*/);\r\n\t\tif (0 < animElapsedTime && animElapsedTime < 1) {\r\n\t\t\tconst uncheckBgRGB = colorToRGB(uncheckBgColor);\r\n\t\t\tconst checkBgRGB = colorToRGB(checkBgColor);\r\n\t\t\tconst checkRGB = (colorName) => {\r\n\t\t\t\tconst start = uncheckBgRGB[colorName];\r\n\t\t\t\tconst end = checkBgRGB[colorName];\r\n\t\t\t\tif (animElapsedTime >= 1) {\r\n\t\t\t\t\treturn end;\r\n\t\t\t\t}\r\n\t\t\t\tconst diff = start - end;\r\n\t\t\t\treturn Math.ceil(start - diff * animElapsedTime);\r\n\t\t\t};\r\n\t\t\tconst uncheckRGB = (colorName) => {\r\n\t\t\t\tconst end = uncheckBgRGB[colorName];\r\n\t\t\t\tconst start = checkBgRGB[colorName];\r\n\t\t\t\tif (animElapsedTime >= 1) {\r\n\t\t\t\t\treturn end;\r\n\t\t\t\t}\r\n\t\t\t\tconst diff = end - start;\r\n\t\t\t\treturn Math.ceil(start + diff * animElapsedTime);\r\n\t\t\t};\r\n\t\t\tuncheckBgColor = check ? uncheckBgColor : `rgb(${uncheckRGB('r')} , ${uncheckRGB('g')}, ${uncheckRGB('b')})`;\r\n\t\t\tcheckBgColor = `rgb(${checkRGB('r')} , ${checkRGB('g')}, ${checkRGB('b')})`;\r\n\t\t}\r\n\r\n\t\tcanvashelper.drawCheckbox(ctx, pos.x, pos.y, check ? animElapsedTime : false, {\r\n\t\t\tuncheckBgColor,\r\n\t\t\tcheckBgColor,\r\n\t\t\tborderColor,\r\n\t\t});\r\n\t}\r\n\r\n\tclass Theme {\r\n\t\tconstructor(grid) {\r\n\t\t\tthis._grid = grid;\r\n\t\t}\r\n\t\tgetThemeColor(...name) {\r\n\t\t\treturn getThemeColor(this._grid, ...name);\r\n\t\t}\r\n\t\tget font() {\r\n\t\t\treturn getThemeColor(this._grid, 'font');\r\n\t\t}\r\n\t\tget underlayBackgroundColor() {\r\n\t\t\treturn getThemeColor(this._grid, 'underlayBackgroundColor');\r\n\t\t}\r\n\t\t// color\r\n\t\tget color() {\r\n\t\t\treturn getThemeColor(this._grid, 'color');\r\n\t\t}\r\n\t\tget frozenRowsColor() {\r\n\t\t\treturn getThemeColor(this._grid, 'frozenRowsColor');\r\n\t\t}\r\n\t\t// background\r\n\t\tget defaultBgColor() {\r\n\t\t\treturn getThemeColor(this._grid, 'defaultBgColor');\r\n\t\t}\r\n\t\tget frozenRowsBgColor() {\r\n\t\t\treturn getThemeColor(this._grid, 'frozenRowsBgColor');\r\n\t\t}\r\n\t\tget selectionBgColor() {\r\n\t\t\treturn getThemeColor(this._grid, 'selectionBgColor');\r\n\t\t}\r\n\t\t// border\r\n\t\tget borderColor() {\r\n\t\t\treturn getThemeColor(this._grid, 'borderColor');\r\n\t\t}\r\n\t\tget frozenRowsBorderColor() {\r\n\t\t\treturn getThemeColor(this._grid, 'frozenRowsBorderColor');\r\n\t\t}\r\n\t\tget hiliteBorderColor() {\r\n\t\t\treturn getThemeColor(this._grid, 'hiliteBorderColor');\r\n\t\t}\r\n\t\tget checkbox() {\r\n\t\t\tconst grid = this._grid;\r\n\t\t\treturn this._checkbox || (this._checkbox = {\r\n\t\t\t\tget uncheckBgColor() {\r\n\t\t\t\t\treturn getThemeColor(grid, 'checkbox', 'uncheckBgColor');\r\n\t\t\t\t},\r\n\t\t\t\tget checkBgColor() {\r\n\t\t\t\t\treturn getThemeColor(grid, 'checkbox', 'checkBgColor');\r\n\t\t\t\t},\r\n\t\t\t\tget borderColor() {\r\n\t\t\t\t\treturn getThemeColor(grid, 'checkbox', 'borderColor');\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tget button() {\r\n\t\t\tconst grid = this._grid;\r\n\t\t\treturn this._button || (this._button = {\r\n\t\t\t\tget color() {\r\n\t\t\t\t\treturn getThemeColor(grid, 'button', 'color');\r\n\t\t\t\t},\r\n\t\t\t\tget bgColor() {\r\n\t\t\t\t\treturn getThemeColor(grid, 'button', 'bgColor');\r\n\t\t\t\t},\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t}\r\n\t\r\n\r\n\tfunction strokeRect(ctx, color, left, top, width, height) {\r\n\t\tif (!Array.isArray(color)) {\r\n\t\t\tif (color) {\r\n\t\t\t\tctx.strokeStyle = color;\r\n\t\t\t\tctx.strokeRect(left, top, width, height);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconst borderColors = toBoxArray(color);\r\n\t\t\tcanvashelper.strokeColorsRect(ctx, borderColors, left, top, width, height);\r\n\t\t}\r\n\t}\r\n\r\n\tclass GridCanvasHelper {\r\n\t\tconstructor(grid) {\r\n\t\t\tthis._grid = grid;\r\n\t\t\tthis._theme = new Theme(grid);\r\n\t\t}\r\n\t\tcreateCalculator(context) {\r\n\t\t\treturn {\r\n\t\t\t\tcalcWidth(width) {\r\n\t\t\t\t\treturn calc.toPx(width, {\r\n\t\t\t\t\t\tget full() {\r\n\t\t\t\t\t\t\tconst rect = context.getRect();\r\n\t\t\t\t\t\t\treturn rect.width;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tget em() {\r\n\t\t\t\t\t\t\tconst ctx = context.getContext();\r\n\t\t\t\t\t\t\treturn ctx.measureText('').width;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tcalcHeight(height) {\r\n\t\t\t\t\treturn calc.toPx(height, {\r\n\t\t\t\t\t\tget full() {\r\n\t\t\t\t\t\t\tconst rect = context.getRect();\r\n\t\t\t\t\t\t\treturn rect.height;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tget em() {\r\n\t\t\t\t\t\t\tconst ctx = context.getContext();\r\n\t\t\t\t\t\t\treturn ctx.measureText('').width;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t\tgetColor(color, col, row, ctx) {\r\n\t\t\treturn getColor(color, col, row, this._grid, ctx);\r\n\t\t}\r\n\t\ttoBoxArray(obj) {\r\n\t\t\treturn toBoxArray(obj);\r\n\t\t}\r\n\t\ttoBoxPixelArray(value, context) {\r\n\t\t\tif (typeof value === 'string' || Array.isArray(value)) {\r\n\t\t\t\tconst calculator = this.createCalculator(context);\r\n\t\t\t\tconst box = toBoxArray(value);\r\n\t\t\t\treturn [\r\n\t\t\t\t\tcalculator.calcHeight(box[0]),\r\n\t\t\t\t\tcalculator.calcWidth(box[1]),\r\n\t\t\t\t\tcalculator.calcHeight(box[2]),\r\n\t\t\t\t\tcalculator.calcWidth(box[3]),\r\n\t\t\t\t];\r\n\t\t\t}\r\n\t\t\treturn toBoxArray(value);\r\n\t\t}\r\n\t\tget theme() {\r\n\t\t\treturn this._theme;\r\n\t\t}\r\n\t\tdrawWithClip(context, draw) {\r\n\t\t\tconst drawRect = context.getDrawRect();\r\n\t\t\tif (!drawRect) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst ctx = context.getContext();\r\n\r\n\t\t\tctx.save();\r\n\t\t\ttry {\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.rect(drawRect.left, drawRect.top, drawRect.width, drawRect.height);\r\n\t\t\t\t//clip\r\n\t\t\t\tctx.clip();\r\n\r\n\t\t\t\tdraw(ctx);\r\n\t\t\t} finally {\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\t\t}\r\n\t\tdrawBorderWithClip(context, draw) {\r\n\t\t\tconst drawRect = context.getDrawRect();\r\n\t\t\tif (!drawRect) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst rect = context.getRect();\r\n\t\t\tconst ctx = context.getContext();\r\n\t\t\tctx.save();\r\n\t\t\ttry {\r\n\t\t\t\t//clip\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tlet clipLeft = drawRect.left;\r\n\t\t\t\tlet clipWidth = drawRect.width;\r\n\t\t\t\tif (drawRect.left === rect.left) {\r\n\t\t\t\t\tclipLeft += -1;\r\n\t\t\t\t\tclipWidth += 1;\r\n\t\t\t\t}\r\n\t\t\t\tlet clipTop = drawRect.top;\r\n\t\t\t\tlet clipHeight = drawRect.height;\r\n\t\t\t\tif (drawRect.top === rect.top) {\r\n\t\t\t\t\tclipTop += -1;\r\n\t\t\t\t\tclipHeight += 1;\r\n\t\t\t\t}\r\n\t\t\t\tctx.rect(clipLeft, clipTop, clipWidth, clipHeight);\r\n\t\t\t\tctx.clip();\r\n\r\n\t\t\t\tdraw(ctx);\r\n\t\t\t} finally {\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\t\t}\r\n\t\ttext(text, context,\r\n\t\t\t\t{\r\n\t\t\t\t\tpadding,\r\n\t\t\t\t\toffset = 2,\r\n\t\t\t\t\tcolor,\r\n\t\t\t\t\ttextAlign = 'left',\r\n\t\t\t\t\ttextBaseline = 'middle',\r\n\t\t\t\t\tfont,\r\n\t\t\t\t\ticons,\r\n\t\t\t\t} = {}) {\r\n\t\t\tlet rect = context.getRect();\r\n\r\n\t\t\tconst {col, row} = context;\r\n\r\n\t\t\tif (!color) {\r\n\t\t\t\t({color} = this.theme);\r\n\t\t\t\t// header color\r\n\t\t\t\tconst isFrozenCell = this._grid.isFrozenCell(col, row);\r\n\t\t\t\tif (isFrozenCell && isFrozenCell.row) {\r\n\t\t\t\t\tcolor = this.theme.frozenRowsColor;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.drawWithClip(context, (ctx) => {\r\n\t\t\t\tif (padding) {\r\n\t\t\t\t\tpadding = this.toBoxPixelArray(padding, context);\r\n\t\t\t\t\tconst left = rect.left + padding[3];\r\n\t\t\t\t\tconst top = rect.top + padding[0];\r\n\t\t\t\t\tconst width = rect.width - padding[1] - padding[3];\r\n\t\t\t\t\tconst height = rect.height - padding[0] - padding[2];\r\n\t\t\t\t\trect = new Rect(left, top, width, height);\r\n\t\t\t\t}\r\n\t\t\t\t_inlineRect(this._grid, ctx, text, rect, col, row,\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\toffset,\r\n\t\t\t\t\t\t\tcolor,\r\n\t\t\t\t\t\t\ttextAlign,\r\n\t\t\t\t\t\t\ttextBaseline,\r\n\t\t\t\t\t\t\tfont,\r\n\t\t\t\t\t\t\ticons,\r\n\t\t\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tfillText(text, x, y, context,\r\n\t\t\t\t{\r\n\t\t\t\t\tcolor,\r\n\t\t\t\t\ttextAlign = 'left',\r\n\t\t\t\t\ttextBaseline = 'top',\r\n\t\t\t\t\tfont,\r\n\t\t\t\t} = {}) {\r\n\r\n\t\t\tconst {col, row} = context;\r\n\r\n\t\t\tif (!color) {\r\n\t\t\t\t({color} = this.theme);\r\n\t\t\t\t// header color\r\n\t\t\t\tconst isFrozenCell = this._grid.isFrozenCell(col, row);\r\n\t\t\t\tif (isFrozenCell && isFrozenCell.row) {\r\n\t\t\t\t\tcolor = this.theme.frozenRowsColor;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst ctx = context.getContext();\r\n\t\t\tctx.save();\r\n\t\t\ttry {\r\n\t\t\t\tctx.fillStyle = getColor(color, col, row, this._grid, ctx);\r\n\t\t\t\tctx.textAlign = textAlign;\r\n\t\t\t\tctx.textBaseline = textBaseline;\r\n\t\t\t\tctx.font = font || ctx.font;\r\n\t\t\t\tctx.fillText(text, x, y);\r\n\t\t\t} finally {\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\tfillCell(context,\r\n\t\t\t\t{\r\n\t\t\t\t\tfillColor = this.theme.defaultBgColor,\r\n\t\t\t\t} = {}) {\r\n\t\t\tconst rect = context.getRect();\r\n\r\n\t\t\tthis.drawWithClip(context, (ctx) => {\r\n\t\t\t\tconst {col, row} = context;\r\n\t\t\t\tctx.fillStyle = getColor(fillColor, col, row, this._grid, ctx);\r\n\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.rect(rect.left, rect.top, rect.width, rect.height);\r\n\t\t\t\tctx.fill();\r\n\t\t\t});\r\n\t\t}\r\n\t\tfillCellWithState(context, option = {}) {\r\n\t\t\toption.fillColor = this.getFillColorState(context, option);\r\n\t\t\tthis.fillCell(context, option);\r\n\t\t}\r\n\t\tfillRect(rect, context,\r\n\t\t\t\t{\r\n\t\t\t\t\tfillColor = this.theme.defaultBgColor,\r\n\t\t\t\t} = {}) {\r\n\r\n\t\t\tconst ctx = context.getContext();\r\n\t\t\tctx.save();\r\n\t\t\ttry {\r\n\t\t\t\tconst {col, row} = context;\r\n\t\t\t\tctx.fillStyle = getColor(fillColor, col, row, this._grid, ctx);\r\n\t\t\t\t\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.rect(rect.left, rect.top, rect.width, rect.height);\r\n\t\t\t\tctx.fill();\r\n\t\t\t} finally {\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\t\t}\r\n\t\tfillRectWithState(rect, context, option = {}) {\r\n\t\t\toption.fillColor = this.getFillColorState(context, option);\r\n\r\n\t\t\tthis.fillRect(rect, context, option);\r\n\t\t}\r\n\t\tgetFillColorState(context, option = {}) {\r\n\t\t\tconst state = context.getSelectState();\r\n\t\t\tconst {col, row} = context;\r\n\t\t\tif (!state.selected && state.selection) {\r\n\t\t\t\treturn this.theme.selectionBgColor;\r\n\t\t\t} else {\r\n\t\t\t\tconst isFrozenCell = this._grid.isFrozenCell(col, row);\r\n\t\t\t\tif (isFrozenCell && isFrozenCell.row) {\r\n\t\t\t\t\treturn this.theme.frozenRowsBgColor;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn option.fillColor || this.theme.defaultBgColor;\r\n\t\t}\r\n\t\tborder(context,\r\n\t\t\t\t{\r\n\t\t\t\t\tborderColor = this.theme.borderColor,\r\n\t\t\t\t\tlineWidth = 1,\r\n\t\t\t\t} = {}) {\r\n\t\t\tconst rect = context.getRect();\r\n\r\n\t\t\tthis.drawBorderWithClip(context, (ctx) => {\r\n\t\t\t\tconst {col, row} = context;\r\n\t\t\t\tconst borderColors = getColor(borderColor, col, row, this._grid, ctx);\r\n\t\t\t\t\r\n\t\t\t\tif (lineWidth === 1) {\r\n\t\t\t\t\tctx.lineWidth = 1;\r\n\t\t\t\t\tstrokeRect(ctx, borderColors, rect.left - 0.5, rect.top - 0.5, rect.width, rect.height);\r\n\t\t\t\t} else if (lineWidth === 2) {\r\n\t\t\t\t\tctx.lineWidth = 2;\r\n\t\t\t\t\tstrokeRect(ctx, borderColors, rect.left, rect.top, rect.width - 1, rect.height - 1);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tctx.lineWidth = lineWidth;\r\n\t\t\t\t\tconst startOffset = (lineWidth / 2) - 1;\r\n\t\t\t\t\tstrokeRect(ctx, borderColors,\r\n\t\t\t\t\t\t\trect.left + startOffset,\r\n\t\t\t\t\t\t\trect.top + startOffset,\r\n\t\t\t\t\t\t\trect.width - lineWidth + 1,\r\n\t\t\t\t\t\t\trect.height - lineWidth + 1\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tborderWithState(context, option = {}) {\r\n\t\t\tconst rect = context.getRect();\r\n\t\t\tconst state = context.getSelectState();\r\n\t\t\tconst {col, row} = context;\r\n\r\n\t\t\t//\r\n\t\t\tif (state.selected) {\r\n\t\t\t\toption.borderColor = this.theme.hiliteBorderColor;\r\n\t\t\t\toption.lineWidth = 2;\r\n\t\t\t\tthis.border(context, option);\r\n\t\t\t} else {\r\n\t\t\t\t// header color\r\n\t\t\t\tconst isFrozenCell = this._grid.isFrozenCell(col, row);\r\n\t\t\t\tif (isFrozenCell && isFrozenCell.row) {\r\n\t\t\t\t\toption.borderColor = this.theme.frozenRowsBorderColor;\r\n\t\t\t\t}\r\n\r\n\t\t\t\toption.lineWidth = 1;\r\n\t\t\t\tthis.border(context, option);\r\n\r\n\t\t\t\t//\r\n\t\t\t\tconst sel = this._grid.selection.select;\r\n\t\t\t\tif (sel.col + 1 === col && sel.row === row) {\r\n\t\t\t\t\t//\r\n\t\t\t\t\tthis.drawBorderWithClip(context, (ctx) => {\r\n\t\t\t\t\t\tconst borderColors = toBoxArray(\r\n\t\t\t\t\t\t\t\tgetColor(this.theme.hiliteBorderColor, sel.col, sel.row, this._grid, ctx)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tctx.lineWidth = 1;\r\n\t\t\t\t\t\tctx.strokeStyle = borderColors[1];\r\n\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\tctx.moveTo(rect.left - 0.5, rect.top);\r\n\t\t\t\t\t\tctx.lineTo(rect.left - 0.5, rect.bottom);\r\n\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t});\r\n\t\t\t\t} else if (sel.col === col && sel.row + 1 === row) {\r\n\t\t\t\t\t//\r\n\t\t\t\t\tthis.drawBorderWithClip(context, (ctx) => {\r\n\t\t\t\t\t\tconst borderColors = toBoxArray(\r\n\t\t\t\t\t\t\t\tgetColor(this.theme.hiliteBorderColor, sel.col, sel.row, this._grid, ctx)\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tctx.lineWidth = 1;\r\n\t\t\t\t\t\tctx.strokeStyle = borderColors[0];\r\n\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\tctx.moveTo(rect.left, rect.top - 0.5);\r\n\t\t\t\t\t\tctx.lineTo(rect.right, rect.top - 0.5);\r\n\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tcheckbox(check, context, option = {}) {\r\n\t\t\tthis.drawWithClip(context, (ctx) => {\r\n\t\t\t\tdrawCheckbox(ctx, context.getRect(), check, this, option);\r\n\t\t\t});\r\n\t\t}\r\n\t\tbutton(caption, context,\r\n\t\t\t\t{\r\n\t\t\t\t\tbgColor = this.theme.button.bgColor,\r\n\t\t\t\t\tpadding,\r\n\t\t\t\t\toffset = 2,\r\n\t\t\t\t\tcolor = this.theme.button.color,\r\n\t\t\t\t\ttextAlign = 'center',\r\n\t\t\t\t\ttextBaseline = 'middle',\r\n\t\t\t\t\tshadow,\r\n\t\t\t\t\tfont,\r\n\t\t\t\t\ticons,\r\n\t\t\t\t} = {}) {\r\n\t\t\tconst rect = context.getRect();\r\n\r\n\t\t\tthis.drawWithClip(context, (ctx) => {\r\n\t\t\t\tconst {col, row} = context;\r\n\t\t\t\tpadding = this.toBoxPixelArray(padding || rect.height / 8, context);\r\n\t\t\t\tconst left = rect.left + padding[3];\r\n\t\t\t\tconst top = rect.top + padding[0];\r\n\t\t\t\tconst width = rect.width - padding[1] - padding[3];\r\n\t\t\t\tconst height = rect.height - padding[0] - padding[2];\r\n\r\n\t\t\t\tcanvashelper.drawButton(ctx, left, top, width, height, {\r\n\t\t\t\t\tbgColor,\r\n\t\t\t\t\tradius: rect.height / 8,\r\n\t\t\t\t\toffset,\r\n\t\t\t\t\tshadow,\r\n\t\t\t\t});\r\n\t\t\t\t_inlineRect(this._grid, ctx, caption, new Rect(left, top, width, height),\r\n\t\t\t\t\t\tcol, row,\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\toffset,\r\n\t\t\t\t\t\t\tcolor,\r\n\t\t\t\t\t\t\ttextAlign,\r\n\t\t\t\t\t\t\ttextBaseline,\r\n\t\t\t\t\t\t\tfont,\r\n\t\t\t\t\t\t\ticons,\r\n\t\t\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\ttestFontLoad(font, value, context) {\r\n\t\t\treturn testFontLoad(font, value, context, this._grid);\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.exports = GridCanvasHelper;\r\n}","'use strict';\r\n{\r\n\tconst {isDef, isPromise, then, obj: {isObject}} = require('./internal/utils');\r\n\tconst GridCanvasHelper = require('./GridCanvasHelper');\r\n\tconst columns = require('./columns');\r\n\tconst {BaseStyle} = columns.style;\r\n\tconst headerType = require('./header/type');\r\n\tconst {BaseStyle: HeaderBaseStyle} = require('./header/style');\r\n\tconst DrawGrid = require('./core/DrawGrid');\r\n\tconst {DataSource, CachedDataSource} = require('./data');\r\n\tconst themes = require('./themes');\r\n\tconst icons = require('./internal/icons');\r\n\tconst MessageHandler = require('./columns/message/MessageHandler');\r\n\tconst EVENT_TYPE = require('./list-grid/EVENT_TYPE');\r\n\t\r\n\t//protected symbol\r\n\tconst {PROTECTED_SYMBOL: _} = require('./internal/symbolManager');\r\n\r\n\tlet headerId = 0;\r\n\t//private methods\r\n\tfunction _getHeaderCellRange(grid, col, row) {\r\n\t\treturn grid[_].headerMap.getHeaderCellRange(col, row);\r\n\t}\r\n\tfunction _updateRect(grid, col, row, context) {\r\n\t\tconst rect = context.getRect();\r\n\t\tconst {\r\n\t\t\tstartCol,\r\n\t\t\tendCol,\r\n\t\t\tstartRow,\r\n\t\t\tendRow,\r\n\t\t} = _getHeaderCellRange(grid, col, row);\r\n\t\tfor (let c = col - 1; c >= startCol; c--) {\r\n\t\t\trect.left -= grid.getColWidth(c);\r\n\t\t}\r\n\t\tfor (let c = col + 1; c <= endCol; c++) {\r\n\t\t\trect.right += grid.getColWidth(c);\r\n\t\t}\r\n\t\tfor (let r = row - 1; r >= startRow; r--) {\r\n\t\t\trect.top -= grid.getRowHeight(r);\r\n\t\t}\r\n\t\tfor (let r = row + 1; r <= endRow; r++) {\r\n\t\t\trect.bottom += grid.getRowHeight(r);\r\n\t\t}\r\n\t\tcontext.setRect(rect);\r\n\t}\r\n\tfunction _getCellValue(grid, col, row) {\r\n\t\tif (row < grid[_].headerMap.rowCount) {\r\n\t\t\treturn grid[_].headerMap.getCell(col, row).caption;\r\n\t\t} else {\r\n\t\t\tlet {field} = grid[_].headerMap.columns[col];\r\n\t\t\tif (isObject(field) && field.get && field.set) {\r\n\t\t\t\tfield = field.get;\r\n\t\t\t}\r\n\t\t\treturn _getField(grid, field, row);\r\n\t\t}\r\n\t}\r\n\tfunction _setCellValue(grid, col, row, value) {\r\n\t\tif (row < grid[_].headerMap.rowCount) {\r\n\t\t\t// nop\r\n\t\t\treturn false;\r\n\t\t} else {\r\n\t\t\tlet {field} = grid[_].headerMap.columns[col];\r\n\t\t\tif (isObject(field) && field.get && field.set) {\r\n\t\t\t\tfield = field.set;\r\n\t\t\t}\r\n\t\t\tconst index = _getRowRecordIndex(grid, row);\r\n\t\t\tconst res = grid[_].dataSource.setField(index, field, value);\r\n\t\t\treturn isPromise(res) ? res : true;\r\n\t\t}\r\n\t}\r\n\tfunction _getCellMessage(grid, col, row) {\r\n\t\tif (row < grid[_].headerMap.rowCount) {\r\n\t\t\treturn null;\r\n\t\t} else {\r\n\t\t\tconst {message} = grid[_].headerMap.columns[col];\r\n\t\t\tif (!message) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn _getField(grid, message, row);\r\n\t\t}\r\n\t}\r\n\tfunction _getCellIcon0(grid, icon, row) {\r\n\t\tif (!isDef(icon)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (Array.isArray(icon)) {\r\n\t\t\treturn icon.map((i) => _getCellIcon0(grid, i, row));\r\n\t\t}\r\n\t\tif (!isObject(icon)) {\r\n\t\t\treturn _getField(grid, icon, row);\r\n\t\t}\r\n\t\tconst retIcon = {};\r\n\t\ticons.iconPropKeys.forEach((k) => {\r\n\t\t\tif (icon[k]) {\r\n\t\t\t\tconst f = _getField(grid, icon[k], row);\r\n\t\t\t\tif (isDef(f)) {\r\n\t\t\t\t\tretIcon[k] = f;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!_hasField(grid, icon[k], row)) {\r\n\t\t\t\t\t\tretIcon[k] = icon[k];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn retIcon;\r\n\t}\r\n\tfunction _getCellIcon(grid, col, row) {\r\n\t\tconst {icon} = grid[_].headerMap.columns[col];\r\n\t\treturn _getCellIcon0(grid, icon, row);\r\n\t}\r\n\tfunction _getField(grid, field, row) {\r\n\t\tif (!isDef(field)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (row < grid[_].headerMap.rowCount) {\r\n\t\t\treturn null;\r\n\t\t} else {\r\n\t\t\tconst index = _getRowRecordIndex(grid, row);\r\n\t\t\treturn grid[_].dataSource.getField(index, field);\r\n\t\t}\r\n\t}\r\n\tfunction _hasField(grid, field, row) {\r\n\t\tif (!isDef(field)) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (row < grid[_].headerMap.rowCount) {\r\n\t\t\treturn false;\r\n\t\t} else {\r\n\t\t\tconst index = _getRowRecordIndex(grid, row);\r\n\t\t\treturn grid[_].dataSource.hasField(index, field);\r\n\t\t}\r\n\t}\r\n\tfunction _onDrawValue(grid, cellValue, context, {col, row}, style, draw) {\r\n\t\tconst helper = grid[_].gridCanvasHelper;\r\n\r\n\t\tconst drawCellBg = ({bgColor} = {}) => {\r\n\t\t\tconst fillOpt = {\r\n\t\t\t\tfillColor: bgColor,\r\n\t\t\t};\r\n\t\t\t//cell\r\n\t\t\thelper.fillCellWithState(context, fillOpt);\r\n\t\t};\r\n\t\tconst drawCellBorder = () => {\r\n\r\n\t\t\tif (context.col === grid.frozenColCount - 1) {\r\n\t\t\t\t//\r\n\t\t\t\tconst rect = context.getRect();\r\n\t\t\t\thelper.drawWithClip(context, (ctx) => {\r\n\t\t\t\t\tconst borderColor = context.row >= grid.frozenRowCount ? helper.theme.borderColor\r\n\t\t\t\t\t\t: helper.theme.frozenRowsBorderColor;\r\n\r\n\t\t\t\t\tconst borderColors = helper.toBoxArray(\r\n\t\t\t\t\t\t\thelper.getColor(borderColor, context.col, context.row, ctx)\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (borderColors[1]) {\r\n\t\t\t\t\t\tctx.lineWidth = 1;\r\n\t\t\t\t\t\tctx.strokeStyle = borderColors[1];\r\n\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\tctx.moveTo(rect.right - 2.5, rect.top);\r\n\t\t\t\t\t\tctx.lineTo(rect.right - 2.5, rect.bottom);\r\n\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\tif (context.row < grid[_].headerMap.rowCount) {\r\n\t\t\t\t_headerBorderWithState(grid, helper, context);\r\n\t\t\t} else {\r\n\t\t\t\thelper.borderWithState(context);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\r\n\t\tconst drawCellBase = ({bgColor} = {}) => {\r\n\t\t\tdrawCellBg({bgColor});\r\n\t\t\tdrawCellBorder();\r\n\t\t};\r\n\t\tconst info = {\r\n\t\t\tgetRecord: () => grid.getRowRecord(row),\r\n\t\t\tgetIcon: () => _getCellIcon(grid, col, row),\r\n\t\t\tgetMessage: () => _getCellMessage(grid, col, row),\r\n\t\t\tmessageHandler: grid[_].messageHandler,\r\n\t\t\tstyle,\r\n\t\t\tdrawCellBase,\r\n\t\t\tdrawCellBg,\r\n\t\t\tdrawCellBorder,\r\n\t\t};\r\n\r\n\t\treturn draw(cellValue, info, context, grid);\r\n\t}\r\n\tfunction _headerBorderWithState(grid, helper, context) {\r\n\t\tconst {col, row} = context;\r\n\t\tconst sel = grid.selection.select;\r\n\t\tif (sel.row >= grid[_].headerMap.rowCount) {\r\n\t\t\t//\r\n\t\t\thelper.borderWithState(context);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst {id} = grid[_].headerMap.getCell(col, row);\r\n\r\n\t\tconst rect = context.getRect();\r\n\t\tconst option = {};\r\n\r\n\t\tconst {id: selId} = grid[_].headerMap.getCell(sel.col, sel.row);\r\n\t\t//\r\n\t\tif (selId === id) {\r\n\t\t\toption.borderColor = helper.theme.hiliteBorderColor;\r\n\t\t\toption.lineWidth = 2;\r\n\t\t\thelper.border(context, option);\r\n\t\t} else {\r\n\t\t\toption.lineWidth = 1;\r\n\t\t\t// header color\r\n\t\t\tconst isFrozenCell = grid.isFrozenCell(col, row);\r\n\t\t\tif (isFrozenCell && isFrozenCell.row) {\r\n\t\t\t\toption.borderColor = helper.theme.frozenRowsBorderColor;\r\n\t\t\t}\r\n\t\t\thelper.border(context, option);\r\n\r\n\t\t\t//\r\n\t\t\tif (col > 0 && grid[_].headerMap.getCell(col - 1, row).id === selId) {\r\n\t\t\t\t//\r\n\t\t\t\thelper.drawBorderWithClip(context, (ctx) => {\r\n\t\t\t\t\tconst borderColors = helper.toBoxArray(\r\n\t\t\t\t\t\t\thelper.getColor(helper.theme.hiliteBorderColor, sel.col, sel.row, ctx)\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (borderColors[1]) {\r\n\t\t\t\t\t\tctx.lineWidth = 1;\r\n\t\t\t\t\t\tctx.strokeStyle = borderColors[1];\r\n\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\tctx.moveTo(rect.left - 0.5, rect.top);\r\n\t\t\t\t\t\tctx.lineTo(rect.left - 0.5, rect.bottom);\r\n\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else if (row > 0 &&\r\n\t\t\t\t\t\tgrid[_].headerMap.getCell(col, row - 1).id === selId) {\r\n\t\t\t\t//\r\n\t\t\t\thelper.drawBorderWithClip(context, (ctx) => {\r\n\t\t\t\t\tconst borderColors = helper.toBoxArray(\r\n\t\t\t\t\t\t\thelper.getColor(helper.theme.hiliteBorderColor, sel.col, sel.row, ctx)\r\n\t\t\t\t\t);\r\n\t\t\t\t\tif (borderColors[0]) {\r\n\t\t\t\t\t\tctx.lineWidth = 1;\r\n\t\t\t\t\t\tctx.strokeStyle = borderColors[0];\r\n\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\tctx.moveTo(rect.left, rect.top - 0.5);\r\n\t\t\t\t\t\tctx.lineTo(rect.right, rect.top - 0.5);\r\n\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tfunction _refreshHeader(grid) {\r\n\t\tif (grid[_].headerEvents) {\r\n\t\t\tgrid[_].headerEvents.forEach((id) => grid.unlisten(id));\r\n\t\t}\r\n\t\tgrid[_].headerMap = new HeaderMap(grid[_].header);\r\n\t\tgrid[_].headerEvents = [];\r\n\t\tgrid[_].headerMap.headerObjects.forEach((cell) => {\r\n\t\t\tconst ids = cell.headerType.bindGridEvent(grid);\r\n\t\t\tgrid[_].headerEvents.push(...ids);\r\n\t\t\tif (cell.style) {\r\n\t\t\t\tif (cell.style instanceof HeaderBaseStyle) {\r\n\t\t\t\t\tconst id = cell.style.listen(HeaderBaseStyle.EVENT_TYPE.CHANGE_STYLE, () => {\r\n\t\t\t\t\t\tgrid.invalidate();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tgrid[_].headerEvents.push(id);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tgrid[_].headerMap.columns.forEach((col, index) => {\r\n\t\t\tif (col.action) {\r\n\t\t\t\tconst ids = col.action.bindGridEvent(grid, index, {\r\n\t\t\t\t\tisTarget(col, row) {\r\n\t\t\t\t\t\treturn index === col && grid.frozenRowCount <= row;\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t\tgrid[_].headerEvents.push(...ids);\r\n\t\t\t}\r\n\t\t\tif (col.columnType) {\r\n\t\t\t\tconst ids = col.columnType.bindGridEvent(grid, index, {\r\n\t\t\t\t\tisTarget(col, row) {\r\n\t\t\t\t\t\treturn index === col && grid.frozenRowCount <= row;\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t\tgrid[_].headerEvents.push(...ids);\r\n\t\t\t}\r\n\t\t\tif (col.style) {\r\n\t\t\t\tif (col.style instanceof BaseStyle) {\r\n\t\t\t\t\tconst id = col.style.listen(columns.style.EVENT_TYPE.CHANGE_STYLE, () => {\r\n\t\t\t\t\t\tgrid.invalidate();\r\n\t\t\t\t\t});\r\n\t\t\t\t\tgrid[_].headerEvents.push(id);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tgrid.colCount = grid[_].headerMap.columns.length;\r\n\t\t_refreshRowCount(grid);\r\n\t\tgrid.frozenRowCount = grid[_].headerMap.rowCount;\r\n\t\tfor (let col = 0; col < grid[_].headerMap.columns.length; col++) {\r\n\t\t\tconst column = grid[_].headerMap.columns[col];\r\n\t\t\tconst {width, minWidth, maxWidth} = column;\r\n\t\t\tif (width && (width > 0 || typeof width === 'string')) {\r\n\t\t\t\tgrid.setColWidth(col, width);\r\n\t\t\t}\r\n\t\t\tif (minWidth && (minWidth > 0 || typeof minWidth === 'string')) {\r\n\t\t\t\tgrid.setMinColWidth(col, minWidth);\r\n\t\t\t}\r\n\t\t\tif (maxWidth && (maxWidth > 0 || typeof maxWidth === 'string')) {\r\n\t\t\t\tgrid.setMaxColWidth(col, maxWidth);\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst isArrayHeaderRowHeight = Array.isArray(grid[_].headerRowHeight);\r\n\t\tfor (let row = 0; row < grid[_].headerMap.rowCount; row++) {\r\n\t\t\tconst height = isArrayHeaderRowHeight ? grid[_].headerRowHeight[row] : grid[_].headerRowHeight;\r\n\t\t\tif (height && height > 0) {\r\n\t\t\t\tgrid.setRowHeight(row, height);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction _refreshRowCount(grid) {\r\n\t\tgrid.rowCount = grid[_].dataSource.length + grid[_].headerMap.rowCount;\r\n\t}\r\n\tfunction _tryWithUpdateDataSource(grid, fn) {\r\n\t\tif (grid[_].dataSourceEventIds) {\r\n\t\t\tgrid[_].dataSourceEventIds.forEach((id) => grid[_].handler.off(id));\r\n\t\t}\r\n\r\n\t\tfn(grid);\r\n\r\n\t\tgrid[_].dataSourceEventIds = [\r\n\t\t\tgrid[_].handler.on(grid[_].dataSource, DataSource.EVENT_TYPE.UPDATED_LENGTH, () => {\r\n\t\t\t\t_refreshRowCount(grid);\r\n\t\t\t\tgrid.invalidate();\r\n\t\t\t}),\r\n\t\t\tgrid[_].handler.on(grid[_].dataSource, DataSource.EVENT_TYPE.UPDATED_ORDER, () => {\r\n\t\t\t\tgrid.invalidate();\r\n\t\t\t}),\r\n\t\t];\r\n\t}\r\n\tfunction _setRecords(grid, records = []) {\r\n\t\t_tryWithUpdateDataSource(grid, () => {\r\n\t\t\tgrid[_].records = records;\r\n\t\t\tgrid[_].dataSource = CachedDataSource.ofArray(grid[_].records);\r\n\t\t});\r\n\t}\r\n\tfunction _setDataSource(grid, dataSource) {\r\n\t\t_tryWithUpdateDataSource(grid, () => {\r\n\t\t\tif (dataSource) {\r\n\t\t\t\tif (dataSource instanceof DataSource) {\r\n\t\t\t\t\tgrid[_].dataSource = dataSource;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tgrid[_].dataSource = new CachedDataSource(dataSource);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tgrid[_].dataSource = DataSource.EMPTY;\r\n\t\t\t}\r\n\t\t\tgrid[_].records = null;\r\n\t\t});\r\n\t}\r\n\r\n\tfunction _getRowRecordIndex(grid, row) {\r\n\t\tif (row < grid[_].headerMap.rowCount) {\r\n\t\t\treturn undefined;\r\n\t\t} else {\r\n\t\t\treturn row - grid[_].headerMap.rowCount;\r\n\t\t}\r\n\t}\r\n\t//end private methods\r\n\t//\r\n\t//\r\n\t//\r\n\r\n\tclass HeaderMap {\r\n\t\tconstructor(header) {\r\n\t\t\tthis._columns = [];\r\n\t\t\tthis._headerCells = [];\r\n\t\t\tthis._headerObjects = [];\r\n\r\n\t\t\tthis._addHeaders(0, header, []);\r\n\t\t\tthis._setupHeaderType();\r\n\t\t}\r\n\t\tget columns() {\r\n\t\t\treturn this._columns;\r\n\t\t}\r\n\t\tget rowCount() {\r\n\t\t\treturn this._headerCells.length;\r\n\t\t}\r\n\t\tget headerObjects() {\r\n\t\t\treturn this._headerObjects;\r\n\t\t}\r\n\t\tgetCell(col, row) {\r\n\t\t\treturn this._headerCells[row][col];\r\n\t\t}\r\n\t\tgetHeaderCellRangeById(id) {\r\n\t\t\tfor (let r = 0; r < this.rowCount; r++) {\r\n\t\t\t\tfor (let c = 0; c < this.columns.length; c++) {\r\n\t\t\t\t\tif (id === this.getCell(c, r).id) {\r\n\t\t\t\t\t\treturn this.getHeaderCellRange(c, r);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t\tgetHeaderCellRange(col, row) {\r\n\t\t\tconst result = {\r\n\t\t\t\tstartCol: col,\r\n\t\t\t\tstartRow: row,\r\n\t\t\t\tendCol: col,\r\n\t\t\t\tendRow: row,\r\n\t\t\t\tisCellInRange(col, row) {\r\n\t\t\t\t\treturn this.startCol <= col && col <= this.endCol &&\r\n\t\t\t\t\t\t\tthis.startRow <= row && row <= this.endRow;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\tconst {id} = this.getCell(col, row);\r\n\t\t\tfor (let c = col - 1; c >= 0; c--) {\r\n\t\t\t\tif (id !== this.getCell(c, row).id) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tresult.startCol = c;\r\n\t\t\t}\r\n\t\t\tfor (let c = col + 1; c < this.columns.length; c++) {\r\n\t\t\t\tif (id !== this.getCell(c, row).id) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tresult.endCol = c;\r\n\t\t\t}\r\n\t\t\tfor (let r = row - 1; r >= 0; r--) {\r\n\t\t\t\tif (id !== this.getCell(col, r).id) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tresult.startRow = r;\r\n\t\t\t}\r\n\t\t\tfor (let r = row + 1; r < this.rowCount; r++) {\r\n\t\t\t\tif (id !== this.getCell(col, r).id) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tresult.endRow = r;\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\t_addHeaders(row, header, roots) {\r\n\t\t\tconst rowCells = this._headerCells[row] || this._newRow(row);\r\n\t\t\theader.forEach((hd) => {\r\n\t\t\t\tconst col = this._columns.length;\r\n\t\t\t\tconst cell = {\r\n\t\t\t\t\tid: headerId++,\r\n\t\t\t\t\tcaption: hd.caption,\r\n\t\t\t\t\tstyle: hd.headerStyle,\r\n\t\t\t\t\tsort: hd.sort,\r\n\t\t\t\t};\r\n\t\t\t\tthis._headerObjects.push(cell);\r\n\t\t\t\trowCells[col] = cell;\r\n\t\t\t\tfor (let r = row - 1; r >= 0; r--) {\r\n\t\t\t\t\tthis._headerCells[r][col] = roots[r];\r\n\t\t\t\t}\r\n\t\t\t\tif (hd.columns) {\r\n\t\t\t\t\tthis._addHeaders(row + 1, hd.columns, [...roots, cell]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._columns.push({\r\n\t\t\t\t\t\twidth: hd.width,\r\n\t\t\t\t\t\tminWidth: hd.minWidth,\r\n\t\t\t\t\t\tmaxWidth: hd.maxWidth,\r\n\t\t\t\t\t\tfield: hd.field,\r\n\t\t\t\t\t\ticon: hd.icon,\r\n\t\t\t\t\t\tmessage: hd.message,\r\n\t\t\t\t\t\tcolumnType: columns.type.of(hd.columnType),\r\n\t\t\t\t\t\taction: columns.action.of(hd.action),\r\n\t\t\t\t\t\tstyle: hd.style,\r\n\t\t\t\t\t\tdefine: hd,\r\n\t\t\t\t\t});\r\n\t\t\t\t\tfor (let r = row + 1; r < this._headerCells.length; r++) {\r\n\t\t\t\t\t\tthis._headerCells[r][col] = cell;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t_setupHeaderType() {\r\n\t\t\tthis._headerObjects.forEach((cell) => {\r\n\t\t\t\tcell.range = this.getHeaderCellRangeById(cell.id);\r\n\t\t\t\tcell.headerType = headerType.create(cell);\r\n\t\t\t});\r\n\t\t}\r\n\t\t_newRow(row) {\r\n\t\t\tconst newRow = this._headerCells[row] = [];\r\n\t\t\tif (!this._columns.length) {\r\n\t\t\t\treturn newRow;\r\n\t\t\t}\r\n\t\t\tconst prev = this._headerCells[row - 1];\r\n\t\t\tfor (let col = 0; col < prev.length; col++) {\r\n\t\t\t\tnewRow[col] = prev[col];\r\n\t\t\t}\r\n\t\t\treturn newRow;\r\n\t\t}\r\n\t}\r\n\r\n\tfunction adjustListGridOption(options) {\r\n\t\tif (options) {\r\n\t\t\tdelete options.frozenRowCount;\r\n\t\t\tdelete options.colCount;\r\n\t\t\tdelete options.rowCount;\r\n\t\t}\r\n\t\treturn options;\r\n\t}\r\n\t\r\n\t/**\r\n\t * ListGrid\r\n\t * @classdesc cheetahGrid.ListGrid\r\n\t * @extends cheetahGrid.core.DrawGrid\r\n\t * @memberof cheetahGrid\r\n\t */\r\n\tclass ListGrid extends DrawGrid {\r\n\t\tstatic get EVENT_TYPE() {\r\n\t\t\treturn EVENT_TYPE;\r\n\t\t}\r\n\t\t/**\r\n\t\t * constructor\r\n\t\t *\r\n\t\t * <pre>\r\n\t\t * Constructor options\r\n\t\t * -----\r\n\t\t * header: see header property\r\n\t\t * records {array}: records data\r\n\t\t * dataSource {DataSource}: records data source\r\n\t\t * frozenColCount {number}: default 0\r\n\t\t * defaultRowHeight {number}: default grid row height. default 40\r\n\t\t * defaultColWidth {number}: default grid col width. default 80\r\n\t\t * borderColor: border color\r\n\t\t * parentElement {Element}: canvas parentElement\r\n\t\t * theme {object}: theme\r\n\t\t * -----\r\n\t\t * </pre>\r\n\t\t *\r\n\t\t * @constructor\r\n\t\t * @param  {Object} options Constructor options\r\n\t\t */\r\n\t\tconstructor(options = {}) {\r\n\t\t\tsuper(adjustListGridOption(options));\r\n\t\t\tthis[_].header = options.header || [];\r\n\t\t\tthis[_].headerRowHeight = options.headerRowHeight || [];\r\n\t\t\tif (options.dataSource) {\r\n\t\t\t\t_setDataSource(this, options.dataSource);\r\n\t\t\t} else {\r\n\t\t\t\t_setRecords(this, options.records);\r\n\t\t\t}\r\n\t\t\t_refreshHeader(this);\r\n\t\t\tthis[_].sortState = {\r\n\t\t\t\tcol: -1,\r\n\t\t\t\torder: undefined,\r\n\t\t\t};\r\n\t\t\tthis[_].gridCanvasHelper = new GridCanvasHelper(this);\r\n\t\t\tthis[_].theme = themes.of(options.theme);\r\n\t\t\tthis[_].messageHandler = new MessageHandler(this, (col, row) => _getCellMessage(this, col, row));\r\n\t\t\tthis.invalidate();\r\n\t\t\tthis[_].handler.on(window, 'resize', () => {\r\n\t\t\t\tthis.updateSize();\r\n\t\t\t\tthis.updateScroll();\r\n\t\t\t\tthis.invalidate();\r\n\t\t\t});\r\n\t\t}\r\n\t\tdispose() {\r\n\t\t\tthis[_].messageHandler.dispose();\r\n\t\t\tsuper.dispose();\r\n\t\t}\r\n\t\t/**\r\n\t\t * header define\r\n\t\t * @type {Array}\r\n\t\t */\r\n\t\tget header() {\r\n\t\t\treturn this[_].header;\r\n\t\t}\r\n\t\t/**\r\n\t\t * header define\r\n\t\t * <pre>\r\n\t\t * column options\r\n\t\t * -----\r\n\t\t * caption: header caption\r\n\t\t * field: field name\r\n\t\t * width: column width\r\n\t\t * minWidth: column min width\r\n\t\t * maxWidth: column max width\r\n\t\t * icon: icon name\r\n\t\t * message: message key name\r\n\t\t * columnType: ColumnType\r\n\t\t * action: ColumnAction\r\n\t\t * style: ColumnStyle\r\n\t\t * sort: define sort setting\r\n\t\t * -----\r\n\t\t *\r\n\t\t * multiline header\r\n\t\t * -----\r\n\t\t * caption: header caption\r\n\t\t * columns: columns define\r\n\t\t * -----\r\n\t\t * </pre>\r\n\t\t *\r\n\t\t * @type {Array}\r\n\t\t */\r\n\t\tset header(header) {\r\n\t\t\tthis[_].header = header;\r\n\t\t\t_refreshHeader(this);\r\n\t\t}\r\n\t\tget records() {\r\n\t\t\treturn this[_].records;\r\n\t\t}\r\n\t\tset records(records) {\r\n\t\t\t_setRecords(this, records);\r\n\t\t\t_refreshRowCount(this);\r\n\t\t\tthis.invalidate();\r\n\t\t}\r\n\t\tget dataSource() {\r\n\t\t\treturn this[_].dataSource;\r\n\t\t}\r\n\t\tset dataSource(dataSource) {\r\n\t\t\t_setDataSource(this, dataSource);\r\n\t\t\t_refreshRowCount(this);\r\n\t\t\tthis.invalidate();\r\n\t\t}\r\n\t\tget theme() {\r\n\t\t\treturn this[_].theme;\r\n\t\t}\r\n\t\tset theme(theme) {\r\n\t\t\tthis[_].theme = themes.of(theme);\r\n\t\t\tthis.invalidate();\r\n\t\t}\r\n\t\tget font() {\r\n\t\t\treturn super.font || this[_].gridCanvasHelper.theme.font;\r\n\t\t}\r\n\t\tset font(font) {\r\n\t\t\tsuper.font = font;\r\n\t\t}\r\n\t\tget underlayBackgroundColor() {\r\n\t\t\treturn super.underlayBackgroundColor || this[_].gridCanvasHelper.theme.underlayBackgroundColor;\r\n\t\t}\r\n\t\tset underlayBackgroundColor(underlayBackgroundColor) {\r\n\t\t\tsuper.underlayBackgroundColor = underlayBackgroundColor;\r\n\t\t}\r\n\t\tget sortState() {\r\n\t\t\treturn this[_].sortState;\r\n\t\t}\r\n\t\tset sortState(sortState) {\r\n\t\t\tthis[_].sortState = sortState;\r\n\t\t}\r\n\t\tgetField(col) {\r\n\t\t\treturn this[_].headerMap.columns[col].field;\r\n\t\t}\r\n\t\tgetRowRecord(row) {\r\n\t\t\tif (row < this[_].headerMap.rowCount) {\r\n\t\t\t\treturn undefined;\r\n\t\t\t} else {\r\n\t\t\t\treturn this[_].dataSource.get(_getRowRecordIndex(this, row));\r\n\t\t\t}\r\n\t\t}\r\n\t\tgetGridCanvasHelper() {\r\n\t\t\treturn this[_].gridCanvasHelper;\r\n\t\t}\r\n\t\tgetCopyCellValue(col, row) {\r\n\t\t\tif (row < this[_].headerMap.rowCount) {\r\n\t\t\t\tconst {startCol, startRow} = _getHeaderCellRange(this, col, row);\r\n\t\t\t\tif (startCol !== col || startRow !== row) {\r\n\t\t\t\t\treturn '';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn _getCellValue(this, col, row);\r\n\t\t}\r\n\t\tonDrawCell(col, row, context) {\r\n\t\t\tconst column = this[_].headerMap.columns[col];\r\n\r\n\t\t\tlet draw;\r\n\t\t\tlet style;\r\n\t\t\tif (row < this[_].headerMap.rowCount) {\r\n\t\t\t\tconst hd = this[_].headerMap.getCell(col, row);\r\n\t\t\t\tdraw = hd.headerType.onDrawCell;\r\n\t\t\t\t({style} = hd);\r\n\t\t\t\t_updateRect(this, col, row, context);\r\n\t\t\t} else {\r\n\t\t\t\tdraw = column.columnType.onDrawCell;\r\n\t\t\t\t({style} = column);\r\n\t\t\t}\r\n\t\t\tconst cellValue = _getCellValue(this, col, row);\r\n\t\t\treturn _onDrawValue(this, cellValue, context, {col, row}, style, draw);\r\n\t\t}\r\n\t\tdoGetCellValue(col, row, valueCallback) {\r\n\t\t\tif (row < this[_].headerMap.rowCount) {\r\n\t\t\t\t// nop\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tconst value = _getCellValue(this, col, row);\r\n\t\t\t\tif (isPromise(value)) {\r\n\t\t\t\t\t//\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tvalueCallback(value);\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tdoChangeValue(col, row, changeValueCallback) {\r\n\t\t\tif (row < this[_].headerMap.rowCount) {\r\n\t\t\t\t// nop\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tconst before = _getCellValue(this, col, row);\r\n\t\t\t\tif (isPromise(before)) {\r\n\t\t\t\t\t//\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tconst after = changeValueCallback(before);\r\n\t\t\t\tif (after === undefined) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\treturn then(_setCellValue(this, col, row, after), (ret) => {\r\n\t\t\t\t\tif (ret) {\r\n\t\t\t\t\t\tconst {field} = this[_].headerMap.columns[col];\r\n\t\t\t\t\t\tconst self = this;\r\n\t\t\t\t\t\tthis.fireListeners(EVENT_TYPE.CHANGED_VALUE, {\r\n\t\t\t\t\t\t\tcol,\r\n\t\t\t\t\t\t\trow,\r\n\t\t\t\t\t\t\tget record() {\r\n\t\t\t\t\t\t\t\treturn self.getRowRecord(row);\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfield,\r\n\t\t\t\t\t\t\tvalue: after,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn ret;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tbindEventsInternal() {\r\n\t\t\tthis.listen(EVENT_TYPE.SELECTED_CELL, (e) => {\r\n\t\t\t\tif (e.row < this[_].headerMap.rowCount) {\r\n\t\t\t\t\tconst {startCol, endCol, startRow, endRow} = _getHeaderCellRange(this, e.col, e.row);\r\n\t\t\t\t\tif (startCol !== endCol || startRow !== endRow) {\r\n\t\t\t\t\t\tthis.invalidateGridRect(startCol, startRow, endCol, endRow);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tgetMoveLeftColByKeyDownInternal({col, row}) {\r\n\t\t\tif (row < this[_].headerMap.rowCount) {\r\n\t\t\t\tconst {startCol} = _getHeaderCellRange(this, col, row);\r\n\t\t\t\tcol = startCol;\r\n\t\t\t}\r\n\t\t\treturn super.getMoveLeftColByKeyDownInternal({col, row});\r\n\t\t}\r\n\t\tgetMoveRightColByKeyDownInternal({col, row}) {\r\n\t\t\tif (row < this[_].headerMap.rowCount) {\r\n\t\t\t\tconst {endCol} = _getHeaderCellRange(this, col, row);\r\n\t\t\t\tcol = endCol;\r\n\t\t\t}\r\n\t\t\treturn super.getMoveRightColByKeyDownInternal({col, row});\r\n\t\t}\r\n\t\tgetMoveUpRowByKeyDownInternal({col, row}) {\r\n\t\t\tif (row < this[_].headerMap.rowCount) {\r\n\t\t\t\tconst {startRow} = _getHeaderCellRange(this, col, row);\r\n\t\t\t\trow = startRow;\r\n\t\t\t}\r\n\t\t\treturn super.getMoveUpRowByKeyDownInternal({col, row});\r\n\t\t}\r\n\t\tgetMoveDownRowByKeyDownInternal({col, row}) {\r\n\t\t\tif (row < this[_].headerMap.rowCount) {\r\n\t\t\t\tconst {endRow} = _getHeaderCellRange(this, col, row);\r\n\t\t\t\trow = endRow;\r\n\t\t\t}\r\n\t\t\treturn super.getMoveDownRowByKeyDownInternal({col, row});\r\n\t\t}\r\n\t\tgetOffsetInvalidateCells() {\r\n\t\t\treturn 1;\r\n\t\t}\r\n\t\tgetColumnIndexByField(field) {\r\n\t\t\tfor (const columnIndex in this[_].headerMap.columns) {\r\n\t\t\t\tif (this[_].headerMap.columns[columnIndex].field === field) {\r\n\t\t\t\t\treturn columnIndex - 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tfocusGridCell(field, index) {\r\n\t\t\tconst {\r\n\t\t\t\tstart: {col: startCol, row: startRow},\r\n\t\t\t\tend: {col: endCol, row: endRow}\r\n\t\t\t} = this.selection.range;\r\n\r\n\t\t\tconst newCol = this.getColumnIndexByField(field);\r\n\t\t\tconst newRow = index + this[_].headerMap.rowCount;\r\n\t\t\tthis.focusCell(newCol, newRow);\r\n\t\t\tthis.selection.select = {\r\n\t\t\t\tcol: newCol,\r\n\t\t\t\trow: newRow\r\n\t\t\t};\r\n\t\t\tthis.invalidateGridRect(startCol, startRow, endCol, endRow);\r\n\t\t\tthis.invalidateCell(newCol, newRow);\r\n\t\t}\r\n\t\tmakeVisibleGridCell(field, index) {\r\n\t\t\tthis.makeVisibleCell(this.getColumnIndexByField(field), index + this[_].headerMap.rowCount);\r\n\t\t}\r\n\t}\r\n\tmodule.exports = ListGrid;\r\n}","'use strict';\r\n{\r\n\tconst action = require('./columns/action');\r\n\tconst type = require('./columns/type');\r\n\tconst style = require('./columns/style');\r\n\r\n\t/**\r\n\t * columns\r\n\t * @type {Object}\r\n\t * @namespace cheetahGrid.columns\r\n\t * @memberof cheetahGrid\r\n\t */\r\n\tmodule.exports = {\r\n\t\taction,\r\n\t\ttype,\r\n\t\tstyle,\r\n\t};\r\n}","'use strict';\r\n{\r\n\tconst BaseAction = require('./action/BaseAction');\r\n\tconst Action = require('./action/Action');\r\n\tconst Editor = require('./action/Editor');\r\n\tconst CheckEditor = require('./action/CheckEditor');\r\n\tconst ButtonAction = require('./action/ButtonAction');\r\n\tconst SmallDialogInputEditor = require('./action/SmallDialogInputEditor');\r\n\tconst InlineInputEditor = require('./action/InlineInputEditor');\r\n\tconst InlineMenuEditor = require('./action/InlineMenuEditor');\r\n\r\n\tclass ImmutableCheckEditor extends CheckEditor {\r\n\t\tget disabled() {\r\n\t\t\treturn this._disabled;\r\n\t\t}\r\n\t\tget readOnly() {\r\n\t\t\treturn this._readOnly;\r\n\t\t}\r\n\t}\r\n\tclass ImmutableInputEditor extends SmallDialogInputEditor {\r\n\t\tget disabled() {\r\n\t\t\treturn this._disabled;\r\n\t\t}\r\n\t\tget readOnly() {\r\n\t\t\treturn this._readOnly;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * column actions\r\n\t * @type {Object}\r\n\t * @namespace cheetahGrid.columns.action\r\n\t * @memberof cheetahGrid.columns\r\n\t */\r\n\tconst action = {\r\n\t\tACTIONS: {\r\n\t\t\tCHECK: new ImmutableCheckEditor(),\r\n\t\t\tINPUT: new ImmutableInputEditor(),\r\n\t\t},\r\n\t\tget BaseAction() {\r\n\t\t\treturn BaseAction;\r\n\t\t},\r\n\t\tget Editor() {\r\n\t\t\treturn Editor;\r\n\t\t},\r\n\t\tget Action() {\r\n\t\t\treturn Action;\r\n\t\t},\r\n\t\tget CheckEditor() {\r\n\t\t\treturn CheckEditor;\r\n\t\t},\r\n\t\tget ButtonAction() {\r\n\t\t\treturn ButtonAction;\r\n\t\t},\r\n\t\tget SmallDialogInputEditor() {\r\n\t\t\treturn SmallDialogInputEditor;\r\n\t\t},\r\n\t\tget InlineInputEditor() {\r\n\t\t\tconsole.warn('InlineInputEditor is an experiment stage');\r\n\t\t\treturn InlineInputEditor;\r\n\t\t},\r\n\t\tget InlineMenuEditor() {\r\n\t\t\treturn InlineMenuEditor;\r\n\t\t},\r\n\t\tof(columnAction) {\r\n\t\t\tif (!columnAction) {\r\n\t\t\t\treturn action.ACTIONS.DEFAULT;\r\n\t\t\t} else if (typeof columnAction === 'string') {\r\n\t\t\t\treturn action.ACTIONS[columnAction.toUpperCase()] || action.of(null);\r\n\t\t\t} else {\r\n\t\t\t\treturn columnAction;\r\n\t\t\t}\r\n\t\t},\r\n\t};\r\n\tmodule.exports = action;\r\n}","'use strict';\r\n{\r\n\t\r\n\tconst {bindCellClickAction, bindCellKeyAction} = require('./actionBind');\r\n\r\n\tconst BaseAction = require('./BaseAction');\r\n\r\n\tclass Action extends BaseAction {\r\n\t\tconstructor(option = {}) {\r\n\t\t\tsuper(option);\r\n\t\t\tthis._action = option.action;\r\n\t\t}\r\n\t\tget action() {\r\n\t\t\treturn this._action;\r\n\t\t}\r\n\t\tset action(action) {\r\n\t\t\tthis._action = action;\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new Action(this);\r\n\t\t}\r\n\t\tgetState(grid) {\r\n\t\t\treturn {};\r\n\t\t}\r\n\t\tbindGridEvent(grid, col, util) {\r\n\t\t\tconst state = this.getState(grid);\r\n\t\t\tconst action = (cell) => {\r\n\t\t\t\tif (this.disabled) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst record = grid.getRowRecord(cell.row);\r\n\t\t\t\tthis._action(record);\r\n\t\t\t};\r\n\r\n\t\t\treturn [\r\n\t\t\t\t...bindCellClickAction(grid, col, util, {\r\n\t\t\t\t\taction,\r\n\t\t\t\t\tmouseOver: (e) => {\r\n\t\t\t\t\t\tif (this.disabled) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstate.mouseActiveCell = {\r\n\t\t\t\t\t\t\tcol: e.col,\r\n\t\t\t\t\t\t\trow: e.row\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tgrid.invalidateCell(e.col, e.row);\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmouseOut: (e) => {\r\n\t\t\t\t\t\tdelete state.mouseActiveCell;\r\n\t\t\t\t\t\tgrid.invalidateCell(e.col, e.row);\r\n\t\t\t\t\t},\r\n\t\t\t\t}),\r\n\t\t\t\t...bindCellKeyAction(grid, col, util, {\r\n\t\t\t\t\taction\r\n\t\t\t\t})\r\n\t\t\t];\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.exports = Action;\r\n}","'use strict';\r\n{\r\n\t\r\n\r\n\tclass BaseAction {\r\n\t\tconstructor(option = {}) {\r\n\t\t\tthis._disabled = option.disabled;\r\n\t\t}\r\n\t\tget disabled() {\r\n\t\t\treturn this._disabled;\r\n\t\t}\r\n\t\tset disabled(disabled) {\r\n\t\t\tthis._disabled = !!disabled;\r\n\t\t\tthis.onChangeDisabledInternal();\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new BaseAction(this);\r\n\t\t}\r\n\t\tbindGridEvent(grid, col, util) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t\tonChangeDisabledInternal() {}\r\n\t}\r\n\tmodule.exports = BaseAction;\r\n}","'use strict';\r\n{\r\n\t\r\n\tconst Editor = require('./Editor');\r\n\tconst {EVENT_TYPE: {\r\n\t\tINPUT_CELL,\r\n\t\tEDITABLEINPUT_CELL,\r\n\t\tSELECTED_CELL,\r\n\t\tDBLCLICK_CELL,\r\n\t\tDBLTAP_CELL,\r\n\t\tKEYDOWN,\r\n\t\tMODIFY_STATUS_EDITABLEINPUT_CELL,\r\n\t\tSCROLL\r\n\t}} = require('../../core/DrawGrid');\r\n\tconst KEY_ENTER = 13;\r\n\tconst KEY_F2 = 113;\r\n\r\n\tclass BaseInputEditor extends Editor {\r\n\t\tconstructor(option = {}) {\r\n\t\t\tsuper(option);\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new BaseInputEditor(this);\r\n\t\t}\r\n\t\tonInputCellInternal(grid, cell, inputValue) {\r\n\t\t\tthrow new Error();\r\n\t\t}\r\n\t\tonOpenCellInternal(grid, cell) {\r\n\t\t\tthrow new Error();\r\n\t\t}\r\n\t\tonChangeSelectCellInternal(grid, cell, selected) {\r\n\t\t\tthrow new Error();\r\n\t\t}\r\n\t\tonSetInputAttrsInternal(grid, cell, input) {\r\n\t\t\tthrow new Error();\r\n\t\t}\r\n\t\tonGridScrollInternal(grid) {\r\n\t\t\tthrow new Error();\r\n\t\t}\r\n\t\tbindGridEvent(grid, col, util) {\r\n\t\t\tconst open = (cell) => {\r\n\t\t\t\tif (this.readOnly || this.disabled) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.onOpenCellInternal(grid, cell);\r\n\t\t\t};\r\n\r\n\t\t\tconst input = (cell, value) => {\r\n\t\t\t\tif (this.readOnly || this.disabled) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tthis.onInputCellInternal(grid, cell, value);\r\n\t\t\t};\r\n\t\t\treturn [\r\n\t\t\t\tgrid.listen(INPUT_CELL, (e) => {\r\n\t\t\t\t\tif (!util.isTarget(e.col, e.row)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tinput({\r\n\t\t\t\t\t\tcol: e.col,\r\n\t\t\t\t\t\trow: e.row\r\n\t\t\t\t\t}, e.value);\r\n\t\t\t\t}),\r\n\t\t\t\tgrid.listen(DBLCLICK_CELL, (cell) => {\r\n\t\t\t\t\tif (!util.isTarget(cell.col, cell.row)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\topen({\r\n\t\t\t\t\t\tcol: cell.col,\r\n\t\t\t\t\t\trow: cell.row\r\n\t\t\t\t\t});\r\n\t\t\t\t}),\r\n\t\t\t\tgrid.listen(DBLTAP_CELL, (e) => {\r\n\t\t\t\t\tif (!util.isTarget(e.col, e.row)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\topen({\r\n\t\t\t\t\t\tcol: e.col,\r\n\t\t\t\t\t\trow: e.row\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\te.event.preventDefault();\r\n\t\t\t\t\te.event.stopPropagation();\r\n\t\t\t\t}),\r\n\t\t\t\tgrid.listen(KEYDOWN, (keyCode, e) => {\r\n\t\t\t\t\tif (keyCode !== KEY_F2 && keyCode !== KEY_ENTER) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst sel = grid.selection.select;\r\n\t\t\t\t\tif (!util.isTarget(sel.col, sel.row)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\topen({\r\n\t\t\t\t\t\tcol: sel.col,\r\n\t\t\t\t\t\trow: sel.row\r\n\t\t\t\t\t});\r\n\t\t\t\t}),\r\n\t\t\t\tgrid.listen(SELECTED_CELL, (e) => {\r\n\t\t\t\t\tthis.onChangeSelectCellInternal(grid, {col: e.col, row: e.row}, e.selected);\r\n\t\t\t\t}),\r\n\t\t\t\tgrid.listen(SCROLL, () => {\r\n\t\t\t\t\tthis.onGridScrollInternal(grid);\r\n\t\t\t\t}),\r\n\t\t\t\tgrid.listen(EDITABLEINPUT_CELL, (cell) => {\r\n\t\t\t\t\tif (!util.isTarget(cell.col, cell.row)) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.readOnly || this.disabled) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}),\r\n\t\t\t\tgrid.listen(MODIFY_STATUS_EDITABLEINPUT_CELL, (cell) => {\r\n\t\t\t\t\tif (!util.isTarget(cell.col, cell.row)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (this.readOnly || this.disabled) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthis.onSetInputAttrsInternal(grid, {\r\n\t\t\t\t\t\tcol: cell.col,\r\n\t\t\t\t\t\trow: cell.row\r\n\t\t\t\t\t}, cell.input);\r\n\t\t\t\t}),\r\n\t\t\t\t\r\n\t\t\t];\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.exports = BaseInputEditor;\r\n}","'use strict';\r\n{\r\n\tconst {obj: {setReadonly}} = require('../../internal/utils');\r\n\tconst Action = require('./Action');\r\n\tconst {BUTTON_COLUMN_STATE_ID} = require('../../internal/symbolManager');\r\n\tclass ButtonAction extends Action {\r\n\t\tgetState(grid) {\r\n\t\t\tif (!grid[BUTTON_COLUMN_STATE_ID]) {\r\n\t\t\t\tsetReadonly(grid, BUTTON_COLUMN_STATE_ID, {});\r\n\t\t\t}\r\n\t\t\treturn grid[BUTTON_COLUMN_STATE_ID];\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.exports = ButtonAction;\r\n}","'use strict';\r\n{\r\n\tconst {obj: {setReadonly}, isPromise} = require('../../internal/utils');\r\n\tconst {bindCellClickAction, bindCellKeyAction} = require('./actionBind');\r\n\tconst animate = require('../../internal/animate');\r\n\r\n\tconst Editor = require('./Editor');\r\n\tconst {CHECK_COLUMN_STATE_ID} = require('../../internal/symbolManager');\r\n\r\n\tconst KEY_ENTER = 13;\r\n\tconst KEY_SPACE = 32;\r\n\r\n\tfunction toggleValue(val) {\r\n\t\tif (typeof val === 'number') {\r\n\t\t\tif (val === 0) {\r\n\t\t\t\treturn 1;\r\n\t\t\t} else {\r\n\t\t\t\treturn 0;\r\n\t\t\t}\r\n\t\t} else if (typeof val === 'string') {\r\n\t\t\tif (val === 'false') {\r\n\t\t\t\treturn 'true';\r\n\t\t\t} else if (val === 'off') {\r\n\t\t\t\treturn 'on';\r\n\t\t\t} else if (val.match(/^0+$/)) {\r\n\t\t\t\treturn val.replace(/^(0*)0$/, '$11');\r\n\t\t\t} else if (val === 'true') {\r\n\t\t\t\treturn 'false';\r\n\t\t\t} else if (val === 'on') {\r\n\t\t\t\treturn 'off';\r\n\t\t\t} else if (val.match(/^0*1$/)) {\r\n\t\t\t\treturn val.replace(/^(0*)1$/, '$10');\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn !val;\r\n\t}\r\n\r\n\tclass CheckEditor extends Editor {\r\n\t\tclone() {\r\n\t\t\treturn new CheckEditor(this);\r\n\t\t}\r\n\t\tbindGridEvent(grid, col, util) {\r\n\t\t\tif (!grid[CHECK_COLUMN_STATE_ID]) {\r\n\t\t\t\tsetReadonly(grid, CHECK_COLUMN_STATE_ID, {});\r\n\t\t\t}\r\n\t\t\tconst state = grid[CHECK_COLUMN_STATE_ID];\r\n\t\t\t\r\n\t\t\tconst action = (cell) => {\r\n\t\t\t\tconst key = cell.col + ':' + cell.row;\r\n\t\t\t\tconst blockKey = key + '::block';\r\n\t\t\t\tif (this.readOnly || this.disabled || state[blockKey]) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst ret = grid.doChangeValue(cell.col, cell.row, toggleValue);\r\n\t\t\t\tif (ret) {\r\n\t\t\t\t\t\r\n\t\t\t\t\tconst onChange = () => {\r\n\t\t\t\t\t\t// checkbox animation\r\n\t\t\t\t\t\tanimate(200, (point) => {\r\n\t\t\t\t\t\t\tif (point === 1) {\r\n\t\t\t\t\t\t\t\tdelete state[key];\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tstate[key] = {\r\n\t\t\t\t\t\t\t\t\telapsed: point,\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tgrid.invalidateCell(cell.col, cell.row);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t};\r\n\t\t\t\t\tif (isPromise(ret)) {\r\n\t\t\t\t\t\tstate[blockKey] = true;\r\n\t\t\t\t\t\tret.then(() => {\r\n\t\t\t\t\t\t\tdelete state[blockKey];\r\n\t\t\t\t\t\t\tonChange();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tonChange();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\treturn [\r\n\t\t\t\t...bindCellClickAction(grid, col, util, {\r\n\t\t\t\t\taction,\r\n\t\t\t\t\tmouseOver: (e) => {\r\n\t\t\t\t\t\tif (this.disabled) {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tstate.mouseActiveCell = {\r\n\t\t\t\t\t\t\tcol: e.col,\r\n\t\t\t\t\t\t\trow: e.row\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tgrid.invalidateCell(e.col, e.row);\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmouseOut: (e) => {\r\n\t\t\t\t\t\tdelete state.mouseActiveCell;\r\n\t\t\t\t\t\tgrid.invalidateCell(e.col, e.row);\r\n\t\t\t\t\t},\r\n\t\t\t\t}),\r\n\t\t\t\t...bindCellKeyAction(grid, col, util, {\r\n\t\t\t\t\taction: (e) => {\r\n\t\t\t\t\t\tconst selrange = grid.selection.range;\r\n\t\t\t\t\t\tconst col = grid.selection.select.col;\r\n\t\t\t\t\t\tfor (let row = selrange.start.row; row <= selrange.end.row; row++) {\r\n\t\t\t\t\t\t\tif (!util.isTarget(col, row)) {\r\n\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\taction({\r\n\t\t\t\t\t\t\t\tcol,\r\n\t\t\t\t\t\t\t\trow,\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tacceptKeys: [KEY_ENTER, KEY_SPACE],\r\n\t\t\t\t})\r\n\t\t\t];\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.exports = CheckEditor;\r\n}","'use strict';\r\n{\r\n\t\r\n\tconst BaseAction = require('./BaseAction');\r\n\tclass Editor extends BaseAction {\r\n\t\tconstructor(option = {}) {\r\n\t\t\tsuper(option);\r\n\t\t\tthis._readOnly = option.readOnly;\r\n\t\t}\r\n\t\tget readOnly() {\r\n\t\t\treturn this._readOnly;\r\n\t\t}\r\n\t\tset readOnly(readOnly) {\r\n\t\t\tthis._readOnly = !!readOnly;\r\n\t\t\tthis.onChangeReadOnlyInternal();\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new Editor(this);\r\n\t\t}\r\n\t\tonChangeReadOnlyInternal() {}\r\n\t}\r\n\tmodule.exports = Editor;\r\n}","'use strict';\r\n\r\nconst {obj: {setReadonly}} = require('../../internal/utils');\r\nconst BaseInputEditor = require('./BaseInputEditor');\r\nconst InlineInputElement = require('./internal/InlineInputElement');\r\nconst {INLINE_INPUT_EDITOR_STATE_ID: _} = require('../../internal/symbolManager');\r\n\r\n\t\r\nlet globalElement = null;\r\nlet bindGridCount = 0;\r\nfunction attachInput(grid, cell, editor, value) {\r\n\tif (!grid[_]) {\r\n\t\tsetReadonly(grid, _, {});\r\n\t}\r\n\tif (!globalElement) {\r\n\t\tglobalElement = new InlineInputElement();\r\n\t}\r\n\tconst state = grid[_];\r\n\tif (!state.element) {\r\n\t\tstate.element = globalElement;\r\n\t\tbindGridCount++;\r\n\t\tgrid.addDisposable({\r\n\t\t\tdispose() {\r\n\t\t\t\tbindGridCount--;\r\n\t\t\t\tif (!bindGridCount) {\r\n\t\t\t\t\tglobalElement.dispose();\r\n\t\t\t\t\tglobalElement = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tglobalElement.attach(grid, editor, cell.col, cell.row, value);\r\n}\r\nfunction detachInput(gridFocus) {\r\n\tif (globalElement) {\r\n\t\tglobalElement.detach(gridFocus);\r\n\t}\r\n}\r\nfunction doChangeValue(grid) {\r\n\tif (globalElement) {\r\n\t\tglobalElement.doChangeValue();\r\n\t}\r\n}\r\n\r\n\r\nclass InlineInputEditor extends BaseInputEditor {\r\n\tconstructor(option = {}) {\r\n\t\tsuper(option);\r\n\t\tthis._classList = option.classList;\r\n\t\tthis._type = option.type;\r\n\t}\r\n\tget classList() {\r\n\t\treturn this._classList && (Array.isArray(this._classList) ? this._classList : [this._classList]);\r\n\t}\r\n\tset classList(classList) {\r\n\t\tthis._classList = classList;\r\n\t}\r\n\tget type() {\r\n\t\treturn this._type;\r\n\t}\r\n\tset type(type) {\r\n\t\tthis._type = type;\r\n\t}\r\n\tclone() {\r\n\t\treturn new InlineInputEditor(this);\r\n\t}\r\n\tonInputCellInternal(grid, cell, inputValue) {\r\n\t\tattachInput(grid, cell, this, inputValue);\r\n\t}\r\n\tonOpenCellInternal(grid, cell) {\r\n\t\tgrid.doGetCellValue(cell.col, cell.row, (value) => {\r\n\t\t\tattachInput(grid, cell, this, value);\r\n\t\t});\r\n\t}\r\n\tonChangeSelectCellInternal(grid, cell, selected) {\r\n\t\tdoChangeValue(grid);\r\n\t\tdetachInput();\r\n\t}\r\n\tonGridScrollInternal(grid) {\r\n\t\tdoChangeValue(grid);\r\n\t\tdetachInput(true);\r\n\t}\r\n\tonChangeDisabledInternal() {\r\n\t\t// cancel input\r\n\t\tdetachInput(true);\r\n\t}\r\n\tonChangeReadOnlyInternal() {\r\n\t\t// cancel input\r\n\t\tdetachInput(true);\r\n\t}\r\n\tonSetInputAttrsInternal(grid, cell, input) {\r\n\t\tInlineInputElement.setInputAttrs(this, grid, input);\r\n\t}\r\n}\r\n\r\nmodule.exports = InlineInputEditor;","'use strict';\r\nconst {obj: {setReadonly}} = require('../../internal/utils');\r\nconst {normalize} = require('../../internal/menu-items');\r\n\t\r\nconst Editor = require('./Editor');\r\nconst {EVENT_TYPE: {\r\n\tSELECTED_CELL,\r\n\tCLICK_CELL,\r\n\tKEYDOWN,\r\n\tSCROLL,\r\n\tMOUSEOVER_CELL,\r\n\tMOUSEOUT_CELL,\r\n\tMOUSEMOVE_CELL,\r\n}} = require('../../core/DrawGrid');\r\nconst InlineMenuElement = require('./internal/InlineMenuElement');\r\nconst {INLINE_MENU_EDITOR_STATE_ID: _} = require('../../internal/symbolManager');\r\n\t\r\nlet globalElement = null;\r\nlet bindGridCount = 0;\r\nfunction attachMenu(grid, cell, editor, value) {\r\n\tif (!grid[_]) {\r\n\t\tsetReadonly(grid, _, {});\r\n\t}\r\n\tif (!globalElement) {\r\n\t\tglobalElement = new InlineMenuElement();\r\n\t}\r\n\tconst state = grid[_];\r\n\tif (!state.element) {\r\n\t\tstate.element = globalElement;\r\n\t\tbindGridCount++;\r\n\t\tgrid.addDisposable({\r\n\t\t\tdispose() {\r\n\t\t\t\tbindGridCount--;\r\n\t\t\t\tif (!bindGridCount) {\r\n\t\t\t\t\tglobalElement.dispose();\r\n\t\t\t\t\tglobalElement = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tglobalElement.attach(grid, editor, cell.col, cell.row, value);\r\n}\r\nfunction detachMenu(gridFocus) {\r\n\tif (globalElement) {\r\n\t\tglobalElement.detach(gridFocus);\r\n\t}\r\n}\r\n\r\nconst KEY_ENTER = 13;\r\nconst KEY_F2 = 113;\r\n\r\nclass InlineMenuEditor extends Editor {\r\n\tconstructor(option = {}) {\r\n\t\tsuper(option);\r\n\t\tthis._classList = option.classList;\r\n\t\tthis._options = normalize(option.options);\r\n\t}\r\n\tdispose() {\r\n\t}\r\n\tget classList() {\r\n\t\treturn this._classList && (Array.isArray(this._classList) ? this._classList : [this._classList]);\r\n\t}\r\n\tset classList(classList) {\r\n\t\tthis._classList = classList;\r\n\t}\r\n\tget options() {\r\n\t\treturn this._options;\r\n\t}\r\n\tset options(options) {\r\n\t\tthis._options = normalize(options);\r\n\t}\r\n\tclone() {\r\n\t\treturn new InlineMenuEditor(this);\r\n\t}\r\n\tonChangeDisabledInternal() {\r\n\t\t// cancel input\r\n\t\tdetachMenu(true);\r\n\t}\r\n\tonChangeReadOnlyInternal() {\r\n\t\t// cancel input\r\n\t\tdetachMenu(true);\r\n\t}\r\n\tbindGridEvent(grid, col, util) {\r\n\t\tconst open = (cell) => {\r\n\t\t\tif (this.readOnly || this.disabled) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tgrid.doGetCellValue(cell.col, cell.row, (value) => {\r\n\t\t\t\tattachMenu(grid, cell, this, value);\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\treturn [\r\n\t\t\tgrid.listen(CLICK_CELL, (cell) => {\r\n\t\t\t\tif (!util.isTarget(cell.col, cell.row)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\topen({\r\n\t\t\t\t\tcol: cell.col,\r\n\t\t\t\t\trow: cell.row\r\n\t\t\t\t});\r\n\t\t\t}),\r\n\t\t\tgrid.listen(KEYDOWN, (keyCode, e) => {\r\n\t\t\t\tif (keyCode !== KEY_F2 && keyCode !== KEY_ENTER) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst sel = grid.selection.select;\r\n\t\t\t\tif (!util.isTarget(sel.col, sel.row)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\topen({\r\n\t\t\t\t\tcol: sel.col,\r\n\t\t\t\t\trow: sel.row\r\n\t\t\t\t});\r\n\t\t\t}),\r\n\t\t\tgrid.listen(SELECTED_CELL, (e) => {\r\n\t\t\t\tdetachMenu();\r\n\t\t\t}),\r\n\t\t\tgrid.listen(SCROLL, () => {\r\n\t\t\t\tdetachMenu(true);\r\n\t\t\t}),\r\n\r\n\t\t\t// mouse move\r\n\t\t\tgrid.listen(MOUSEOVER_CELL, (e) => {\r\n\t\t\t\tif (this.readOnly || this.disabled) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!util.isTarget(e.col, e.row)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tgrid.getElement().style.cursor = 'pointer';\r\n\t\t\t}),\r\n\t\t\tgrid.listen(MOUSEMOVE_CELL, (e) => {\r\n\t\t\t\tif (this.readOnly || this.disabled) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!util.isTarget(e.col, e.row)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!grid.getElement().style.cursor) {\r\n\t\t\t\t\tgrid.getElement().style.cursor = 'pointer';\r\n\t\t\t\t}\r\n\t\t\t}),\r\n\t\t\tgrid.listen(MOUSEOUT_CELL, (e) => {\r\n\t\t\t\tif (!util.isTarget(e.col, e.row)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tgrid.getElement().style.cursor = '';\r\n\t\t\t}),\r\n\t\t];\r\n\t}\r\n}\r\n\r\nmodule.exports = InlineMenuEditor;","'use strict';\r\nconst {obj: {setReadonly}} = require('../../internal/utils');\r\n\t\r\nconst SmallDialogInputElement = require('./internal/SmallDialogInputElement');\r\nconst {SMALL_DIALOG_INPUT_EDITOR_STATE_ID: _} = require('../../internal/symbolManager');\r\n\r\nlet globalElement = null;\r\nlet bindGridCount = 0;\r\nfunction attachInput(grid, cell, editor, value) {\r\n\tif (!grid[_]) {\r\n\t\tsetReadonly(grid, _, {});\r\n\t}\r\n\tif (!globalElement) {\r\n\t\tglobalElement = new SmallDialogInputElement();\r\n\t}\r\n\tconst state = grid[_];\r\n\tif (!state.element) {\r\n\t\tstate.element = globalElement;\r\n\t\tbindGridCount++;\r\n\t\tgrid.addDisposable({\r\n\t\t\tdispose() {\r\n\t\t\t\tbindGridCount--;\r\n\t\t\t\tif (!bindGridCount) {\r\n\t\t\t\t\tglobalElement.dispose();\r\n\t\t\t\t\tglobalElement = null;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tglobalElement.attach(grid, editor, cell.col, cell.row, value);\r\n}\r\nfunction detachInput(gridFocus) {\r\n\tif (globalElement) {\r\n\t\tglobalElement.detach(gridFocus);\r\n\t}\r\n}\r\nconst BaseInputEditor = require('./BaseInputEditor');\r\nclass SmallDialogInputEditor extends BaseInputEditor {\r\n\tconstructor(option = {}) {\r\n\t\tsuper(option);\r\n\t\tthis._helperText = option.helperText;\r\n\t\tthis._inputValidator = option.inputValidator;\r\n\t\tthis._validator = option.validator;\r\n\t\tthis._classList = option.classList;\r\n\t\tthis._type = option.type;\r\n\t}\r\n\tdispose() {\r\n\t\tthis._inputDialogManager.dispose();\r\n\t\tthis._inputDialogManager = null;\r\n\t}\r\n\tget classList() {\r\n\t\treturn this._classList && (Array.isArray(this._classList) ? this._classList : [this._classList]);\r\n\t}\r\n\tset classList(classList) {\r\n\t\tthis._classList = classList;\r\n\t}\r\n\tget type() {\r\n\t\treturn this._type;\r\n\t}\r\n\tset type(type) {\r\n\t\tthis._type = type;\r\n\t}\r\n\tget helperText() {\r\n\t\treturn this._helperText;\r\n\t}\r\n\tget inputValidator() {\r\n\t\treturn this._inputValidator;\r\n\t}\r\n\tget validator() {\r\n\t\treturn this._validator;\r\n\t}\r\n\tclone() {\r\n\t\treturn new SmallDialogInputEditor(this);\r\n\t}\r\n\tonInputCellInternal(grid, cell, inputValue) {\r\n\t\tattachInput(grid, cell, this, inputValue);\r\n\t}\r\n\tonOpenCellInternal(grid, cell) {\r\n\t\tgrid.doGetCellValue(cell.col, cell.row, (value) => {\r\n\t\t\tattachInput(grid, cell, this, value);\r\n\t\t});\r\n\t}\r\n\tonChangeSelectCellInternal(grid, cell, selected) {\r\n\t\t// cancel input\r\n\t\tdetachInput();\r\n\t}\r\n\tonGridScrollInternal(grid) {\r\n\t\t// cancel input\r\n\t\tdetachInput(true);\r\n\t}\r\n\tonChangeDisabledInternal() {\r\n\t\t// cancel input\r\n\t\tdetachInput(true);\r\n\t}\r\n\tonChangeReadOnlyInternal() {\r\n\t\t// cancel input\r\n\t\tdetachInput(true);\r\n\t}\r\n\tonSetInputAttrsInternal(grid, cell, input) {\r\n\t\tSmallDialogInputElement.setInputAttrs(this, grid, input);\r\n\t}\r\n}\r\n\r\nmodule.exports = SmallDialogInputEditor;","'use strict';\r\n{\r\n\t\r\n\tconst {isPromise, event: {cancel}} = require('../../internal/utils');\r\n\tconst {EVENT_TYPE: {\r\n\t\tCLICK_CELL,\r\n\t\tMOUSEOVER_CELL,\r\n\t\tMOUSEOUT_CELL,\r\n\t\tKEYDOWN,\r\n\t}} = require('../../core/DrawGrid');\r\n\tconst KEY_ENTER = 13;\r\n\tfunction bindCellClickAction(grid, col, util, {\r\n\t\taction,\r\n\t\tmouseOver,\r\n\t\tmouseOut\r\n\t}) {\r\n\t\treturn [\r\n\t\t\t// click\r\n\t\t\tgrid.listen(CLICK_CELL, (e) => {\r\n\t\t\t\tif (!util.isTarget(e.col, e.row)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (isPromise(grid.getRowRecord(e.row))) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\taction({\r\n\t\t\t\t\tcol: e.col,\r\n\t\t\t\t\trow: e.row\r\n\t\t\t\t});\r\n\t\t\t}),\r\n\t\t\t// mouse move\r\n\t\t\tgrid.listen(MOUSEOVER_CELL, (e) => {\r\n\t\t\t\tif (!util.isTarget(e.col, e.row)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (isPromise(grid.getRowRecord(e.row))) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (mouseOver) {\r\n\t\t\t\t\tif (!mouseOver({\r\n\t\t\t\t\t\tcol: e.col,\r\n\t\t\t\t\t\trow: e.row\r\n\t\t\t\t\t})) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tgrid.getElement().style.cursor = 'pointer';\r\n\t\t\t}),\r\n\t\t\tgrid.listen(MOUSEOUT_CELL, (e) => {\r\n\t\t\t\tif (!util.isTarget(e.col, e.row)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (mouseOut) {\r\n\t\t\t\t\tmouseOut({\r\n\t\t\t\t\t\tcol: e.col,\r\n\t\t\t\t\t\trow: e.row\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\tgrid.getElement().style.cursor = '';\r\n\t\t\t}),\r\n\t\t];\r\n\t}\r\n\tfunction bindCellKeyAction(grid, col, util, {action, acceptKeys = []}) {\r\n\t\tacceptKeys = [...acceptKeys, KEY_ENTER];\r\n\t\treturn [\r\n\t\t\t// enter key down\r\n\t\t\tgrid.listen(KEYDOWN, (keyCode, e) => {\r\n\t\t\t\tif (acceptKeys.indexOf(keyCode) === -1) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst sel = grid.selection.select;\r\n\t\t\t\tif (!util.isTarget(sel.col, sel.row)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (isPromise(grid.getRowRecord(sel.row))) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\taction({\r\n\t\t\t\t\tcol: sel.col,\r\n\t\t\t\t\trow: sel.row\r\n\t\t\t\t});\r\n\t\t\t\tcancel(e);\r\n\t\t\t}),\r\n\r\n\t\t];\r\n\t}\r\n\r\n\tmodule.exports = {\r\n\t\tbindCellClickAction,\r\n\t\tbindCellKeyAction,\r\n\t};\r\n}","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?minimize!./InlineInputElement.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?minimize!./InlineInputElement.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?minimize!./InlineInputElement.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","'use strict';\r\nconst {\r\n\tevent: {\r\n\t\tgetKeyCode,\r\n\t\tcancel: cancelEvent,\r\n\t},\r\n} = require('../../../internal/utils');\r\n\t\r\nconst EventHandler = require('../../../internal/EventHandler');\r\nconst {\r\n\tcreateElement,\r\n} = require('../../../internal/dom');\r\nconst KEY_ENTER = 13;\r\n\r\nconst CLASSNAME = 'cheetah-grid__inline-input';\r\n\r\nfunction createInputElement() {\r\n\trequire('./InlineInputElement.css');\r\n\treturn createElement('input', {classList: CLASSNAME});\r\n}\r\n\r\nfunction setInputAttrs(editor, grid, input) {\r\n\tconst {classList, type} = editor;\r\n\tif (classList) {\r\n\t\tinput.classList.add(...classList);\r\n\t}\r\n\tinput.type = type || '';\r\n}\r\n\r\nclass InlineInputElement {\r\n\tstatic setInputAttrs(...args) {\r\n\t\tsetInputAttrs(...args);\r\n\t}\r\n\tconstructor() {\r\n\t\tthis._handler = new EventHandler();\r\n\t\tthis._input = createInputElement();\r\n\t\tthis._bindInputEvents();\r\n\t}\r\n\tdispose() {\r\n\t\tthis.detach();\r\n\t\tthis._handler.dispose();\r\n\t\tthis._input = null;\r\n\t\tthis._beforePropEditor = null;\r\n\t}\r\n\tattach(grid, editor, col, row, value) {\r\n\t\tconst input = this._input;\r\n\t\tconst handler = this._handler;\r\n\r\n\t\tif (this._beforePropEditor) {\r\n\t\t\tconst {classList} = this._beforePropEditor;\r\n\t\t\tif (classList) {\r\n\t\t\t\tinput.classList.remove(...classList);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tinput.style.font = grid.font || '16px sans-serif';\r\n\r\n\t\tconst {element, rect} = grid.getAttachCellArea(col, row);\r\n\t\tinput.style.top = rect.top.toFixed() + 'px';\r\n\t\tinput.style.left = rect.left.toFixed() + 'px';\r\n\t\tinput.style.width = rect.width.toFixed() + 'px';\r\n\t\tinput.style.height = rect.height.toFixed() + 'px';\r\n\t\telement.appendChild(input);\r\n\r\n\t\tsetInputAttrs(editor, grid, input);\r\n\t\tinput.value = value;\r\n\r\n\t\tthis._activeData = {grid, col, row, editor};\r\n\t\tthis._beforePropEditor = editor;\r\n\r\n\t\tconst focus = () => {\r\n\t\t\tinput.focus();\r\n\r\n\t\t\tconst end = input.value.length;\r\n\t\t\ttry {\r\n\t\t\t\tif (typeof (input.selectionStart) !== 'undefined') {\r\n\t\t\t\t\tinput.selectionStart = end;\r\n\t\t\t\t\tinput.selectionEnd = end;\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t} catch (e) {\r\n\t\t\t//ignore\r\n\t\t\t}\r\n\t\t\tif (document.selection) {\r\n\t\t\t\tconst range = input.createTextRange();\r\n\t\t\t\trange.collapse();\r\n\t\t\t\trange.moveEnd('character', end);\r\n\t\t\t\trange.moveStart('character', end);\r\n\t\t\t\trange.select();\r\n\t\t\t}\r\n\t\t};\r\n\t\thandler.tryWithOffEvents(input, 'blur', () => {\r\n\t\t\tfocus();\r\n\t\t});\r\n\t}\r\n\tdetach(gridFocus) {\r\n\t\tif (this._isActive()) {\r\n\t\t\tconst {grid, col, row} = this._activeData;\r\n\t\t\tconst input = this._input;\r\n\t\t\tthis._handler.tryWithOffEvents(input, 'blur', () => {\r\n\t\t\t\tinput.parentElement.removeChild(input);\r\n\t\t\t});\r\n\t\t\tgrid.invalidateCell(col, row);\r\n\t\t\tif (gridFocus) {\r\n\t\t\t\tgrid.focus();\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._activeData = null;\r\n\t}\r\n\tdoChangeValue() {\r\n\t\tif (!this._isActive()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst input = this._input;\r\n\t\tconst {value} = input;\r\n\t\tconst {grid, col, row} = this._activeData;\r\n\t\tgrid.doChangeValue(col, row, () => value);\r\n\t}\r\n\t_isActive() {\r\n\t\tconst input = this._input;\r\n\t\tif (!input || !input.parentElement) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (!this._activeData) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\t_bindInputEvents() {\r\n\t\tconst handler = this._handler;\r\n\t\tconst input = this._input;\r\n\t\tconst stopPropagationOnly = (e) => e.stopPropagation();// grid\r\n\t\thandler.on(input, 'click', stopPropagationOnly);\r\n\t\thandler.on(input, 'mousedown', stopPropagationOnly);\r\n\t\thandler.on(input, 'touchstart', stopPropagationOnly);\r\n\t\thandler.on(input, 'dblclick', stopPropagationOnly);\r\n\t\t\r\n\t\thandler.on(input, 'compositionstart', (e) => {\r\n\t\t\tinput.classList.add('composition');\r\n\t\t});\r\n\t\thandler.on(input, 'compositionend', (e) => {\r\n\t\t\tinput.classList.remove('composition');\r\n\t\t});\r\n\t\thandler.on(input, 'keydown', (e) => {\r\n\t\t\tif (input.classList.contains('composition')) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (getKeyCode(e) === KEY_ENTER) {\r\n\t\t\t\tif (!this._isActive()) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst {grid} = this._activeData;\r\n\r\n\t\t\t\tthis.doChangeValue();\r\n\t\t\t\tif (grid) {\r\n\t\t\t\t\tgrid.focus();\r\n\t\t\t\t}\r\n\t\t\t\tthis.detach();\r\n\t\t\t\tcancelEvent(e);\r\n\t\t\t}\r\n\t\t});\r\n\t\thandler.on(input, 'blur', (e) => {\r\n\t\t\tthis.doChangeValue();\r\n\t\t\tthis.detach();\r\n\t\t});\r\n\t}\r\n}\r\n\r\nmodule.exports = InlineInputElement;","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?minimize!./InlineMenuElement.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?minimize!./InlineMenuElement.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?minimize!./InlineMenuElement.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","'use strict';\r\nconst {\r\n\tisDef,\r\n\tevent: {\r\n\t\tgetKeyCode,\r\n\t\tcancel: cancelEvent,\r\n\t}\r\n} = require('../../../internal/utils');\r\n\r\nconst EventHandler = require('../../../internal/EventHandler');\r\nconst {\r\n\tcreateElement,\r\n\tappendHtml,\r\n\tempty,\r\n\tdisableFocus,\r\n\tisFocusable,\r\n\tfindPrevSiblingFocusable,\r\n\tfindNextSiblingFocusable,\r\n} = require('../../../internal/dom');\r\n\t\r\nconst KEY_TAB = 9;\r\nconst KEY_ENTER = 13;\r\nconst KEY_UP = 38;\r\nconst KEY_DOWN = 40;\r\nconst KEY_ESC = 27;\r\n\r\nconst CLASSNAME = 'cheetah-grid__inline-menu';\r\nconst ITEM_CLASSNAME = CLASSNAME + '__menu-item';\r\nconst HIDDEN_CLASSNAME = CLASSNAME + '--hidden';\r\nconst SHOWN_CLASSNAME = CLASSNAME + '--shown';\r\nconst EMPTY_ITEM_CLASSNAME = ITEM_CLASSNAME + '--empty';\r\n\r\nfunction findItemParents(target) {\r\n\tlet el = target;\r\n\twhile (!el.classList.contains(ITEM_CLASSNAME)) {\r\n\t\tel = el.parentElement;\r\n\t\tif (!el || el.classList.contains(CLASSNAME)) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t}\r\n\treturn el;\r\n}\r\n\r\nfunction createMenuElement() {\r\n\trequire('./InlineMenuElement.css');\r\n\treturn createElement('ul', {classList: CLASSNAME});\r\n}\r\nfunction attachElement(element, rect, menu) {\r\n\tmenu.style.top = rect.top.toFixed() + 'px';\r\n\tmenu.style.left = rect.left.toFixed() + 'px';\r\n\tmenu.style.width = rect.width.toFixed() + 'px';\r\n\tmenu.style['line-height'] = rect.height.toFixed() + 'px';\r\n\telement.appendChild(menu);\r\n}\r\n\r\nfunction optionToLi({classList, caption, value, html}, index) {\r\n\tconst item = createElement('li', {classList: ITEM_CLASSNAME});\r\n\titem.tabIndex = 0;\r\n\titem.dataset.valueindex = index;\r\n\tif (classList) {\r\n\t\titem.classList.add(...(Array.isArray(classList) ? classList : [classList]));\r\n\t}\r\n\r\n\tif (caption) {\r\n\t\tconst span = createElement('span', {text: caption});\r\n\t\titem.appendChild(span);\r\n\t} else if (html) {\r\n\t\tappendHtml(item, html);\r\n\t}\r\n\r\n\tif (value === '' || !isDef(value)) {\r\n\t\titem.classList.add(EMPTY_ITEM_CLASSNAME);\r\n\t}\r\n\r\n\treturn item;\r\n}\r\n\r\nfunction openMenu(grid, editor, col, row, value, menu) {\r\n\tconst {options, classList} = editor;\r\n\tmenu.classList.remove(SHOWN_CLASSNAME);\r\n\tmenu.classList.add(HIDDEN_CLASSNAME);\r\n\tempty(menu);\r\n\tmenu.style.font = grid.font || '16px sans-serif';\r\n\tlet emptyItemEl = null;\r\n\tlet valueItemEl = null;\r\n\t\t\r\n\toptions.forEach((option, i) => {\r\n\t\tconst item = optionToLi(option, i);\r\n\t\tmenu.appendChild(item);\r\n\t\tif (option.value === value) {\r\n\t\t\tvalueItemEl = item;\r\n\t\t\titem.dataset.select = true;\r\n\t\t}\r\n\t\tif (item.classList.contains(EMPTY_ITEM_CLASSNAME)) {\r\n\t\t\temptyItemEl = item;\r\n\t\t}\r\n\t});\r\n\tconst focusEl = valueItemEl || emptyItemEl || menu.children[0];\r\n\tif (classList) {\r\n\t\tmenu.classList.add(...classList);\r\n\t}\r\n\tconst children = Array.prototype.slice.call(menu.children, 0);\r\n\tconst focusIndex = children.indexOf(focusEl);\r\n\tconst {element, rect} = grid.getAttachCellArea(col, row);\r\n\r\n\t// Cover the right line\r\n\trect.width++;\r\n\r\n\t// append for calculation\r\n\tattachElement(element, rect, menu);\r\n\r\n\t// Make the selection item at the middle\r\n\tlet offset = 0;\r\n\tlet allHeight = 0;\r\n\tfor (let i = 0; i < children.length; i++) {\r\n\t\tconst offsetHeight = children[i].offsetHeight;\r\n\t\tif (i < focusIndex) {\r\n\t\t\toffset += offsetHeight;\r\n\t\t}\r\n\t\tallHeight += offsetHeight;\r\n\t}\r\n\trect.offsetTop(-offset);\r\n\tmenu.style['transform-origin'] = `center ${offset + Math.ceil(children[focusIndex].offsetHeight / 2)}px 0px`;\r\n\tattachElement(element, rect, menu);\r\n\r\n\t// Control not to overflow the screen range\r\n\tconst menuClientRect = menu.getBoundingClientRect();\r\n\tconst scaleDiff = ((allHeight - menuClientRect.height) / 2);\r\n\tconst orgMenuTop = menuClientRect.top - scaleDiff;\r\n\tlet menuTop = orgMenuTop;\r\n\tconst menuBottom = menuTop + allHeight;\r\n\tconst winBottom = window.innerHeight;\r\n\tconst winMargin = 20;\r\n\tif (menuBottom > (winBottom - winMargin)) {\r\n\t\tconst diff = menuBottom - winBottom + winMargin;\r\n\t\tmenuTop -= diff;\r\n\t}\r\n\tif (menuTop < 0/*winTop*/ + winMargin) {\r\n\t\tmenuTop = winMargin;\r\n\t}\r\n\tif (menuTop !== orgMenuTop) {\r\n\t\trect.offsetTop(-(orgMenuTop - menuTop));\r\n\t\t// re update\r\n\t\tattachElement(element, rect, menu);\r\n\t}\r\n\t\t\r\n\tif (focusEl) {\r\n\t\tfocusEl.focus();\r\n\t}\r\n\tmenu.classList.remove(HIDDEN_CLASSNAME);\r\n\tmenu.classList.add(SHOWN_CLASSNAME);\r\n}\r\n\r\nfunction closeMenu(grid, col, row, menu) {\r\n\tmenu.classList.remove(SHOWN_CLASSNAME);\r\n\tmenu.classList.add(HIDDEN_CLASSNAME);\r\n\tdisableFocus(menu);\r\n}\r\n\r\nclass InlineMenuElement {\r\n\tconstructor() {\r\n\t\tthis._handler = new EventHandler();\r\n\t\tthis._menu = createMenuElement();\r\n\t\tthis._bindMenuEvents();\r\n\t}\r\n\tdispose() {\r\n\t\tconst menu = this._menu;\r\n\t\tthis.detach();\r\n\t\tthis._handler.dispose();\r\n\t\tthis._menu = null;\r\n\t\tthis._beforePropEditor = null;\r\n\t\tif (menu.parentElement) {\r\n\t\t\tmenu.parentElement.removeChild(menu);\r\n\t\t}\r\n\t}\r\n\tattach(grid, editor, col, row, value) {\r\n\t\tconst menu = this._menu;\r\n\r\n\t\tif (this._beforePropEditor) {\r\n\t\t\tconst {classList} = this._beforePropEditor;\r\n\t\t\tif (classList) {\r\n\t\t\t\tmenu.classList.remove(...classList);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\topenMenu(grid, editor, col, row, value, menu);\r\n\t\tthis._activeData = {grid, col, row, editor};\r\n\t\tthis._beforePropEditor = editor;\r\n\t}\r\n\tdetach(gridFocus) {\r\n\t\tif (this._isActive()) {\r\n\t\t\tconst {grid, col, row} = this._activeData;\r\n\t\t\tconst menu = this._menu;\r\n\t\t\tcloseMenu(grid, col, row, menu);\r\n\r\n\t\t\tgrid.invalidateCell(col, row);\r\n\t\t\tif (gridFocus) {\r\n\t\t\t\tgrid.focus();\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._activeData = null;\r\n\t}\r\n\t_doChangeValue(valueindex) {\r\n\t\tif (!this._isActive()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst {grid, col, row, editor} = this._activeData;\r\n\t\tconst {value} = editor.options[valueindex];\r\n\t\tgrid.doChangeValue(col, row, () => value);\r\n\t}\r\n\t_isActive() {\r\n\t\tconst menu = this._menu;\r\n\t\tif (!menu || !menu.parentElement) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (!this._activeData) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\t_bindMenuEvents() {\r\n\t\tconst handler = this._handler;\r\n\t\tconst menu = this._menu;\r\n\r\n\t\tconst stopPropagationOnly = (e) => e.stopPropagation();// grid\r\n\t\t\r\n\t\thandler.on(menu, 'mousedown', stopPropagationOnly);\r\n\t\thandler.on(menu, 'touchstart', stopPropagationOnly);\r\n\t\thandler.on(menu, 'dblclick', stopPropagationOnly);\r\n\r\n\t\thandler.on(menu, 'click', (e) => {\r\n\t\t\te.stopPropagation();\r\n\t\t\tconst item = findItemParents(e.target);\r\n\t\t\tif (!item) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst valueindex = item.dataset.valueindex;\r\n\t\t\tthis._doChangeValue(item.dataset.valueindex);\r\n\t\t\tthis.detach(true);\r\n\t\t});\r\n\t\thandler.on(menu, 'keydown', (e) => {\r\n\t\t\tconst item = findItemParents(e.target);\r\n\t\t\tif (!item) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst keyCode = getKeyCode(e);\r\n\t\t\tif (keyCode === KEY_ENTER) {\r\n\t\t\t\tconst valueindex = item.dataset.valueindex;\r\n\t\t\t\tthis._doChangeValue(valueindex);\r\n\t\t\t\tthis.detach(true);\r\n\t\t\t\tcancelEvent(e);\r\n\t\t\t} else if (keyCode === KEY_ESC) {\r\n\t\t\t\tthis.detach(true);\r\n\t\t\t\tcancelEvent(e);\r\n\t\t\t} else if (keyCode === KEY_UP) {\r\n\t\t\t\tconst n = findPrevSiblingFocusable(item);\r\n\t\t\t\tif (n) {\r\n\t\t\t\t\tn.focus();\r\n\t\t\t\t\tcancelEvent(e);\r\n\t\t\t\t}\r\n\t\t\t} else if (keyCode === KEY_DOWN) {\r\n\t\t\t\tconst n = findNextSiblingFocusable(item);\r\n\t\t\t\tif (n) {\r\n\t\t\t\t\tn.focus();\r\n\t\t\t\t\tcancelEvent(e);\r\n\t\t\t\t}\r\n\t\t\t} else if (keyCode === KEY_TAB) {\r\n\t\t\t\tif (!e.shiftKey) {\r\n\t\t\t\t\tif (!findNextSiblingFocusable(item)) {\r\n\t\t\t\t\t\tlet n = menu.querySelector('.' + ITEM_CLASSNAME);\r\n\t\t\t\t\t\tif (!isFocusable(n)) {\r\n\t\t\t\t\t\t\tn = findNextSiblingFocusable(n);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (n) {\r\n\t\t\t\t\t\t\tn.focus();\r\n\t\t\t\t\t\t\tcancelEvent(e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (!findPrevSiblingFocusable(item)) {\r\n\t\t\t\t\t\tconst items = menu.querySelectorAll('.' + ITEM_CLASSNAME);\r\n\t\t\t\t\t\tlet n = items[items.length - 1];\r\n\t\t\t\t\t\tif (!isFocusable(n)) {\r\n\t\t\t\t\t\t\tn = findPrevSiblingFocusable(n);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (n) {\r\n\t\t\t\t\t\t\tn.focus();\r\n\t\t\t\t\t\t\tcancelEvent(e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nmodule.exports = InlineMenuElement;","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?minimize!./SmallDialogInputElement.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?minimize!./SmallDialogInputElement.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?minimize!./SmallDialogInputElement.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","'use strict';\r\nconst {\r\n\tevent: {\r\n\t\tgetKeyCode,\r\n\t\tcancel: cancelEvent,\r\n\t},\r\n\tthen,\r\n} = require('../../../internal/utils');\r\n\t\r\nconst EventHandler = require('../../../internal/EventHandler');\r\nconst {\r\n\tcreateElement,\r\n} = require('../../../internal/dom');\r\n\r\nconst CLASSNAME = 'cheetah-grid__small-dialog-input';\r\nconst INPUT_CLASSNAME = CLASSNAME + '__input';\r\nconst HIDDEN_CLASSNAME = CLASSNAME + '--hidden';\r\nconst SHOWN_CLASSNAME = CLASSNAME + '--shown';\r\n\r\nconst KEY_ENTER = 13;\r\nconst KEY_ESC = 27;\r\n\r\nfunction _focus(input, handler) {\r\n\tconst focus = () => {\r\n\t\tinput.focus();\r\n\r\n\t\tconst end = input.value.length;\r\n\t\ttry {\r\n\t\t\tif (typeof (input.selectionStart) !== 'undefined') {\r\n\t\t\t\tinput.selectionStart = end;\r\n\t\t\t\tinput.selectionEnd = end;\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\t//ignore\r\n\t\t}\r\n\t\tif (document.selection) {\r\n\t\t\tconst range = input.createTextRange();\r\n\t\t\trange.collapse();\r\n\t\t\trange.moveEnd('character', end);\r\n\t\t\trange.moveStart('character', end);\r\n\t\t\trange.select();\r\n\t\t}\r\n\t};\r\n\thandler.tryWithOffEvents(input, 'blur', () => {\r\n\t\tfocus();\r\n\t});\r\n}\r\n\r\nfunction createDialogElement() {\r\n\trequire('./SmallDialogInputElement.css');\r\n\tconst element = createElement('div', {classList: [CLASSNAME, HIDDEN_CLASSNAME]});\r\n\tconst input = createElement('input', {classList: INPUT_CLASSNAME});\r\n\tinput.readonly = true;\r\n\tinput.tabIndex = -1;\r\n\telement.appendChild(input);\r\n\treturn element;\r\n}\r\n\r\nfunction bindProps(grid, dialog, input, editor) {\r\n\tconst {classList, helperText} = editor;\r\n\tif (classList) {\r\n\t\tdialog.classList.add(...classList);\r\n\t}\r\n\tif (helperText && typeof helperText !== 'function') {\r\n\t\tdialog.dataset.helperText = helperText;\r\n\t}\r\n\tsetInputAttrs(editor, grid, input);\r\n}\r\n\r\nfunction unbindProps(grid, dialog, input, editor) {\r\n\tconst {classList} = editor;\r\n\tif (classList) {\r\n\t\tdialog.classList.remove(...classList);\r\n\t}\r\n\tdelete dialog.dataset.helperText;\r\n\tinput.type = '';\r\n}\r\n\r\nfunction setInputAttrs(editor, grid, input) {\r\n\tconst {type} = editor;\r\n\tinput.type = type || '';\r\n}\r\n\r\nclass SmallDialogInputElement {\r\n\tstatic setInputAttrs(...args) {\r\n\t\tsetInputAttrs(...args);\r\n\t}\r\n\tconstructor() {\r\n\t\tthis._handler = new EventHandler();\r\n\t\tthis._dialog = createDialogElement();\r\n\t\tthis._input = this._dialog.querySelector('.' + INPUT_CLASSNAME);\r\n\t\tthis._bindDialogEvents();\r\n\t}\r\n\tdispose() {\r\n\t\tconst dialog = this._dialog;\r\n\t\tthis.detach();\r\n\t\tthis._handler.dispose();\r\n\t\tthis._dialog = null;\r\n\t\tthis._input = null;\r\n\t\tthis._beforePropEditor = null;\r\n\t\tif (dialog.parentElement) {\r\n\t\t\tdialog.parentElement.removeChild(dialog);\r\n\t\t}\r\n\t}\r\n\tattach(grid, editor, col, row, value) {\r\n\t\tconst handler = this._handler;\r\n\t\tconst dialog = this._dialog;\r\n\t\tconst input = this._input;\r\n\r\n\t\tif (this._beforePropEditor) {\r\n\t\t\tunbindProps(grid, dialog, input, this._beforePropEditor);\r\n\t\t}\r\n\r\n\t\tdelete dialog.dataset.errorMessage;\r\n\t\tdialog.classList.remove(SHOWN_CLASSNAME);\r\n\t\tdialog.classList.add(HIDDEN_CLASSNAME);\r\n\t\tinput.readonly = false;\r\n\t\tinput.tabIndex = 0;\r\n\t\tconst {element, rect} = grid.getAttachCellArea(col, row);\r\n\t\tdialog.style.top = rect.top.toFixed() + 'px';\r\n\t\tdialog.style.left = rect.left.toFixed() + 'px';\r\n\t\tdialog.style.width = rect.width.toFixed() + 'px';\r\n\t\tinput.style.height = rect.height.toFixed() + 'px';\r\n\t\telement.appendChild(dialog);\r\n\t\t\t\r\n\t\tinput.value = value;\r\n\t\tinput.style.font = grid.font || '16px sans-serif';\r\n\t\tconst activeData = {grid, col, row, editor};\r\n\t\tthis._onInputValue(input, activeData);\r\n\t\t_focus(input, handler);\r\n\t\tdialog.classList.add(SHOWN_CLASSNAME);\r\n\t\tdialog.classList.remove(HIDDEN_CLASSNAME);\r\n\t\tinput.readonly = true;\r\n\r\n\t\t\r\n\t\tbindProps(grid, dialog, input, editor);\r\n\r\n\t\tthis._activeData = activeData;\r\n\t\tthis._beforePropEditor = editor;\r\n\t}\r\n\tdetach(gridFocus) {\r\n\t\tif (this._isActive()) {\r\n\t\t\tconst dialog = this._dialog;\r\n\t\t\tconst input = this._input;\r\n\r\n\t\t\tdialog.classList.remove(SHOWN_CLASSNAME);\r\n\t\t\tdialog.classList.add(HIDDEN_CLASSNAME);\r\n\t\t\tinput.readonly = false;\r\n\t\t\tinput.tabIndex = -1;\r\n\r\n\t\t\tconst {grid, col, row} = this._activeData;\r\n\t\t\t\r\n\t\t\tgrid.invalidateCell(col, row);\r\n\t\t\tif (gridFocus) {\r\n\t\t\t\tgrid.focus();\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis._activeData = null;\r\n\t\tthis._beforeValue = null;\r\n\t}\r\n\t_doChangeValue() {\r\n\t\tif (!this._isActive()) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tconst input = this._input;\r\n\t\tconst {value} = input;\r\n\t\treturn then(this._validate(value), (res) => {\r\n\t\t\tif (res && value === input.value) {\r\n\t\t\t\tconst {grid, col, row} = this._activeData;\r\n\t\t\t\tgrid.doChangeValue(col, row, () => value);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t});\r\n\t}\r\n\t_isActive() {\r\n\t\tconst dialog = this._dialog;\r\n\t\tif (!dialog || !dialog.parentElement) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (!this._activeData) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\t_bindDialogEvents() {\r\n\t\tconst handler = this._handler;\r\n\t\tconst dialog = this._dialog;\r\n\t\tconst input = this._input;\r\n\t\tconst stopPropagationOnly = (e) => e.stopPropagation();// grid\r\n\t\thandler.on(dialog, 'click', stopPropagationOnly);\r\n\t\thandler.on(dialog, 'dblclick', stopPropagationOnly);\r\n\t\thandler.on(dialog, 'mousedown', stopPropagationOnly);\r\n\t\thandler.on(dialog, 'touchstart', stopPropagationOnly);\r\n\t\t\t\r\n\t\thandler.on(input, 'compositionstart', (e) => {\r\n\t\t\tinput.classList.add('composition');\r\n\t\t});\r\n\t\thandler.on(input, 'compositionend', (e) => {\r\n\t\t\tinput.classList.remove('composition');\r\n\t\t\tthis._onInputValue(input);\r\n\t\t});\r\n\t\tconst onKeyupAndPress = (e) => {\r\n\t\t\tif (input.classList.contains('composition')) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._onInputValue(input);\r\n\t\t};\r\n\t\thandler.on(input, 'keyup', onKeyupAndPress);\r\n\t\thandler.on(input, 'keypress', onKeyupAndPress);\r\n\t\thandler.on(input, 'keydown', (e) => {\r\n\t\t\tif (input.classList.contains('composition')) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst keyCode = getKeyCode(e);\r\n\t\t\tif (keyCode === KEY_ESC) {\r\n\t\t\t\tthis.detach(true);\r\n\t\t\t\tcancelEvent(e);\r\n\t\t\t} else if (keyCode === KEY_ENTER) {\r\n\t\t\t\tconst input = this._input;\r\n\t\t\t\tconst {value} = input;\r\n\t\t\t\tthen(this._doChangeValue(), (r) => {\r\n\t\t\t\t\tif (r && value === input.value) {\r\n\t\t\t\t\t\tthis.detach(true);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tcancelEvent(e);\r\n\t\t\t} else {\r\n\t\t\t\tthis._onInputValue(input);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\t_onInputValue(input, activeData) {\r\n\t\tconst before = this._beforeValue;\r\n\t\tconst {value} = input;\r\n\t\tif (before !== value) {\r\n\t\t\tthis._onInputValueChange(value, before, activeData);\r\n\t\t}\r\n\t\tthis._beforeValue = value;\r\n\t}\r\n\t_onInputValueChange(after, before, activeData) {\r\n\t\tactiveData = activeData || this._activeData;\r\n\t\tconst dialog = this._dialog;\r\n\t\tconst {grid, col, row, editor} = activeData;\r\n\t\tif (typeof editor.helperText === 'function') {\r\n\t\t\tconst helperText = editor.helperText(after, {grid, col, row});\r\n\t\t\tif (helperText) {\r\n\t\t\t\tdialog.dataset.helperText = helperText;\r\n\t\t\t} else {\r\n\t\t\t\tdelete dialog.dataset.helperText;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif ('errorMessage' in dialog.dataset) {\r\n\t\t\tthis._validate(after, true);\r\n\t\t}\r\n\t}\r\n\t_validate(value, inputOnly) {\r\n\t\tconst dialog = this._dialog;\r\n\t\tconst input = this._input;\r\n\t\tconst {grid, col, row, editor} = this._activeData;\r\n\t\tlet message = null;\r\n\t\tif (editor.inputValidator) {\r\n\t\t\tmessage = editor.inputValidator(value, {grid, col, row});\r\n\t\t}\r\n\t\treturn then(message, (message) => {\r\n\t\t\tif (!message && editor.validator && !inputOnly) {\r\n\t\t\t\tmessage = editor.validator(value, {grid, col, row});\r\n\t\t\t}\r\n\t\t\treturn then(message, (message) => {\r\n\t\t\t\tif (message && value === input.value) {\r\n\t\t\t\t\tdialog.dataset.errorMessage = message;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tdelete dialog.dataset.errorMessage;\r\n\t\t\t\t}\r\n\t\t\t\treturn !message;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n}\r\n\r\nmodule.exports = SmallDialogInputElement;","'use strict';\r\n\r\nclass BaseMessage {\r\n\tconstructor(grid) {\r\n\t\tthis._grid = grid;\r\n\t}\r\n\tdispose() {\r\n\t\tthis.detachMessageElement();\r\n\t\tif (this._messageElement) {\r\n\t\t\tthis._messageElement.dispose();\r\n\t\t}\r\n\t\tthis._messageElement = null;\r\n\t}\r\n\t_getMessageElement() {\r\n\t\treturn this._messageElement || (this._messageElement = this.createMessageElementInternal());\r\n\t}\r\n\tcreateMessageElementInternal() {\r\n\r\n\t}\r\n\tdrawCellMessageInternal(message, context, style, helper, info) {\r\n\r\n\t}\r\n\tattachMessageElement(col, row, message) {\r\n\t\tconst messageElement = this._getMessageElement();\r\n\t\tmessageElement.attach(this._grid, col, row, message);\r\n\t}\r\n\tmoveMessageElement(col, row) {\r\n\t\tconst messageElement = this._getMessageElement();\r\n\t\tmessageElement.move(this._grid, col, row);\r\n\t}\r\n\tdetachMessageElement() {\r\n\t\tconst messageElement = this._getMessageElement();\r\n\t\tmessageElement._detach();\r\n\t}\r\n\tdrawCellMessage(message, context, style, helper, info) {\r\n\t\tthis.drawCellMessageInternal(message, context, style, helper, info);\r\n\t}\r\n}\r\n\r\nmodule.exports = BaseMessage;","'use strict';\r\n\r\n\r\nconst Rect = require('../../internal/Rect');\r\nconst BaseMessage = require('./BaseMessage');\r\nconst ErrorMessageElement = require('./internal/ErrorMessageElement');\r\n\r\nconst RED_A100 = '#ff8a80';\r\n// const RED_A400 = '#FF1744';\r\n\r\nclass ErrorMessage extends BaseMessage {\r\n\tcreateMessageElementInternal() {\r\n\t\treturn new ErrorMessageElement();\r\n\t}\r\n\tdrawCellMessageInternal(message, context, style, helper, info) {\r\n\t\tconst {bgColor} = style;\r\n\r\n\t\tconst {selected} = context.getSelectState();\r\n\r\n\t\tconst rect = context.getRect();\r\n\r\n\t\thelper.drawBorderWithClip(context, (ctx) => {\r\n\t\t\tif (!selected) {\r\n\t\t\t\t// draw box\r\n\t\t\t\tctx.fillStyle = RED_A100;\r\n\t\t\t\tconst boxRect = rect.copy();\r\n\t\t\t\tboxRect.left = boxRect.right - 24;\r\n\t\t\t\tctx.fillRect(boxRect.left, boxRect.top, boxRect.width, boxRect.height - 1);\r\n\r\n\t\t\t\t// draw exclamation mark\r\n\t\t\t\tconst fillColor = bgColor;\r\n\t\t\t\tconst height = 20;\r\n\t\t\t\tconst width = height / 5;\r\n\t\t\t\tconst left = boxRect.left + (boxRect.width - width) / 2;\r\n\t\t\t\tconst top = boxRect.top + (boxRect.height - height) / 2;\r\n\t\t\t\thelper.fillRectWithState(new Rect(left, top, width, height / 5 * 3),\r\n\t\t\t\t\t\tcontext, {fillColor});\r\n\t\t\t\thelper.fillRectWithState(new Rect(left, top + height / 5 * 4, width, height / 5),\r\n\t\t\t\t\t\tcontext, {fillColor});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nmodule.exports = ErrorMessage;","'use strict';\r\n\r\nconst BaseMessage = require('./BaseMessage');\r\nconst MessageElement = require('./internal/MessageElement');\r\n\r\nconst Rect = require('../../internal/Rect');\r\n\r\nconst GREY_L2 = '#e0e0e0';\r\n// const GREY_L1 = '#bdbdbd';\r\n\t\r\nclass InfoMessage extends BaseMessage {\r\n\tcreateMessageElementInternal() {\r\n\t\treturn new MessageElement();\r\n\t}\r\n\tdrawCellMessageInternal(message, context, style, helper, info) {\r\n\t\tconst {bgColor} = style;\r\n\r\n\t\tconst {selected} = context.getSelectState();\r\n\r\n\t\tconst rect = context.getRect();\r\n\r\n\t\thelper.drawBorderWithClip(context, (ctx) => {\r\n\t\t\tif (!selected) {\r\n\t\t\t\t// draw box\r\n\t\t\t\tctx.fillStyle = GREY_L2;\r\n\t\t\t\tconst boxRect = rect.copy();\r\n\t\t\t\tboxRect.left = boxRect.right - 24;\r\n\t\t\t\tctx.fillRect(boxRect.left, boxRect.top, boxRect.width, boxRect.height - 1);\r\n\r\n\t\t\t\t// draw exclamation mark\r\n\t\t\t\tconst fillColor = bgColor;\r\n\t\t\t\tconst height = 20;\r\n\t\t\t\tconst width = height / 5;\r\n\t\t\t\tconst left = boxRect.left + (boxRect.width - width) / 2;\r\n\t\t\t\tconst top = boxRect.top + (boxRect.height - height) / 2;\r\n\t\t\t\thelper.fillRectWithState(new Rect(left, top, width, height / 5),\r\n\t\t\t\t\t\tcontext, {fillColor});\r\n\t\t\t\thelper.fillRectWithState(new Rect(left, top + height / 5 * 2, width, height / 5 * 3),\r\n\t\t\t\t\t\tcontext, {fillColor});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nmodule.exports = InfoMessage;","'use strict';\r\n\r\n\r\nconst {isPromise} = require('../../internal/utils');\r\nconst {\r\n\tSELECTED_CELL,\r\n\tSCROLL,\r\n\tCHANGED_VALUE\r\n} = require('../../list-grid/EVENT_TYPE');\r\nconst ErrorMessage = require('./ErrorMessage');\r\nconst WarningMessage = require('./WarningMessage');\r\nconst InfoMessage = require('./InfoMessage');\r\n\r\n\r\nclass MessageHandler {\r\n\tconstructor(grid, getMessage) {\r\n\t\tthis._grid = grid;\r\n\t\tthis._messageInstances = {};\r\n\t\tthis._bindGridEvent(grid, getMessage);\r\n\t}\r\n\tdispose() {\r\n\t\tconst messageInstances = this._messageInstances;\r\n\t\tfor (const k in messageInstances) {\r\n\t\t\tmessageInstances[k].dispose();\r\n\t\t}\r\n\t\tthis._messageInstances = null;\r\n\t}\r\n\tdrawCellMessage(message, context, style, helper, info) {\r\n\r\n\t\tif (!message || isPromise(message)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst instance = this._getMessageInstanceOfMessage(message);\r\n\t\tinstance.drawCellMessage(message, context, style, helper, info);\r\n\t}\r\n\t_attach(col, row, message) {\r\n\t\tconst info = this._attachInfo;\r\n\t\tconst instance = this._getMessageInstanceOfMessage(message);\r\n\t\tif (info && info.instance !== instance) {\r\n\t\t\tinfo.instance.detachMessageElement();\r\n\t\t}\r\n\t\tinstance.attachMessageElement(col, row, this._toMessageText(message));\r\n\t\tthis._attachInfo = {col, row, instance};\r\n\t}\r\n\t_move(col, row) {\r\n\t\tconst info = this._attachInfo;\r\n\t\tif (!info || info.col !== col || info.row !== row) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst {instance} = info;\r\n\t\tinstance.moveMessageElement(col, row);\r\n\t}\r\n\t_detach() {\r\n\t\tconst info = this._attachInfo;\r\n\t\tif (!info) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst {instance} = info;\r\n\t\tinstance.detachMessageElement();\r\n\t\tthis._attachInfo = null;\r\n\t}\r\n\t_bindGridEvent(grid, getMessage) {\r\n\t\tconst onSelectMessage = (sel) => {\r\n\t\t\tconst message = getMessage(sel.col, sel.row);\r\n\t\t\tif (!message || isPromise(message)) {\r\n\t\t\t\tthis._detach();\r\n\t\t\t} else {\r\n\t\t\t\tthis._attach(sel.col, sel.row, message);\r\n\t\t\t}\r\n\r\n\t\t};\r\n\t\tgrid.listen(SELECTED_CELL, (e) => {\r\n\t\t\tif (!e.selected) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (e.before.col === e.col && e.before.row === e.row) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tonSelectMessage(e);\r\n\t\t});\r\n\t\tgrid.listen(SCROLL, () => {\r\n\t\t\tconst sel = grid.selection.select;\r\n\t\t\tthis._move(sel.col, sel.row);\r\n\t\t});\r\n\t\tgrid.listen(CHANGED_VALUE, (e) => {\r\n\t\t\tconst sel = grid.selection.select;\r\n\t\t\tif (sel.col !== e.col || sel.row !== e.row) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tonSelectMessage(e);\r\n\t\t});\r\n\t}\r\n\t_getMessageInstanceOfMessage(message) {\r\n\t\tmessage = message || '';\r\n\t\tif (typeof message === 'string') {\r\n\t\t\treturn this._createMessageInstance('error', ErrorMessage);\r\n\t\t}\r\n\t\tconst type = ('' + message.type).toLowerCase();\r\n\t\tif (type === 'info') {\r\n\t\t\treturn this._createMessageInstance('info', InfoMessage);\r\n\t\t} else if (type === 'warning') {\r\n\t\t\treturn this._createMessageInstance('warning', WarningMessage);\r\n\t\t}\r\n\t\treturn this._createMessageInstance('error', ErrorMessage);\r\n\t}\r\n\t_toMessageText(message) {\r\n\t\tmessage = message || '';\r\n\t\tif (typeof message === 'string') {\r\n\t\t\treturn message;\r\n\t\t}\r\n\t\tif (message.message) {\r\n\t\t\treturn message.message;\r\n\t\t}\r\n\t\treturn '' + message;\r\n\t}\r\n\t_createMessageInstance(name, Message) {\r\n\t\tconst messageInstances = this._messageInstances;\r\n\t\treturn messageInstances[name] || (messageInstances[name] = new Message(this._grid));\r\n\t}\r\n}\r\n\r\nmodule.exports = MessageHandler;","'use strict';\r\n\r\n\r\nconst Rect = require('../../internal/Rect');\r\nconst BaseMessage = require('./BaseMessage');\r\nconst WarningMessageElement = require('./internal/WarningMessageElement');\r\n\r\nconst DEEP_ORANGE_A100 = '#ff9e80';\r\n\r\nclass WarningMessage extends BaseMessage {\r\n\tcreateMessageElementInternal() {\r\n\t\treturn new WarningMessageElement();\r\n\t}\r\n\tdrawCellMessageInternal(message, context, style, helper, info) {\r\n\t\tconst {bgColor} = style;\r\n\r\n\t\tconst {selected} = context.getSelectState();\r\n\r\n\t\tconst rect = context.getRect();\r\n\r\n\t\thelper.drawBorderWithClip(context, (ctx) => {\r\n\t\t\tif (!selected) {\r\n\t\t\t\t// draw box\r\n\t\t\t\tctx.fillStyle = DEEP_ORANGE_A100;\r\n\t\t\t\tconst boxRect = rect.copy();\r\n\t\t\t\tboxRect.left = boxRect.right - 24;\r\n\t\t\t\tctx.fillRect(boxRect.left, boxRect.top, boxRect.width, boxRect.height - 1);\r\n\r\n\t\t\t\t// draw exclamation mark\r\n\t\t\t\tconst fillColor = bgColor;\r\n\t\t\t\tconst height = 20;\r\n\t\t\t\tconst width = height / 5;\r\n\t\t\t\tconst left = boxRect.left + (boxRect.width - width) / 2;\r\n\t\t\t\tconst top = boxRect.top + (boxRect.height - height) / 2;\r\n\t\t\t\thelper.fillRectWithState(new Rect(left, top, width, height / 5 * 3),\r\n\t\t\t\t\t\tcontext, {fillColor});\r\n\t\t\t\thelper.fillRectWithState(new Rect(left, top + height / 5 * 4, width, height / 5),\r\n\t\t\t\t\t\tcontext, {fillColor});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}\r\n\r\nmodule.exports = WarningMessage;","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?minimize!./ErrorMessageElement.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?minimize!./ErrorMessageElement.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?minimize!./ErrorMessageElement.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","'use strict';\r\nconst MessageElement = require('./MessageElement');\r\n\r\nconst CLASSNAME = 'cheetah-grid__error-message-element';\r\nconst MESSAGE_CLASSNAME = CLASSNAME + '__message';\r\n\r\n\r\nclass ErrorMessageElement extends MessageElement {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\trequire('./ErrorMessageElement.css');\r\n\t\tthis._rootElement.classList.add(CLASSNAME);\r\n\t\tthis._messageElement.classList.add(MESSAGE_CLASSNAME);\r\n\t}\r\n}\r\n\r\nmodule.exports = ErrorMessageElement;","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?minimize!./MessageElement.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?minimize!./MessageElement.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?minimize!./MessageElement.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","'use strict';\r\nconst EventHandler = require('../../../internal/EventHandler');\r\nconst {\r\n\tcreateElement,\r\n} = require('../../../internal/dom');\r\n\r\nconst CLASSNAME = 'cheetah-grid__message-element';\r\nconst MESSAGE_CLASSNAME = CLASSNAME + '__message';\r\nconst HIDDEN_CLASSNAME = CLASSNAME + '--hidden';\r\nconst SHOWN_CLASSNAME = CLASSNAME + '--shown';\r\n\r\nfunction createrootElement() {\r\n\trequire('./MessageElement.css');\r\n\tconst element = createElement('div', {classList: [CLASSNAME, HIDDEN_CLASSNAME]});\r\n\tconst message = createElement('span', {classList: [MESSAGE_CLASSNAME]});\r\n\telement.appendChild(message);\r\n\treturn element;\r\n}\r\n\r\n\r\nclass MessageElement {\r\n\tconstructor() {\r\n\t\tthis._handler = new EventHandler();\r\n\t\tconst rootElement = this._rootElement = createrootElement();\r\n\t\tthis._messageElement = rootElement.querySelector(`.${MESSAGE_CLASSNAME}`);\r\n\t}\r\n\tdispose() {\r\n\t\tthis.detach();\r\n\t\tthis._handler.dispose();\r\n\t\tthis._rootElement = null;\r\n\t\tthis._messageElement = null;\r\n\t}\r\n\tattach(grid, col, row, message) {\r\n\t\tconst rootElement = this._rootElement;\r\n\t\tconst messageElement = this._messageElement;\r\n\r\n\t\trootElement.classList.remove(SHOWN_CLASSNAME);\r\n\t\trootElement.classList.add(HIDDEN_CLASSNAME);\r\n\r\n\t\tif (this._attachCell(grid, col, row)) {\r\n\t\t\trootElement.classList.add(SHOWN_CLASSNAME);\r\n\t\t\trootElement.classList.remove(HIDDEN_CLASSNAME);\r\n\r\n\t\t\tmessageElement.textContent = message;\r\n\t\t} else {\r\n\t\t\tthis._detach();\r\n\t\t}\r\n\t}\r\n\tmove(grid, col, row) {\r\n\t\tconst rootElement = this._rootElement;\r\n\t\tif (this._attachCell(grid, col, row)) {\r\n\r\n\t\t\trootElement.classList.add(SHOWN_CLASSNAME);\r\n\t\t\trootElement.classList.remove(HIDDEN_CLASSNAME);\r\n\t\t} else {\r\n\t\t\tthis._detach();\r\n\t\t}\r\n\t}\r\n\tdetach() {\r\n\t\tthis._detach();\r\n\t}\r\n\t_detach() {\r\n\t\tconst rootElement = this._rootElement;\r\n\t\tif (rootElement.parentElement) {\r\n\t\t\trootElement.parentElement.removeChild(rootElement);\r\n\t\t\trootElement.classList.remove(SHOWN_CLASSNAME);\r\n\t\t\trootElement.classList.add(HIDDEN_CLASSNAME);\r\n\t\t}\r\n\t}\r\n\t_attachCell(grid, col, row) {\r\n\t\tconst rootElement = this._rootElement;\r\n\t\tconst {element, rect} = grid.getAttachCellArea(col, row);\r\n\r\n\t\tconst {bottom: top, left, width} = rect;\r\n\t\tconst {frozenRowCount, frozenColCount} = grid;\r\n\t\tif (row >= frozenRowCount && frozenRowCount > 0) {\r\n\t\t\tconst {rect: frozenRect} = grid.getAttachCellArea(col, frozenRowCount - 1);\r\n\t\t\tif (top < frozenRect.bottom) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (top < 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (col >= frozenColCount && frozenColCount > 0) {\r\n\t\t\tconst {rect: frozenRect} = grid.getAttachCellArea(frozenColCount - 1, row);\r\n\t\t\tif (left < frozenRect.right) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif (left < 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst {offsetHeight, offsetWidth} = element;\r\n\t\tif (offsetHeight < top) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tif (offsetWidth < left) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\trootElement.style.top = top.toFixed() + 'px';\r\n\t\trootElement.style.left = left.toFixed() + 'px';\r\n\t\trootElement.style.width = width.toFixed() + 'px';\r\n\t\tif (rootElement.parentElement !== element) {\r\n\t\t\telement.appendChild(rootElement);\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n}\r\n\r\nmodule.exports = MessageElement;","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js?minimize!./WarningMessageElement.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js?minimize!./WarningMessageElement.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js?minimize!./WarningMessageElement.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","'use strict';\r\nconst MessageElement = require('./MessageElement');\r\n\r\nconst CLASSNAME = 'cheetah-grid__warning-message-element';\r\nconst MESSAGE_CLASSNAME = CLASSNAME + '__message';\r\n\r\n\r\nclass WarningMessageElement extends MessageElement {\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\trequire('./WarningMessageElement.css');\r\n\t\tthis._rootElement.classList.add(CLASSNAME);\r\n\t\tthis._messageElement.classList.add(MESSAGE_CLASSNAME);\r\n\t}\r\n}\r\n\r\nmodule.exports = WarningMessageElement;","'use strict';\r\n{\r\n\tconst BaseStyle = require('./style/BaseStyle');\r\n\tconst Style = require('./style/Style');\r\n\tconst NumberStyle = require('./style/NumberStyle');\r\n\tconst CheckStyle = require('./style/CheckStyle');\r\n\tconst ButtonStyle = require('./style/ButtonStyle');\r\n\tconst ImageStyle = require('./style/ImageStyle');\r\n\tconst IconStyle = require('./style/IconStyle');\r\n\tconst PercentCompleteBarStyle = require('./style/PercentCompleteBarStyle');\r\n\r\n\t/**\r\n\t * column styles\r\n\t * @type {Object}\r\n\t * @namespace cheetahGrid.columns.style\r\n\t * @memberof cheetahGrid.columns\r\n\t */\r\n\tconst style = {\r\n\t\tget EVENT_TYPE() {\r\n\t\t\treturn BaseStyle.EVENT_TYPE;\r\n\t\t},\r\n\t\tget BaseStyle() {\r\n\t\t\treturn BaseStyle;\r\n\t\t},\r\n\t\tget Style() {\r\n\t\t\treturn Style;\r\n\t\t},\r\n\t\tget NumberStyle() {\r\n\t\t\treturn NumberStyle;\r\n\t\t},\r\n\t\tget CheckStyle() {\r\n\t\t\treturn CheckStyle;\r\n\t\t},\r\n\t\tget ButtonStyle() {\r\n\t\t\treturn ButtonStyle;\r\n\t\t},\r\n\t\tget ImageStyle() {\r\n\t\t\treturn ImageStyle;\r\n\t\t},\r\n\t\tget IconStyle() {\r\n\t\t\treturn IconStyle;\r\n\t\t},\r\n\t\tget PercentCompleteBarStyle() {\r\n\t\t\treturn PercentCompleteBarStyle;\r\n\t\t},\r\n\t\tof(columnStyle, record, StyleClass) {\r\n\t\t\tif (columnStyle) {\r\n\t\t\t\tif (columnStyle instanceof Style) {\r\n\t\t\t\t\treturn columnStyle;\r\n\t\t\t\t} else if (typeof columnStyle === 'function') {\r\n\t\t\t\t\treturn style.of(columnStyle(record), record, StyleClass);\r\n\t\t\t\t} else if (record && columnStyle in record) {\r\n\t\t\t\t\treturn style.of(record[columnStyle], record, StyleClass);\r\n\t\t\t\t}\r\n\t\t\t\treturn new StyleClass(columnStyle);\r\n\t\t\t} else {\r\n\t\t\t\treturn StyleClass.DEFAULT;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tmodule.exports = style;\r\n}","'use strict';\r\n{\r\n\tconst EventTarget = require('../../core/EventTarget');\r\n\r\n\tconst EVENT_TYPE = {\r\n\t\tCHANGE_STYLE: 'change_style',\r\n\t};\r\n\r\n\tlet defaultStyle;\r\n\tclass BaseStyle extends EventTarget {\r\n\t\tstatic get EVENT_TYPE() {\r\n\t\t\treturn EVENT_TYPE;\r\n\t\t}\r\n\t\tstatic get DEFAULT() {\r\n\t\t\treturn defaultStyle ? defaultStyle : (defaultStyle = new BaseStyle());\r\n\t\t}\r\n\t\tconstructor(\r\n\t\t\t\t{\r\n\t\t\t\t\tbgColor\r\n\t\t\t\t} = {}) {\r\n\t\t\tsuper();\r\n\t\t\tthis._bgColor = bgColor;\r\n\t\t}\r\n\t\tget bgColor() {\r\n\t\t\treturn this._bgColor;\r\n\t\t}\r\n\t\tset bgColor(bgColor) {\r\n\t\t\tthis._bgColor = bgColor;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tdoChangeStyle() {\r\n\t\t\tthis.fireListeners(EVENT_TYPE.CHANGE_STYLE);\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new BaseStyle(this);\r\n\t\t}\r\n\t}\r\n\tmodule.exports = BaseStyle;\r\n}","'use strict';\r\nconst BaseStyle = require('./BaseStyle');\r\nlet defaultStyle;\r\nfunction adj(style) {\r\n\tconst {textAlign = 'center'} = style;\r\n\tstyle.textAlign = textAlign;\r\n\treturn style;\r\n}\r\nconst DEFAULT_BRANCH_COLORS = (name, index) => {\r\n\tswitch (index % 3) {\r\n\tcase 0:\r\n\t\treturn '#979797';\r\n\tcase 1:\r\n\t\treturn '#008fb5';\r\n\tcase 2:\r\n\t\treturn '#f1c109';\r\n\tdefault:\r\n\t}\r\n\treturn '#979797';\r\n};\r\nclass BranchGraphStyle extends BaseStyle {\r\n\tstatic get DEFAULT() {\r\n\t\treturn defaultStyle ? defaultStyle : (defaultStyle = new BranchGraphStyle());\r\n\t}\r\n\tconstructor(style = {}) {\r\n\t\tsuper(adj(style));\r\n\t\tthis._branchColors = style.branchColors || DEFAULT_BRANCH_COLORS;\r\n\t\tthis._margin = style.margin || 4;\r\n\t\tthis._circleSize = style.circleSize || 16;\r\n\t\tthis._branchLineWidth = style.branchLineWidth || 4;\r\n\t\tthis._mergeStyle = style.mergeStyle === 'straight' ? 'straight' : 'bezier';\r\n\t}\r\n\tget branchColors() {\r\n\t\treturn this._branchColors;\r\n\t}\r\n\tset branchColors(branchColors) {\r\n\t\tthis._branchColors = branchColors;\r\n\t\tthis.doChangeStyle();\r\n\t}\r\n\tget margin() {\r\n\t\treturn this._margin;\r\n\t}\r\n\tset margin(margin) {\r\n\t\tthis._margin = margin;\r\n\t\tthis.doChangeStyle();\r\n\t}\r\n\tget circleSize() {\r\n\t\treturn this._circleSize;\r\n\t}\r\n\tset circleSize(circleSize) {\r\n\t\tthis._circleSize = circleSize;\r\n\t\tthis.doChangeStyle();\r\n\t}\r\n\tget branchLineWidth() {\r\n\t\treturn this._branchLineWidth;\r\n\t}\r\n\tset branchLineWidth(branchLineWidth) {\r\n\t\tthis._branchLineWidth = branchLineWidth;\r\n\t\tthis.doChangeStyle();\r\n\t}\r\n\tget mergeStyle() {\r\n\t\treturn this._mergeStyle;\r\n\t}\r\n\tset mergeStyle(mergeStyle) {\r\n\t\tthis._mergeStyle = mergeStyle;\r\n\t\tthis.doChangeStyle();\r\n\t}\r\n\tclone() {\r\n\t\treturn new BranchGraphStyle(this);\r\n\t}\r\n}\r\nmodule.exports = BranchGraphStyle;","'use strict';\r\n{\r\n\tconst Style = require('./Style');\r\n\r\n\tfunction adj(style) {\r\n\t\tconst {textAlign = 'center'} = style;\r\n\t\tstyle.textAlign = textAlign;\r\n\t\treturn style;\r\n\t}\r\n\tlet defaultStyle;\r\n\tclass ButtonStyle extends Style {\r\n\t\tstatic get DEFAULT() {\r\n\t\t\treturn defaultStyle ? defaultStyle : (defaultStyle = new ButtonStyle());\r\n\t\t}\r\n\t\tconstructor(style = {}) {\r\n\t\t\tsuper(adj(style));\r\n\t\t\tconst {\r\n\t\t\t\tbuttonBgColor,\r\n\t\t\t} = style;\r\n\t\t\tthis._buttonBgColor = buttonBgColor;\r\n\t\t}\r\n\t\tget buttonBgColor() {\r\n\t\t\treturn this._buttonBgColor;\r\n\t\t}\r\n\t\tset buttonBgColor(buttonBgColor) {\r\n\t\t\tthis._buttonBgColor = buttonBgColor;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new ButtonStyle(this);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tmodule.exports = ButtonStyle;\r\n}","'use strict';\r\n{\r\n\tconst StdBaseStyle = require('./StdBaseStyle');\r\n\r\n\tfunction adj(style) {\r\n\t\tconst {textAlign = 'center'} = style;\r\n\t\tstyle.textAlign = textAlign;\r\n\t\treturn style;\r\n\t}\r\n\tlet defaultStyle;\r\n\tclass CheckStyle extends StdBaseStyle {\r\n\t\tstatic get DEFAULT() {\r\n\t\t\treturn defaultStyle ? defaultStyle : (defaultStyle = new CheckStyle());\r\n\t\t}\r\n\t\tconstructor(style = {}) {\r\n\t\t\tsuper(adj(style));\r\n\t\t\tconst {\r\n\t\t\t\tuncheckBgColor,\r\n\t\t\t\tcheckBgColor,\r\n\t\t\t\tborderColor,\r\n\t\t\t} = style;\r\n\t\t\tthis._uncheckBgColor = uncheckBgColor;\r\n\t\t\tthis._checkBgColor = checkBgColor;\r\n\t\t\tthis._borderColor = borderColor;\r\n\t\t}\r\n\t\tget uncheckBgColor() {\r\n\t\t\treturn this._uncheckBgColor;\r\n\t\t}\r\n\t\tset uncheckBgColor(uncheckBgColor) {\r\n\t\t\tthis._uncheckBgColor = uncheckBgColor;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tget checkBgColor() {\r\n\t\t\treturn this._checkBgColor;\r\n\t\t}\r\n\t\tset checkBgColor(checkBgColor) {\r\n\t\t\tthis._checkBgColor = checkBgColor;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tget borderColor() {\r\n\t\t\treturn this._borderColor;\r\n\t\t}\r\n\t\tset borderColor(borderColor) {\r\n\t\t\tthis._borderColor = borderColor;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new CheckStyle(this);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tmodule.exports = CheckStyle;\r\n}","'use strict';\r\n{\r\n\tconst Style = require('./Style');\r\n\r\n\tfunction adj(style) {\r\n\t\tconst {textAlign = 'center'} = style;\r\n\t\tstyle.textAlign = textAlign;\r\n\t\treturn style;\r\n\t}\r\n\tlet defaultStyle;\r\n\tclass IconStyle extends Style {\r\n\t\tstatic get DEFAULT() {\r\n\t\t\treturn defaultStyle ? defaultStyle : (defaultStyle = new IconStyle());\r\n\t\t}\r\n\t\tconstructor(style = {}) {\r\n\t\t\tsuper(adj(style));\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new IconStyle(this);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tmodule.exports = IconStyle;\r\n}","'use strict';\r\n{\r\n\tconst StdBaseStyle = require('./StdBaseStyle');\r\n\tlet defaultStyle;\r\n\tfunction adj(style) {\r\n\t\tconst {textAlign = 'center'} = style;\r\n\t\tstyle.textAlign = textAlign;\r\n\t\treturn style;\r\n\t}\r\n\tclass ImageStyle extends StdBaseStyle {\r\n\t\tstatic get DEFAULT() {\r\n\t\t\treturn defaultStyle ? defaultStyle : (defaultStyle = new ImageStyle());\r\n\t\t}\r\n\t\tconstructor(style = {}) {\r\n\t\t\tsuper(adj(style));\r\n\t\t\tthis._imageSizing = style.imageSizing;\r\n\t\t\tthis._margin = style.margin || 4;\r\n\t\t}\r\n\t\tget imageSizing() {\r\n\t\t\treturn this._imageSizing;\r\n\t\t}\r\n\t\tset imageSizing(imageSizing) {\r\n\t\t\tthis._imageSizing = imageSizing;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tget margin() {\r\n\t\t\treturn this._margin;\r\n\t\t}\r\n\t\tset margin(margin) {\r\n\t\t\tthis._margin = margin;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new ImageStyle(this);\r\n\t\t}\r\n\t}\r\n\tmodule.exports = ImageStyle;\r\n}","'use strict';\r\n{\r\n\tconst Style = require('./Style');\r\n\r\n\tfunction adj(style) {\r\n\t\tconst {textAlign = 'right'} = style;\r\n\t\tstyle.textAlign = textAlign;\r\n\t\treturn style;\r\n\t}\r\n\tlet defaultStyle;\r\n\tclass NumberStyle extends Style {\r\n\t\tstatic get DEFAULT() {\r\n\t\t\treturn defaultStyle ? defaultStyle : (defaultStyle = new NumberStyle());\r\n\t\t}\r\n\t\tconstructor(style = {}) {\r\n\t\t\tsuper(adj(style));\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new NumberStyle(this);\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tmodule.exports = NumberStyle;\r\n}","'use strict';\r\n{\r\n\tconst Style = require('./Style');\r\n\tlet defaultStyle;\r\n\tconst DEFAULT_BAR_COLOR = (num) => {\r\n\t\tif (num > 80) {\r\n\t\t\treturn '#20a8d8';\r\n\t\t}\r\n\t\tif (num > 50) {\r\n\t\t\treturn '#4dbd74';\r\n\t\t}\r\n\t\tif (num > 20) {\r\n\t\t\treturn '#ffc107';\r\n\t\t}\r\n\t\treturn '#f86c6b';\r\n\t};\r\n\tclass PercentCompleteBarStyle extends Style {\r\n\t\tstatic get DEFAULT() {\r\n\t\t\treturn defaultStyle ? defaultStyle : (defaultStyle = new PercentCompleteBarStyle());\r\n\t\t}\r\n\t\tconstructor(style = {}) {\r\n\t\t\tsuper(style);\r\n\t\t\tthis._barColor = style.barColor || DEFAULT_BAR_COLOR;\r\n\t\t\tthis._barBgColor = style.barBgColor || '#f0f3f5';\r\n\t\t\tthis._barHeight = style.barHeight || 3;\r\n\t\t}\r\n\t\tget barColor() {\r\n\t\t\treturn this._barColor;\r\n\t\t}\r\n\t\tset barColor(barColor) {\r\n\t\t\tthis._barColor = barColor;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tget barBgColor() {\r\n\t\t\treturn this._barBgColor;\r\n\t\t}\r\n\t\tset barBgColor(barBgColor) {\r\n\t\t\tthis._barBgColor = barBgColor;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tget barHeight() {\r\n\t\t\treturn this._barHeight;\r\n\t\t}\r\n\t\tset barHeight(barHeight) {\r\n\t\t\tthis._barHeight = barHeight;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new PercentCompleteBarStyle(this);\r\n\t\t}\r\n\t}\r\n\tmodule.exports = PercentCompleteBarStyle;\r\n}","'use strict';\r\n{\r\n\tconst BaseStyle = require('./BaseStyle');\r\n\r\n\tlet defaultStyle;\r\n\tclass StdBaseStyle extends BaseStyle {\r\n\t\tstatic get DEFAULT() {\r\n\t\t\treturn defaultStyle ? defaultStyle : (defaultStyle = new StdBaseStyle());\r\n\t\t}\r\n\t\tconstructor(style = {}) {\r\n\t\t\tsuper(style);\r\n\t\t\tthis._textAlign = style.textAlign || 'left';\r\n\t\t\tthis._textBaseline = style.textBaseline || 'middle';\r\n\t\t}\r\n\t\tget textAlign() {\r\n\t\t\treturn this._textAlign;\r\n\t\t}\r\n\t\tset textAlign(textAlign) {\r\n\t\t\tthis._textAlign = textAlign;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tget textBaseline() {\r\n\t\t\treturn this._textBaseline;\r\n\t\t}\r\n\t\tset textBaseline(textBaseline) {\r\n\t\t\tthis._textBaseline = textBaseline;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new StdBaseStyle(this);\r\n\t\t}\r\n\t}\r\n\tmodule.exports = StdBaseStyle;\r\n}","'use strict';\r\n{\r\n\tconst StdBaseStyle = require('./StdBaseStyle');\r\n\tlet defaultStyle;\r\n\tclass Style extends StdBaseStyle {\r\n\t\tstatic get DEFAULT() {\r\n\t\t\treturn defaultStyle ? defaultStyle : (defaultStyle = new Style());\r\n\t\t}\r\n\t\tconstructor(style = {}) {\r\n\t\t\tsuper(style);\r\n\t\t\tthis._color = style.color;\r\n\t\t\tthis._font = style.font;\r\n\t\t\tthis._padding = style.padding;\r\n\t\t}\r\n\t\tget color() {\r\n\t\t\treturn this._color;\r\n\t\t}\r\n\t\tset color(color) {\r\n\t\t\tthis._color = color;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tget font() {\r\n\t\t\treturn this._font;\r\n\t\t}\r\n\t\tset font(font) {\r\n\t\t\tthis._font = font;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tget padding() {\r\n\t\t\treturn this._padding;\r\n\t\t}\r\n\t\tset padding(padding) {\r\n\t\t\tthis._padding = padding;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new Style(this);\r\n\t\t}\r\n\t}\r\n\tmodule.exports = Style;\r\n}","'use strict';\r\n{\r\n\tconst Column = require('./type/Column');\r\n\tconst NumberColumn = require('./type/NumberColumn');\r\n\tconst CheckColumn = require('./type/CheckColumn');\r\n\tconst ButtonColumn = require('./type/ButtonColumn');\r\n\tconst ImageColumn = require('./type/ImageColumn');\r\n\tconst PercentCompleteBarColumn = require('./type/PercentCompleteBarColumn');\r\n\tconst IconColumn = require('./type/IconColumn');\r\n\tconst BranchGraphColumn = require('./type/BranchGraphColumn');\r\n\tconst MenuColumn = require('./type/MenuColumn');\r\n\r\n\t/**\r\n\t * column types\r\n\t * @type {Object}\r\n\t * @namespace cheetahGrid.columns.type\r\n\t * @memberof cheetahGrid.columns\r\n\t */\r\n\tconst type = {\r\n\t\tTYPES: {\r\n\t\t\tDEFAULT: new Column(),\r\n\t\t\tNUMBER: new NumberColumn(),\r\n\t\t\tCHECK: new CheckColumn(),\r\n\t\t\tBUTTON: new ButtonColumn(),\r\n\t\t\tIMAGE: new ImageColumn(),\r\n\t\t},\r\n\t\tget Column() {\r\n\t\t\treturn Column;\r\n\t\t},\r\n\t\tget NumberColumn() {\r\n\t\t\treturn NumberColumn;\r\n\t\t},\r\n\t\tget CheckColumn() {\r\n\t\t\treturn CheckColumn;\r\n\t\t},\r\n\t\tget ButtonColumn() {\r\n\t\t\treturn ButtonColumn;\r\n\t\t},\r\n\t\tget ImageColumn() {\r\n\t\t\treturn ImageColumn;\r\n\t\t},\r\n\t\tget PercentCompleteBarColumn() {\r\n\t\t\treturn PercentCompleteBarColumn;\r\n\t\t},\r\n\t\tget IconColumn() {\r\n\t\t\treturn IconColumn;\r\n\t\t},\r\n\t\tget BranchGraphColumn() {\r\n\t\t\treturn BranchGraphColumn;\r\n\t\t},\r\n\t\tget MenuColumn() {\r\n\t\t\treturn MenuColumn;\r\n\t\t},\r\n\t\tof(columnType) {\r\n\t\t\tif (!columnType) {\r\n\t\t\t\treturn type.TYPES.DEFAULT;\r\n\t\t\t} else if (typeof columnType === 'string') {\r\n\t\t\t\treturn type.TYPES[columnType.toUpperCase()] || type.of(null);\r\n\t\t\t} else {\r\n\t\t\t\treturn columnType;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tmodule.exports = type;\r\n}","'use strict';\r\n{\r\n\tconst styleContents = require('../style');\r\n\tconst {isPromise, isDef, obj: {setReadonly}} = require('../../internal/utils');\r\n\tconst animate = require('../../internal/animate');\r\n\tconst BaseStyle = require('../style/Style');\r\n\tconst {COLUMN_FADEIN_STATE_ID} = require('../../internal/symbolManager');\r\n\r\n\r\n\tfunction isFadeinWhenCallbackInPromise(column, grid) {\r\n\t\tif (isDef(column._fadeinWhenCallbackInPromise)) {\r\n\t\t\treturn column._fadeinWhenCallbackInPromise;\r\n\t\t}\r\n\t\treturn !!grid.configure('fadeinWhenCallbackInPromise');\r\n\t}\r\n\r\n\tfunction getFadinState(grid) {\r\n\t\tif (!grid[COLUMN_FADEIN_STATE_ID]) {\r\n\t\t\tsetReadonly(grid, COLUMN_FADEIN_STATE_ID, {});\r\n\t\t}\r\n\t\treturn grid[COLUMN_FADEIN_STATE_ID];\r\n\t}\r\n\tfunction _generateFadinPointAction(grid, col, row, context, drawInternal, drawCellBase) {\r\n\t\treturn (point) => {\r\n\t\t\tconst state = getFadinState(grid);\r\n\t\t\tconst stateKey = col + ':' + row;\r\n\t\t\tif (point === 1) {\r\n\t\t\t\tdelete state[stateKey];\r\n\t\t\t} else {\r\n\t\t\t\tstate[stateKey] = {\r\n\t\t\t\t\topacity: point,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tdrawCellBase();\r\n\r\n\t\t\tdrawInternal();\r\n\r\n\t\t\tconst cellState = state[stateKey];\r\n\t\t\tif (cellState) {\r\n\t\t\t\t//\r\n\t\t\t\tconst ctx = context.getContext();\r\n\t\t\t\tctx.globalAlpha = 1 - cellState.opacity;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tdrawCellBase();\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tctx.globalAlpha = 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\tconst fadinMgr = {\r\n\t\tanimate(grid, col, row, context, drawInternal, drawCellBase) {\r\n\t\t\t// fadein animation\r\n\t\t\tconst state = getFadinState(grid);\r\n\r\n\t\t\tconst activeFadeins = [\r\n\t\t\t\t_generateFadinPointAction(grid, col, row, context, drawInternal, drawCellBase),\r\n\t\t\t];\r\n\t\t\tstate.activeFadeins = activeFadeins;\r\n\t\t\t\r\n\t\t\tanimate(500, (point) => {\r\n\t\t\t\tactiveFadeins.forEach((f) => f(point));\r\n\t\t\t\tif (point === 1) {\r\n\t\t\t\t\tdelete state.activeFadeins;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tmargeAnimate(grid, col, row, context, drawInternal, drawCellBase) {\r\n\t\t\tconst state = getFadinState(grid);\r\n\t\t\tif (state.activeFadeins) {\r\n\t\t\t\tstate.activeFadeins.push(\r\n\t\t\t\t\t\t_generateFadinPointAction(grid, col, row, context, drawInternal, drawCellBase)\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tdrawInternal();\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t};\r\n\r\n\tclass BaseColumn {\r\n\t\tconstructor(option = {}) {\r\n\t\t\tthis.onDrawCell = this.onDrawCell.bind(this);//\r\n\r\n\t\t\t//Promisecallback\r\n\t\t\tthis._fadeinWhenCallbackInPromise = option.fadeinWhenCallbackInPromise;\r\n\t\t}\r\n\t\tget StyleClass() {\r\n\t\t\treturn BaseStyle;\r\n\t\t}\r\n\t\tonDrawCell(cellValue, info, context, grid) {\r\n\t\t\tconst {style, getRecord, drawCellBase} = info;\r\n\t\t\tdelete info.getRecord;\r\n\t\t\tdelete info.style;\r\n\t\t\tconst helper = grid.getGridCanvasHelper();\r\n\t\t\tdrawCellBase();\r\n\r\n\t\t\t//\r\n\t\t\tif (isPromise(cellValue)) {\r\n\t\t\t\tif (context.drawing) {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t}\r\n\t\t\t\tconst start = Date.now();\r\n\t\t\t\treturn cellValue.then((val) => {\r\n\t\t\t\t\tconst currentContext = context.toCurrentContext();\r\n\t\t\t\t\tconst drawRect = currentContext.getDrawRect();\r\n\t\t\t\t\tif (!drawRect) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst time = Date.now() - start;\r\n\r\n\t\t\t\t\tconst drawInternal = () => {\r\n\t\t\t\t\t\tconst currentContext = context.toCurrentContext();\r\n\t\t\t\t\t\tconst drawRect = currentContext.getDrawRect();\r\n\t\t\t\t\t\tif (!drawRect) {\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst actStyle = styleContents.of(style, getRecord(), this.StyleClass);\r\n\t\t\t\t\t\tthis.drawInternal(\r\n\t\t\t\t\t\t\t\tthis.convertInternal(val),\r\n\t\t\t\t\t\t\t\tcurrentContext,\r\n\t\t\t\t\t\t\t\tactStyle,\r\n\t\t\t\t\t\t\t\thelper,\r\n\t\t\t\t\t\t\t\tgrid,\r\n\t\t\t\t\t\t\t\tinfo\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tthis.drawMessageInternal(\r\n\t\t\t\t\t\t\t\tinfo.getMessage(),\r\n\t\t\t\t\t\t\t\tcontext,\r\n\t\t\t\t\t\t\t\tactStyle,\r\n\t\t\t\t\t\t\t\thelper,\r\n\t\t\t\t\t\t\t\tgrid,\r\n\t\t\t\t\t\t\t\tinfo\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tif (!isFadeinWhenCallbackInPromise(this, grid)) {\r\n\t\t\t\t\t\tdrawInternal();//\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst {col, row} = context;\r\n\t\t\t\t\t\tif (time < 80) {\r\n\t\t\t\t\t\t\t//80msPromiseCallback\r\n\t\t\t\t\t\t\tfadinMgr.margeAnimate(grid, col, row, context, drawInternal, drawCellBase);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\tfadinMgr.animate(grid, col, row, context, drawInternal, drawCellBase);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tconst actStyle = styleContents.of(style, getRecord(), this.StyleClass);\r\n\t\t\t\tthis.drawInternal(\r\n\t\t\t\t\t\tthis.convertInternal(cellValue),\r\n\t\t\t\t\t\tcontext,\r\n\t\t\t\t\t\tactStyle,\r\n\t\t\t\t\t\thelper,\r\n\t\t\t\t\t\tgrid,\r\n\t\t\t\t\t\tinfo\r\n\t\t\t\t);\r\n\t\t\t\tthis.drawMessageInternal(\r\n\t\t\t\t\t\tinfo.getMessage(),\r\n\t\t\t\t\t\tcontext,\r\n\t\t\t\t\t\tactStyle,\r\n\t\t\t\t\t\thelper,\r\n\t\t\t\t\t\tgrid,\r\n\t\t\t\t\t\tinfo\r\n\t\t\t\t);\r\n\t\t\t\t//\r\n\t\t\t\tconst {col, row} = context;\r\n\t\t\t\tconst stateKey = col + ':' + row;\r\n\t\t\t\tconst cellState = grid[COLUMN_FADEIN_STATE_ID] && grid[COLUMN_FADEIN_STATE_ID][stateKey];\r\n\t\t\t\tif (cellState) {\r\n\t\t\t\t\tconst ctx = context.getContext();\r\n\t\t\t\t\tctx.globalAlpha = 1 - cellState.opacity;\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tdrawCellBase();\r\n\t\t\t\t\t} finally {\r\n\t\t\t\t\t\tctx.globalAlpha = 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new BaseColumn(this);\r\n\t\t}\r\n\t\tconvertInternal(value) {\r\n\t\t\treturn isDef(value) ? value : '';\r\n\t\t}\r\n\t\tdrawInternal(value, context, style, helper, grid, info) {\r\n\t\t\t\r\n\t\t}\r\n\t\tdrawMessageInternal(message, context, style, helper, grid, info) {\r\n\t\t\tinfo.messageHandler.drawCellMessage(message, context, style, helper, info);\r\n\t\t}\r\n\t\tbindGridEvent(grid, col, util) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\tmodule.exports = BaseColumn;\r\n}","'use strict';\r\nconst {isDef, getOrApply, isPromise, obj: {isObject}} = require('../../internal/utils');\r\nconst BranchGraphStyle = require('../style/BranchGraphStyle');\r\nconst BaseColumn = require('./BaseColumn');\r\nconst {BRANCH_GRAPH_COLUMN_STATE_ID: _} = require('../../internal/symbolManager');\r\n\r\nfunction getAllColumnData(grid, col, callback) {\r\n\tconst dataSource = grid.dataSource;\r\n\tlet field = grid.getField(col);\r\n\tif (isObject(field) && field.get && field.set) {\r\n\t\tfield = field.get;\r\n\t}\r\n\tconst allData = [];\r\n\tlet promise;\r\n\tfor (let index = 0; index < dataSource.length; index++) {\r\n\t\tconst data = dataSource.getField(index, field);\r\n\t\tif (isPromise(data)) {\r\n\t\t\tconst dataIndex = allData.length;\r\n\t\t\tallData.push(data);\r\n\t\t\tif (!promise) {\r\n\t\t\t\tpromise = data.then((d) => {\r\n\t\t\t\t\tallData[dataIndex] = d;\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tpromise = promise.then(() => data).then((d) => {\r\n\t\t\t\t\tallData[dataIndex] = d;\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tallData.push(data);\r\n\t\t}\r\n\t}\r\n\r\n\tif (promise) {\r\n\t\tpromise.then(() => callback(allData));\r\n\t} else {\r\n\t\tcallback(allData);\r\n\t}\r\n}\r\n\r\nclass BranchLine {\r\n\tconstructor({fromIndex, toIndex, colorIndex, point}) {\r\n\t\tthis.fromIndex = fromIndex;\r\n\t\tthis.toIndex = toIndex;\r\n\t\tthis.colorIndex = colorIndex;\r\n\t\tthis.point = point;\r\n\t}\r\n}\r\nclass BranchPoint {\r\n\tconstructor({index, commit = false, lines = [], tag}) {\r\n\t\tthis.index = index;\r\n\t\tthis.commit = commit;\r\n\t\tthis.lines = lines;\r\n\t\tthis.tag = tag;\r\n\t}\r\n\tstatic mergeLines(lines) {\r\n\t\tconst result = lines.filter(((l) => isDef(l.fromIndex) && isDef(l.toIndex)));\r\n\t\t\r\n\t\tconst froms = lines.filter(((l) => isDef(l.fromIndex) && !isDef(l.toIndex)));\r\n\t\tconst tos = lines.filter(((l) => !isDef(l.fromIndex) && isDef(l.toIndex)));\r\n\r\n\t\tfroms.forEach((f) => {\r\n\t\t\tfor (let i = 0; i < tos.length; i++) {\r\n\t\t\t\tconst t = tos[i];\r\n\t\t\t\tif (t.point) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t\tif (f.colorIndex === t.colorIndex) {\r\n\t\t\t\t\tf.toIndex = t.toIndex;\r\n\t\t\t\t\ttos.splice(i, 1);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tresult.push(f);\r\n\t\t});\r\n\r\n\t\treturn result.concat(tos);\r\n\t}\r\n\tstatic merge(a, b) {\r\n\t\tif (!a) {\r\n\t\t\treturn b;\r\n\t\t}\r\n\t\treturn new BranchPoint({\r\n\t\t\tindex: a.index,\r\n\t\t\tcommit: a.commit || b.commit,\r\n\t\t\tlines: BranchPoint.mergeLines(a.lines.concat(b.lines)),\r\n\t\t\ttag: a.tag || b.tag\r\n\t\t});\r\n\t}\r\n}\r\n\r\nfunction joinLine(timeline, branchIndex) {\r\n\tconst reverse = [...timeline].reverse();\r\n\tfor (let i = 0; i < reverse.length; i++) {\r\n\t\tconst f = reverse[i][branchIndex];\r\n\t\tif (f) {\r\n\t\t\tf.lines = BranchPoint.mergeLines(f.lines.concat([new BranchLine({\r\n\t\t\t\ttoIndex: branchIndex,\r\n\t\t\t\tcolorIndex: branchIndex,\r\n\t\t\t})]));\r\n\r\n\t\t\tfor (let j = 0; j < i; j++) {\r\n\t\t\t\tconst tl = reverse[j];\r\n\t\t\t\ttl[branchIndex] = new BranchPoint({\r\n\t\t\t\t\tindex: branchIndex,\r\n\t\t\t\t\tlines: [new BranchLine({\r\n\t\t\t\t\t\tfromIndex: branchIndex,\r\n\t\t\t\t\t\ttoIndex: branchIndex,\r\n\t\t\t\t\t\tcolorIndex: branchIndex\r\n\t\t\t\t\t})]\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\treturn false;\r\n}\r\n\r\nfunction branch({timeline, branches}, from, to) {\r\n\tconst fromIndex = branches.indexOf(from);\r\n\tlet toIndex = branches.indexOf(to);\r\n\tif (toIndex < 0) {\r\n\t\ttoIndex = branches.length;\r\n\t\tbranches.push(to);\r\n\t}\r\n\t\r\n\tfunction findBranchRootIndex() {\r\n\t\tfor (let index = timeline.length - 1; index >= 0; index--) {\r\n\t\t\tconst tl = timeline[index];\r\n\t\t\tconst from = tl[fromIndex];\r\n\t\t\tif (from && from.commit) {\r\n\t\t\t\treturn index;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n\r\n\tif (fromIndex < 0) {\r\n\t\treturn new BranchPoint({\r\n\t\t\tindex: toIndex,\r\n\t\t});\r\n\t} else {\r\n\t\tconst fromTargetIndex = findBranchRootIndex();\r\n\t\tif (fromTargetIndex === -1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tconst branchTargetFromIndex = fromTargetIndex + 1;\r\n\t\tconst branchPoint = new BranchPoint({\r\n\t\t\tindex: toIndex,\r\n\t\t\tlines: [new BranchLine({\r\n\t\t\t\tfromIndex,\r\n\t\t\t\tcolorIndex: toIndex\r\n\t\t\t})]\r\n\t\t});\r\n\t\tlet point;\r\n\t\tlet result;\r\n\t\tif (branchTargetFromIndex < timeline.length) {\r\n\t\t\tconst targetLine = timeline[branchTargetFromIndex];\r\n\t\t\tpoint = targetLine[toIndex] = BranchPoint.merge(targetLine[toIndex], branchPoint);\r\n\t\t} else {\r\n\t\t\tpoint = branchPoint;\r\n\t\t\tresult = branchPoint;\r\n\t\t}\r\n\t\tconst from = timeline[fromTargetIndex][fromIndex];\r\n\t\tfrom.lines = BranchPoint.mergeLines(from.lines.concat([new BranchLine({\r\n\t\t\ttoIndex,\r\n\t\t\tcolorIndex: toIndex,\r\n\t\t\tpoint,\r\n\t\t})]));\r\n\t\treturn result;\r\n\t}\r\n\t\r\n}\r\n\r\nfunction commit({timeline, branches}, name) {\r\n\tconst index = branches.indexOf(name);\r\n\tif (index < 0) {\r\n\t\treturn null;\r\n\t}\r\n\tconst result = new BranchPoint({\r\n\t\tindex,\r\n\t\tcommit: true,\r\n\t});\r\n\t\t\r\n\tif (joinLine(timeline, index)) {\r\n\t\tresult.lines = BranchPoint.mergeLines(result.lines.concat([new BranchLine({\r\n\t\t\tfromIndex: index,\r\n\t\t\tcolorIndex: index\r\n\t\t})]));\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nfunction commitTag({timeline, branches}, name, tag) {\r\n\tlet index = branches.indexOf(name);\r\n\tif (index < 0) {\r\n\t\tindex = branches.length;\r\n\t\tbranches.push(name);\r\n\t}\r\n\treturn new BranchPoint({\r\n\t\tindex,\r\n\t\ttag\r\n\t});\r\n}\r\n\r\nfunction commitMerge({timeline, branches}, from, to) {\r\n\tconst fromIndex = branches.indexOf(from);\r\n\tconst toIndex = branches.indexOf(to);\r\n\tif (toIndex < 0 || fromIndex < 0) {\r\n\t\treturn new BranchPoint({\r\n\t\t\tindex: toIndex,\r\n\t\t\tcommit: true,\r\n\t\t});\r\n\t}\r\n\tconst result = new BranchPoint({\r\n\t\tindex: toIndex,\r\n\t\tcommit: true,\r\n\t\tlines: [\r\n\t\t\tnew BranchLine({\r\n\t\t\t\tfromIndex,\r\n\t\t\t\tcolorIndex: fromIndex\r\n\t\t\t}),\r\n\t\t\tnew BranchLine({\r\n\t\t\t\tfromIndex: toIndex,\r\n\t\t\t\tcolorIndex: toIndex\r\n\t\t\t})],\r\n\t});\r\n\tconst froms = [...timeline];\r\n\tconst fromTargetLine = froms.pop();\r\n\tif (fromTargetLine) {\r\n\t\tfromTargetLine[fromIndex] = BranchPoint.merge(fromTargetLine[fromIndex], new BranchPoint({\r\n\t\t\tindex: toIndex,\r\n\t\t\tlines: [new BranchLine({\r\n\t\t\t\ttoIndex,\r\n\t\t\t\tcolorIndex: fromIndex\r\n\t\t\t})]\r\n\t\t}));\r\n\t}\r\n\r\n\tjoinLine(froms, fromIndex);\r\n\r\n\tjoinLine(timeline, toIndex);\r\n\r\n\treturn result;\r\n}\r\n\r\nfunction calcCommand(info, command) {\r\n\tconst {timeline} = info;\r\n\tconst timelineData = [];\r\n\t// const last = timeline.length > 0 ? timeline[timeline.length - 1] : null;\r\n\tconst commands = Array.isArray(command) ? command : [command];\r\n\tcommands.forEach((cmd) => {\r\n\t\tif (!cmd) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet point;\r\n\t\tif (cmd.command === 'branch') {\r\n\t\t\tconst from = isObject(cmd.branch) ? cmd.branch.from : null;\r\n\t\t\tconst to = isObject(cmd.branch) ? cmd.branch.to : cmd.branch;\r\n\t\t\tpoint = branch(info, from, to);\r\n\t\t} else if (cmd.command === 'commit') {\r\n\t\t\tconst {branch} = cmd;\r\n\t\t\tpoint = commit(info, branch);\r\n\t\t} else if (cmd.command === 'merge') {\r\n\t\t\tconst {from, to} = cmd.branch;\r\n\t\t\tpoint = commitMerge(info, from, to);\r\n\t\t} else if (cmd.command === 'tag') {\r\n\t\t\tconst {branch, tag} = cmd;\r\n\t\t\tpoint = commitTag(info, branch, tag);\r\n\t\t}\r\n\t\tif (point && point.index > -1) {\r\n\t\t\ttimelineData[point.index] = BranchPoint.merge(timelineData[point.index], point);\r\n\t\t}\r\n\t});\r\n\ttimeline.push(timelineData);\r\n}\r\n\r\nfunction calcBranchesInfo(start, grid, col) {\r\n\tconst result = {\r\n\t\tbranches: [],\r\n\t\ttimeline: []\r\n\t};\r\n\tgetAllColumnData(grid, col, (data) => {\r\n\t\tif (start !== 'top') {\r\n\t\t\tdata = [...data].reverse();\r\n\t\t}\r\n\t\tdata.forEach((command) => {\r\n\t\t\tcalcCommand(result, command);\r\n\t\t});\r\n\r\n\t});\r\n\treturn result;\r\n}\r\n\r\nfunction calcBranchXPoints(ctx, left, width, radius, branches, timeline) {\r\n\tlet w = Math.max(width / branches.length + 1, 5);\r\n\ttimeline.forEach((tl) => {\r\n\t\ttl.forEach((p, index) => {\r\n\t\t\tif (index <= 0) {\r\n\t\t\t\t// \r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (p.tag) {\r\n\t\t\t\tconst textWidth = ctx.measureText(p.tag).width;\r\n\t\t\t\tif (((w * index) + (radius * 2) + 4 + textWidth) > width) {\r\n\t\t\t\t\tw = Math.max((width - (radius * 2) - 4 - textWidth) / index, 5);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\tconst result = [];\r\n\tlet x = left;\r\n\tbranches.forEach(() => {\r\n\t\tresult.push(Math.ceil(x + radius));\r\n\t\tx += w;\r\n\t});\r\n\treturn result;\r\n}\r\n\r\nfunction renderMerge(grid, ctx, x, y, upLineIndex, downLineIndex, colorIndex, {\r\n\tbranchXPoints, margin, branchColors, branchLineWidth, mergeStyle\r\n}, {\r\n\twidth, col, row, branches\r\n}) {\r\n\tif (isDef(upLineIndex) || isDef(downLineIndex)) {\r\n\t\tctx.strokeStyle = getOrApply(branchColors, branches[colorIndex], colorIndex);\r\n\t\tctx.lineWidth = branchLineWidth;\r\n\t\tctx.lineCap = 'round';\r\n\t\tctx.beginPath();\r\n\r\n\r\n\t\tif (isDef(upLineIndex)) {\r\n\t\t\tconst upX = branchXPoints[upLineIndex];\r\n\t\t\tconst upRect = grid.getCellRelativeRect(col, row - 1);\r\n\t\t\tconst upY = upRect.top + upRect.height / 2;\r\n\t\t\tctx.moveTo(upX, upY);\r\n\t\t\tif (mergeStyle === 'bezier') {\r\n\t\t\t\tctx.bezierCurveTo(\r\n\t\t\t\t\t\tupX, (y + upY) / 2,\r\n\t\t\t\t\t\tx, (y + upY) / 2,\r\n\t\t\t\t\t\tx, y\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tctx.lineTo(x, y);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tctx.moveTo(x, y);\r\n\t\t}\r\n\r\n\t\tif (isDef(downLineIndex)) {\r\n\t\t\tconst downX = branchXPoints[downLineIndex];\r\n\t\t\tconst downRect = grid.getCellRelativeRect(col, row + 1);\r\n\t\t\tconst downY = downRect.top + downRect.height / 2;\r\n\t\t\tif (mergeStyle === 'bezier') {\r\n\t\t\t\tctx.bezierCurveTo(\r\n\t\t\t\t\t\tx, (y + downY) / 2,\r\n\t\t\t\t\t\tdownX, (y + downY) / 2,\r\n\t\t\t\t\t\tdownX, downY\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tctx.lineTo(downX, downY);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tctx.stroke();\r\n\t}\r\n}\r\n\r\n/**\r\n * BranchGraphColumn<br>\r\n * <br>\r\n * # Data command<br>\r\n * ## mastar branch or orphan branch<br>\r\n * <pre><code class=\"js\">\r\n * {\r\n * \tcommand: 'branch',\r\n * \tbranch: 'branch name A',\r\n * }\r\n * </code></pre>\r\n * ## commit<br>\r\n * <pre><code class=\"js\">\r\n * {\r\n * \tcommand: 'commit',\r\n * \tbranch: 'branch name A'\r\n * }\r\n * </code></pre>\r\n * ## branch<br>\r\n * <pre><code class=\"js\">\r\n * {\r\n * \tcommand: 'branch',\r\n * \tbranch: {\r\n * \t\tfrom: 'branch name A',\r\n * \t\tto: 'branch name B'\r\n * \t}\r\n * }\r\n * </code></pre>\r\n * ## merge<br>\r\n * <pre><code class=\"js\">\r\n * {\r\n * \tcommand: 'merge',\r\n * \tbranch: {\r\n * \t\tfrom: 'branch name B',\r\n * \t\tto: 'branch name A'\r\n * \t}\r\n * }\r\n * </code></pre>\r\n * ## tag<br>\r\n * <pre><code class=\"js\">\r\n * {\r\n * \tcommand: 'tag',\r\n * \tbranch: 'branch name A',\r\n * \ttag: 'tag name'\r\n * }\r\n * </code></pre>\r\n *\r\n *\r\n * @memberof cheetahGrid.columns.type\r\n */\r\nclass BranchGraphColumn extends BaseColumn {\r\n\tconstructor(option = {}) {\r\n\t\tsuper(option);\r\n\t\tthis._start = option.start || 'bottom';\r\n\t\tthis._cache = isDef(option.cache) ? option.cache : false;\r\n\t}\r\n\tget StyleClass() {\r\n\t\treturn BranchGraphStyle;\r\n\t}\r\n\tclearCache(grid) {\r\n\t\tdelete grid[_];\r\n\t}\r\n\tonDrawCell(cellValue, info, context, grid) {\r\n\t\tif (this._cache) {\r\n\t\t\tconst state = grid[_] || (grid[_] = {});\r\n\t\t\tconst {col} = context;\r\n\t\t\tif (!state[col]) {\r\n\t\t\t\tstate[col] = calcBranchesInfo(this._start, grid, col);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn super.onDrawCell(cellValue, info, context, grid);\r\n\t}\r\n\tclone() {\r\n\t\treturn new BranchGraphColumn(this);\r\n\t}\r\n\tdrawInternal(value, context, style, helper, grid, {drawCellBase}) {\r\n\t\tconst {col, row} = context;\r\n\t\tconst {timeline, branches} = (this._cache && grid[_]) ? grid[_][col] : calcBranchesInfo(this._start, grid, col);\r\n\t\t\r\n\t\tconst {upLineIndexKey, downLineIndexKey} = this._start !== 'top' ? {upLineIndexKey: 'toIndex', downLineIndexKey: 'fromIndex'} : {upLineIndexKey: 'fromIndex', downLineIndexKey: 'toIndex'};\r\n\t\tconst data = this._start !== 'top' ? timeline[timeline.length - (row - grid.frozenRowCount) - 1] : timeline[row - grid.frozenRowCount];\r\n\r\n\t\tconst {\r\n\t\t\tbranchColors,\r\n\t\t\tbranchLineWidth,\r\n\t\t\tcircleSize,\r\n\t\t\tmergeStyle,\r\n\t\t\tmargin,\r\n\t\t\tbgColor,\r\n\t\t} = style;\r\n\t\tif (bgColor) {\r\n\t\t\tdrawCellBase({\r\n\t\t\t\tbgColor,\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tconst rect = context.getRect();\r\n\t\tconst radius = circleSize / 2;\r\n\t\tconst width = rect.width - margin * 2;\r\n\r\n\t\thelper.drawWithClip(context, (ctx) => {\r\n\t\t\tctx.textAlign = 'left';\r\n\t\t\tctx.textBaseline = 'middle';\r\n\t\t\tconst branchXPoints = calcBranchXPoints(ctx, rect.left + margin, width, radius, branches, timeline);\r\n\t\t\t\r\n\t\t\tconst y = rect.top + rect.height / 2;\r\n\r\n\t\t\t// draw join lines\r\n\t\t\tdata.\r\n\t\t\t\tmap((point, index) => point ? point.lines.map((line) => ({\r\n\t\t\t\t\tcolorIndex: line.colorIndex,\r\n\t\t\t\t\tupLineIndex: line[upLineIndexKey],\r\n\t\t\t\t\tdownLineIndex: line[downLineIndexKey],\r\n\t\t\t\t\tpointIndex: index,\r\n\t\t\t\t})) : []).\r\n\t\t\t\treduce((p, c) => p.concat(c), []).// flatMap\r\n\t\t\t\t// order of overlap\r\n\t\t\t\tsort((a, b) => b.colorIndex - a.colorIndex).\r\n\t\t\t\tforEach((line) => {\r\n\t\t\t\t\tconst x = branchXPoints[line.pointIndex];\r\n\t\t\t\t\trenderMerge(grid, ctx, x, y, line.upLineIndex, line.downLineIndex, line.colorIndex, {\r\n\t\t\t\t\t\tmargin,\r\n\t\t\t\t\t\tbranchXPoints,\r\n\t\t\t\t\t\tbranchLineWidth,\r\n\t\t\t\t\t\tbranchColors,\r\n\t\t\t\t\t\tmergeStyle,\r\n\t\t\t\t\t}, {\r\n\t\t\t\t\t\twidth, col, row, branches\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t// draw commit points\r\n\t\t\tdata.forEach((p, index) => {\r\n\t\t\t\tif (p && p.commit) {\r\n\t\t\t\t\tconst x = branchXPoints[index];\r\n\t\t\t\t\tctx.fillStyle = getOrApply(branchColors, branches[index], index);\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tctx.arc(x, y, radius, 0, Math.PI * 2, true);\r\n\t\t\t\t\tctx.fill();\r\n\t\t\t\t\tctx.closePath();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\t// draw tags\r\n\t\t\tdata.forEach((p, index) => {\r\n\t\t\t\tif (p && p.tag) {\r\n\t\t\t\t\tctx.fillStyle = getOrApply(branchColors, branches[index], index);\r\n\t\t\t\t\tctx.fillText(p.tag, branchXPoints[index] + radius + 4, y);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n}\r\nmodule.exports = BranchGraphColumn;","'use strict';\r\n{\r\n\tconst Column = require('./Column');\r\n\tconst ButtonStyle = require('../style/ButtonStyle');\r\n\tconst {BUTTON_COLUMN_STATE_ID} = require('../../internal/symbolManager');\r\n\tconst utils = require('./columnUtils');\r\n\t\r\n\r\n\tclass ButtonColumn extends Column {\r\n\t\tconstructor(option = {}) {\r\n\t\t\tsuper(option);\r\n\t\t\tthis._caption = option.caption;\r\n\t\t}\r\n\t\tget StyleClass() {\r\n\t\t\treturn ButtonStyle;\r\n\t\t}\r\n\t\tget caption() {\r\n\t\t\treturn this._caption;\r\n\t\t}\r\n\t\twithCaption(caption) {\r\n\t\t\tconst c = this.clone();\r\n\t\t\tc._caption = caption;\r\n\t\t\treturn c;\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new ButtonColumn(this);\r\n\t\t}\r\n\t\tconvertInternal(value) {\r\n\t\t\treturn this._caption || value;\r\n\t\t}\r\n\t\tdrawInternal(value, context, style, helper, grid, {drawCellBase, getIcon}) {\r\n\t\t\tconst {textAlign, textBaseline, bgColor, color, buttonBgColor, font, padding} = style;\r\n\t\t\tif (bgColor) {\r\n\t\t\t\tdrawCellBase({\r\n\t\t\t\t\tbgColor,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\thelper.testFontLoad(font, value, context);\r\n\t\t\tconst {col, row} = context;\r\n\t\t\tlet active = false;\r\n\t\t\tconst state = grid[BUTTON_COLUMN_STATE_ID];\r\n\t\t\tif (state) {\r\n\t\t\t\tif (state.mouseActiveCell &&\r\n\t\t\t\t\tstate.mouseActiveCell.col === col &&\r\n\t\t\t\t\tstate.mouseActiveCell.row === row) {\r\n\t\t\t\t\tactive = true;\r\n\t\t\t\t} else if (context.getSelectState().selected) {\r\n\t\t\t\t\tactive = true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tutils.loadIcons(getIcon(), context, helper, (icons, context) => {\r\n\t\t\t\thelper.button(value, context, {\r\n\t\t\t\t\ttextAlign,\r\n\t\t\t\t\ttextBaseline,\r\n\t\t\t\t\tbgColor: buttonBgColor,\r\n\t\t\t\t\tcolor,\r\n\t\t\t\t\tfont,\r\n\t\t\t\t\tpadding,\r\n\t\t\t\t\tshadow: active ? {\r\n\t\t\t\t\t\tcolor: 'rgba(0, 0, 0, 0.48)',\r\n\t\t\t\t\t\tblur: 6,\r\n\t\t\t\t\t\toffsetY: 3,\r\n\t\t\t\t\t} : true,\r\n\t\t\t\t\ticons,\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.exports = ButtonColumn;\r\n}","'use strict';\r\n{\r\n\tconst BaseColumn = require('./BaseColumn');\r\n\tconst CheckStyle = require('../style/CheckStyle');\r\n\tconst {CHECK_COLUMN_STATE_ID} = require('../../internal/symbolManager');\r\n\t\r\n\r\n\tfunction toBoolean(val) {\r\n\t\tif (typeof val === 'string') {\r\n\t\t\tif (val === 'false') {\r\n\t\t\t\treturn false;\r\n\t\t\t} else if (val === 'off') {\r\n\t\t\t\treturn false;\r\n\t\t\t} else if (val.match(/^0+$/)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn val;\r\n\t}\r\n\r\n\tclass CheckColumn extends BaseColumn {\r\n\t\tget StyleClass() {\r\n\t\t\treturn CheckStyle;\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new CheckColumn(this);\r\n\t\t}\r\n\t\tconvertInternal(value) {\r\n\t\t\treturn toBoolean(value);\r\n\t\t}\r\n\t\tdrawInternal(value, context, style, helper, grid, {drawCellBase}) {\r\n\t\t\tconst {\r\n\t\t\t\ttextAlign,\r\n\t\t\t\ttextBaseline,\r\n\t\t\t\tborderColor,\r\n\t\t\t\tcheckBgColor,\r\n\t\t\t\tuncheckBgColor,\r\n\t\t\t\tbgColor,\r\n\t\t\t} = style;\r\n\t\t\tif (bgColor) {\r\n\t\t\t\tdrawCellBase({\r\n\t\t\t\t\tbgColor,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tconst {col, row} = context;\r\n\t\t\tconst key = col + ':' + row;\r\n\t\t\tconst state = grid[CHECK_COLUMN_STATE_ID] && grid[CHECK_COLUMN_STATE_ID][key];\r\n\t\t\t\r\n\t\t\tconst opt = {\r\n\t\t\t\ttextAlign,\r\n\t\t\t\ttextBaseline,\r\n\t\t\t\tborderColor,\r\n\t\t\t\tcheckBgColor,\r\n\t\t\t\tuncheckBgColor,\r\n\t\t\t};\r\n\t\t\tif (state) {\r\n\t\t\t\topt.animElapsedTime = state.elapsed;\r\n\t\t\t}\r\n\t\t\thelper.checkbox(value, context, opt);\r\n\t\t}\r\n\t\tbindGridEvent(grid, col, util) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.exports = CheckColumn;\r\n}","'use strict';\r\n{\r\n\tconst Style = require('../style/Style');\r\n\tconst BaseColumn = require('./BaseColumn');\r\n\tconst utils = require('./columnUtils');\r\n\r\n\tclass Column extends BaseColumn {\r\n\t\tget StyleClass() {\r\n\t\t\treturn Style;\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new Column(this);\r\n\t\t}\r\n\t\tdrawInternal(value, context, style, helper, grid, {drawCellBase, getIcon}) {\r\n\t\t\tconst {\r\n\t\t\t\ttextAlign,\r\n\t\t\t\ttextBaseline,\r\n\t\t\t\tcolor,\r\n\t\t\t\tfont,\r\n\t\t\t\tbgColor,\r\n\t\t\t\tpadding,\r\n\t\t\t} = style;\r\n\t\t\tif (bgColor) {\r\n\t\t\t\tdrawCellBase({\r\n\t\t\t\t\tbgColor,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\thelper.testFontLoad(font, value, context);\r\n\t\t\tutils.loadIcons(getIcon(), context, helper, (icons, context) => {\r\n\t\t\t\thelper.text(value, context, {\r\n\t\t\t\t\ttextAlign,\r\n\t\t\t\t\ttextBaseline,\r\n\t\t\t\t\tcolor,\r\n\t\t\t\t\tfont,\r\n\t\t\t\t\ticons,\r\n\t\t\t\t\tpadding,\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\tmodule.exports = Column;\r\n}","'use strict';\r\n{\r\n\tconst IconStyle = require('../style/IconStyle');\r\n\tconst Column = require('./Column');\r\n\tconst icons = require('../../internal/icons');\r\n\r\n\tfunction repeatArray(val, count) {\r\n\t\tif (count === Infinity) {\r\n\t\t\tcount = 0;\r\n\t\t}\r\n\t\tconst a = [];\r\n\t\tfor (let i = 0; i < count; i++) {\r\n\t\t\ta.push(val);\r\n\t\t}\r\n\t\treturn a;\r\n\t}\r\n\r\n\tclass IconColumn extends Column {\r\n\t\tconstructor(option = {}) {\r\n\t\t\tsuper(option);\r\n\t\t\tthis._tagName = option.tagName || 'i';\r\n\t\t\tthis._className = option.className;\r\n\t\t\tthis._content = option.content;\r\n\t\t\tthis._name = option.name;\r\n\t\t\tthis._iconWidth = option.iconWidth;\r\n\t\t}\r\n\t\tget StyleClass() {\r\n\t\t\treturn IconStyle;\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new IconColumn(this);\r\n\t\t}\r\n\t\tdrawInternal(value, context, style, helper, grid, info) {\r\n\t\t\tconst num = value - 0;\r\n\t\t\tif (!isNaN(num)) {\r\n\t\t\t\tconst icon = {};\r\n\t\t\t\ticons.iconPropKeys.forEach((k) => {\r\n\t\t\t\t\ticon[k] = style[k];\r\n\t\t\t\t});\r\n\t\t\t\ticon.className = this._className;\r\n\t\t\t\ticon.tagName = this._tagName;\r\n\t\t\t\ticon.content = this._content;\r\n\t\t\t\ticon.name = this._name;\r\n\t\t\t\tif (this._iconWidth) {\r\n\t\t\t\t\ticon.width = this._iconWidth;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tinfo.getIcon = () => repeatArray(icon, num);\r\n\t\t\t} else {\r\n\t\t\t\tinfo.getIcon = () => null;\r\n\t\t\t}\r\n\t\t\tsuper.drawInternal('', context, style, helper, grid, info);\r\n\t\t}\r\n\t}\r\n\tmodule.exports = IconColumn;\r\n}","'use strict';\r\n{\r\n\tconst ImageStyle = require('../style/ImageStyle');\r\n\tconst {getCacheOrLoad} = require('../../internal/imgs');\r\n\tconst {calcStartPosition} = require('../../internal/canvases');\r\n\tconst BaseColumn = require('./BaseColumn');\r\n\r\n\tconst MAX_LRU_CACHE_SIZE = 50;\r\n\tfunction getImage(url) {\r\n\t\treturn getCacheOrLoad('ImageColumn', MAX_LRU_CACHE_SIZE, url);\r\n\t}\r\n\r\n\tfunction calcKeepAspectRatioSize(width, height, maxWidth, maxHeight) {\r\n\t\tlet newWidth = width;\r\n\t\tlet newHeight = height;\r\n\t\tif (newWidth > maxWidth) {\r\n\t\t\tnewWidth = maxWidth;\r\n\t\t\tnewHeight = (newWidth * height) / width;\r\n\t\t}\r\n\t\tif (newHeight > maxHeight) {\r\n\t\t\tnewHeight = maxHeight;\r\n\t\t\tnewWidth = (newHeight * width) / height;\r\n\t\t}\r\n\t\treturn {\r\n\t\t\twidth: newWidth,\r\n\t\t\theight: newHeight,\r\n\t\t};\r\n\t}\r\n\r\n\tclass ImageColumn extends BaseColumn {\r\n\t\tget StyleClass() {\r\n\t\t\treturn ImageStyle;\r\n\t\t}\r\n\t\tonDrawCell(cellValue, info, context, grid) {\r\n\t\t\treturn super.onDrawCell(getImage(cellValue), info, context, grid);\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new ImageColumn(this);\r\n\t\t}\r\n\t\tdrawInternal(value, context, style, helper, grid, {drawCellBase}) {\r\n\t\t\tif (value) {\r\n\t\t\t\tconst {\r\n\t\t\t\t\ttextAlign,\r\n\t\t\t\t\ttextBaseline,\r\n\t\t\t\t\tmargin,\r\n\t\t\t\t\tbgColor,\r\n\t\t\t\t} = style;\r\n\t\t\t\tif (bgColor) {\r\n\t\t\t\t\tdrawCellBase({\r\n\t\t\t\t\t\tbgColor,\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\thelper.drawWithClip(context, (ctx) => {\r\n\t\t\t\t\t\r\n\t\t\t\t\tctx.textAlign = textAlign;\r\n\t\t\t\t\tctx.textBaseline = textBaseline;\r\n\t\t\t\t\tconst rect = context.getRect();\r\n\t\t\t\t\tif (style.imageSizing === 'keep-aspect-ratio') {\r\n\t\t\t\t\t\tconst {width, height} = calcKeepAspectRatioSize(\r\n\t\t\t\t\t\t\t\tvalue.width, value.height,\r\n\t\t\t\t\t\t\t\trect.width - margin * 2, rect.height - margin * 2\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tconst pos = calcStartPosition(ctx, rect, width, height, {\r\n\t\t\t\t\t\t\toffset: margin,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tctx.drawImage(value,\r\n\t\t\t\t\t\t\t\t0, 0, value.width, value.height,\r\n\t\t\t\t\t\t\t\tpos.x, pos.y, width, height\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tctx.drawImage(value,\r\n\t\t\t\t\t\t\t\t0, 0, value.width, value.height,\r\n\t\t\t\t\t\t\t\trect.left + margin, rect.top + margin, rect.width - margin * 2, rect.height - margin * 2\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tmodule.exports = ImageColumn;\r\n}","'use strict';\r\n{\r\n\tconst {normalize} = require('../../internal/menu-items');\r\n\tconst {isDef} = require('../../internal/utils');\r\n\tconst BaseColumn = require('./BaseColumn');\r\n\tconst Style = require('../style/Style');\r\n\tconst utils = require('./columnUtils');\r\n\r\n\tclass MenuColumn extends BaseColumn {\r\n\t\tconstructor(option = {}) {\r\n\t\t\tsuper(option);\r\n\t\t\tthis._options = normalize(option.options);\r\n\t\t}\r\n\t\tget StyleClass() {\r\n\t\t\treturn Style;\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new MenuColumn(this);\r\n\t\t}\r\n\t\tget options() {\r\n\t\t\treturn this._options;\r\n\t\t}\r\n\t\twithOptions(options) {\r\n\t\t\tconst c = this.clone();\r\n\t\t\tc._options = normalize(options);\r\n\t\t\treturn c;\r\n\t\t}\r\n\t\tdrawInternal(value, context, style, helper, grid, {drawCellBase, getIcon}) {\r\n\t\t\tconst {\r\n\t\t\t\ttextAlign,\r\n\t\t\t\ttextBaseline,\r\n\t\t\t\tfont,\r\n\t\t\t\tbgColor,\r\n\t\t\t\tpadding,\r\n\t\t\t} = style;\r\n\t\t\tlet {\r\n\t\t\t\tcolor,\r\n\t\t\t} = style;\r\n\t\t\tif (bgColor) {\r\n\t\t\t\tdrawCellBase({\r\n\t\t\t\t\tbgColor,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t\tconst text = this._convertInternal(value);\r\n\t\t\thelper.testFontLoad(font, text, context);\r\n\t\t\tutils.loadIcons(getIcon(), context, helper, (icons, context) => {\r\n\t\t\t\tconst basePadding = helper.toBoxPixelArray(padding || 0, context);\r\n\t\t\t\tconst textPadding = basePadding.slice(0);\r\n\t\t\t\ttextPadding[1] += 26;// icon padding\r\n\t\t\t\tconst iconPadding = basePadding.slice(0);\r\n\t\t\t\ticonPadding[1] += 8;\r\n\t\t\t\tif (!isDef(color) && (!isDef(value) || value === '')) {\r\n\t\t\t\t\tcolor = 'rgba(0, 0, 0, .38)';\r\n\t\t\t\t}\r\n\t\t\t\thelper.text(text, context, {\r\n\t\t\t\t\ttextAlign,\r\n\t\t\t\t\ttextBaseline,\r\n\t\t\t\t\tcolor,\r\n\t\t\t\t\tfont,\r\n\t\t\t\t\ticons,\r\n\t\t\t\t\tpadding: textPadding,\r\n\t\t\t\t});\r\n\t\t\t\t// draw icon\r\n\t\t\t\thelper.text('', context, {\r\n\t\t\t\t\ttextAlign: 'right',\r\n\t\t\t\t\ttextBaseline,\r\n\t\t\t\t\tcolor,\r\n\t\t\t\t\tfont,\r\n\t\t\t\t\ticons: [{\r\n\t\t\t\t\t\tpath: 'M0 2 5 7 10 2z',\r\n\t\t\t\t\t\twidth: 10,\r\n\t\t\t\t\t\tcolor: 'rgba(0, 0, 0, .54)',\r\n\t\t\t\t\t}],\r\n\t\t\t\t\tpadding: iconPadding,\r\n\t\t\t\t});\r\n\r\n\t\t\t});\r\n\t\t}\r\n\t\tconvertInternal(value) {\r\n\t\t\treturn value;\r\n\t\t}\r\n\t\t_convertInternal(value) {\r\n\t\t\tconst options = this._options;\r\n\t\t\tfor (let i = 0; i < options.length; i++) {\r\n\t\t\t\tconst option = options[i];\r\n\t\t\t\tif (option.value === value) {\r\n\t\t\t\t\tvalue = option.caption;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn super.convertInternal(value);\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.exports = MenuColumn;\r\n}","'use strict';\r\n{\r\n\tconst Column = require('./Column');\r\n\tconst NumberStyle = require('../style/NumberStyle');\r\n\tlet defaultFotmat;\r\n\tclass NumberColumn extends Column {\r\n\t\tstatic get defaultFotmat() {\r\n\t\t\treturn defaultFotmat || (defaultFotmat = new Intl.NumberFormat());\r\n\t\t}\r\n\t\tstatic set defaultFotmat(fmt) {\r\n\t\t\tdefaultFotmat = fmt;\r\n\t\t}\r\n\t\tconstructor(option = {}) {\r\n\t\t\tsuper(option);\r\n\t\t\tthis._format = option.format;\r\n\t\t}\r\n\t\tget StyleClass() {\r\n\t\t\treturn NumberStyle;\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new NumberColumn(this);\r\n\t\t}\r\n\t\tget format() {\r\n\t\t\treturn this._format;\r\n\t\t}\r\n\t\twithFormat(format) {\r\n\t\t\tconst c = this.clone();\r\n\t\t\tc._format = format;\r\n\t\t\treturn c;\r\n\t\t}\r\n\t\tconvertInternal(value) {\r\n\t\t\tif (isNaN(value - 0)) {\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\t\t\tconst format = this._format || NumberColumn.defaultFotmat;\r\n\t\t\treturn format.format(value - 0);\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.exports = NumberColumn;\r\n}","'use strict';\r\n{\r\n\tconst PercentCompleteBarStyle = require('../style/PercentCompleteBarStyle');\r\n\tconst {getOrApply, str} = require('../../internal/utils');\r\n\tconst Column = require('./Column');\r\n\t\r\n\r\n\tconst MARGIN = 2;\r\n\r\n\tclass PercentCompleteBarColumn extends Column {\r\n\t\tconstructor(option = {}) {\r\n\t\t\tsuper(option);\r\n\t\t\tthis._min = option.min || 0;\r\n\t\t\tthis._max = option.max || (this._min + 100);\r\n\t\t\tthis._formatter = option.formatter || ((v) => v);\r\n\t\t}\r\n\t\tget StyleClass() {\r\n\t\t\treturn PercentCompleteBarStyle;\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new PercentCompleteBarColumn(this);\r\n\t\t}\r\n\t\tdrawInternal(value, context, style, helper, grid, info) {\r\n\t\t\tsuper.drawInternal(this._formatter(value), context, style, helper, grid, info);\r\n\t\t\tconst {\r\n\t\t\t\tbarColor,\r\n\t\t\t\tbarBgColor,\r\n\t\t\t\tbarHeight,\r\n\t\t\t} = style;\r\n\r\n\t\t\tlet svalue = value + '';\r\n\t\t\tif (str.endsWith(svalue, '%')) {\r\n\t\t\t\tsvalue = svalue.substr(0, svalue.length - 1);\r\n\t\t\t}\r\n\t\t\tconst num = svalue - 0;\r\n\t\t\tconst rate = num < this._min ? 0\r\n\t\t\t\t: num > this._max ? 1\r\n\t\t\t\t: (num - this._min) / (this._max - this._min);\r\n\t\t\t\r\n\t\t\thelper.drawWithClip(context, (ctx) => {\r\n\t\t\t\tconst rect = context.getRect();\r\n\r\n\t\t\t\tconst barMaxWidth = rect.width - MARGIN * 2 - 1/**/;\r\n\t\t\t\tconst barTop = rect.bottom - MARGIN - barHeight - 1/**/;\r\n\t\t\t\tconst barLeft = rect.left + MARGIN;\r\n\t\t\t\tctx.fillStyle = getOrApply(barBgColor, rate * 100) || '#f0f3f5';\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.rect(barLeft, barTop, barMaxWidth, barHeight);\r\n\t\t\t\tctx.fill();\r\n\r\n\r\n\t\t\t\tconst barSize = Math.min(barMaxWidth * rate, barMaxWidth);\r\n\t\t\t\tctx.fillStyle = getOrApply(barColor, rate * 100) || '#20a8d8';\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.rect(barLeft, barTop, barSize, barHeight);\r\n\t\t\t\tctx.fill();\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\tmodule.exports = PercentCompleteBarColumn;\r\n}","'use strict';\r\n{\r\n\tconst {isPromise} = require('../../internal/utils');\r\n\tconst icons = require('../../internal/icons');\r\n\tmodule.exports = {\r\n\t\tloadIcons(icon, context, helper, callback) {\r\n\t\t\tif (icon) {\r\n\t\t\t\tif (isPromise(icon)) {\r\n\t\t\t\t\ticon.then((i) => {\r\n\t\t\t\t\t\tthis.loadIcon(i, context.toCurrentContext(), callback);\r\n\t\t\t\t\t});\r\n\t\t\t\t\ticon = null;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst iconList = icons.toNormarizeArray(icon);\r\n\t\t\t\t\ticonList.forEach((i) => {\r\n\t\t\t\t\t\thelper.testFontLoad(i.font, i.content, context);\r\n\t\t\t\t\t});\r\n\t\t\t\t\ticon = iconList;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tcallback(icon, context);\r\n\t\t},\r\n\t};\r\n}","'use strict';\r\n{\r\n\tconst DrawGrid = require('./core/DrawGrid');\r\n\r\n\t/**\r\n\t * core modules\r\n\t * @type {Object}\r\n\t * @namespace cheetahGrid.core\r\n\t * @memberof cheetahGrid\r\n\t */\r\n\tmodule.exports = {\r\n\t\tDrawGrid\r\n\t};\r\n}","'use strict';\r\n{\r\n\tconst {\r\n\t\tisDef,\r\n\t\tbrowser,\r\n\t\tisDescendantElement,\r\n\t\tarray,\r\n\t\tisPromise,\r\n\t\tevent: {\r\n\t\t\tisTouchEvent,\r\n\t\t\tgetMouseButtons,\r\n\t\t\tgetKeyCode,\r\n\t\t\tcancel: cancelEvent,\r\n\t\t}\r\n\t} = require('../internal/utils');\r\n\t\r\n\tconst EventTarget = require('./EventTarget');\r\n\tconst Rect = require('../internal/Rect');\r\n\tconst Scrollable = require('../internal/Scrollable');\r\n\tconst EventHandler = require('../internal/EventHandler');\r\n\tconst NumberMap = require('../internal/NumberMap');\r\n\tconst style = require('../internal/style');\r\n\tconst calc = require('../internal/calc');\r\n\tconst hiDPI = require('../internal/hiDPI');\r\n\t//protected symbol\r\n\tconst {PROTECTED_SYMBOL: _} = require('../internal/symbolManager');\r\n\r\n\tfunction createRootElement() {\r\n\t\tconst element = document.createElement('div');\r\n\t\telement.classList.add('cheetah-grid');\r\n\t\treturn element;\r\n\t}\r\n\r\n\tconst KEY_END = 35;\r\n\tconst KEY_HOME = 36;\r\n\tconst KEY_LEFT = 37;\r\n\tconst KEY_UP = 38;\r\n\tconst KEY_RIGHT = 39;\r\n\tconst KEY_DOWN = 40;\r\n\tconst KEY_ALPHA_C = 67;\r\n\r\n\tconst EVENT_TYPE = {\r\n\t\tCLICK_CELL: 'click_cell',\r\n\t\tDBLCLICK_CELL: 'dblclick_cell',\r\n\t\tDBLTAP_CELL: 'dbltap_cell',\r\n\t\tMOUSEDOWN_CELL: 'mousedown_cell',\r\n\t\tMOUSEUP_CELL: 'mouseup_cell',\r\n\t\tSELECTED_CELL: 'selected_cell',\r\n\t\tKEYDOWN: 'keydown',\r\n\t\tMOUSEMOVE_CELL: 'mousemove_cell',\r\n\t\tMOUSEENTER_CELL: 'mouseenter_cell',\r\n\t\tMOUSELEAVE_CELL: 'mouseleave_cell',\r\n\t\tMOUSEOVER_CELL: 'mouseover_cell',\r\n\t\tMOUSEOUT_CELL: 'mouseout_cell',\r\n\t\tINPUT_CELL: 'input_cell',\r\n\t\tEDITABLEINPUT_CELL: 'editableinput_cell',\r\n\t\tMODIFY_STATUS_EDITABLEINPUT_CELL: 'modify_status_editableinput_cell',\r\n\t\tRESIZE_COLUMN: 'resize_column',\r\n\t\tSCROLL: 'scroll',\r\n\t};\r\n\r\n\t//private methods\r\n\tfunction _vibrate(e) {\r\n\t\tif (navigator.vibrate && isTouchEvent(e)) {\r\n\t\t\tnavigator.vibrate(50);\r\n\t\t}\r\n\t}\r\n\tfunction _getTargetRowAt(grid, absoluteY) {\r\n\t\tconst internal = grid.getTargetRowAtInternal(absoluteY);\r\n\t\tif (isDef(internal)) {\r\n\t\t\treturn internal;\r\n\t\t}\r\n\t\tconst findBefore = (startRow, startBottom) => {\r\n\t\t\tlet bottom = startBottom;\r\n\t\t\tfor (let row = startRow; row >= 0; row--) {\r\n\t\t\t\tconst height = _getRowHeight(grid, row);\r\n\t\t\t\tconst top = bottom - height;\r\n\t\t\t\tif (top <= absoluteY && absoluteY < bottom) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\ttop,\r\n\t\t\t\t\t\trow,\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\tbottom = top;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t};\r\n\t\tconst findAfter = (startRow, startBottom) => {\r\n\t\t\tlet top = startBottom - _getRowHeight(grid, startRow);\r\n\t\t\tconst {rowCount} = grid[_];\r\n\t\t\tfor (let row = startRow; row < rowCount; row++) {\r\n\t\t\t\tconst height = _getRowHeight(grid, row);\r\n\t\t\t\tconst bottom = top + height;\r\n\t\t\t\tif (top <= absoluteY && absoluteY < bottom) {\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\ttop,\r\n\t\t\t\t\t\trow,\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\t\t\t\ttop = bottom;\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t};\r\n\t\tconst candRow = Math.min(Math.ceil(absoluteY / grid[_].defaultRowHeight), grid.rowCount - 1);\r\n\t\tconst bottom = _getRowsHeight(grid, 0, candRow);\r\n\t\tif (absoluteY >= bottom) {\r\n\t\t\treturn findAfter(candRow, bottom);\r\n\t\t} else {\r\n\t\t\treturn findBefore(candRow, bottom);\r\n\t\t}\r\n\t}\r\n\tfunction _getTargetColAt(grid, absoluteX) {\r\n\t\tlet left = 0;\r\n\t\tconst {colCount} = grid[_];\r\n\t\tfor (let col = 0; col < colCount; col++) {\r\n\t\t\tconst width = _getColWidth(grid, col);\r\n\t\t\tconst right = left + width;\r\n\t\t\tif (right > absoluteX) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tleft,\r\n\t\t\t\t\tcol,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tleft = right;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\tfunction _getTargetFrozenRowAt(grid, absoluteY) {\r\n\t\tif (!grid[_].frozenRowCount) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tlet {top} = grid[_].scroll;\r\n\t\tconst rowCount = grid[_].frozenRowCount;\r\n\t\tfor (let row = 0; row < rowCount; row++) {\r\n\t\t\tconst height = _getRowHeight(grid, row);\r\n\t\t\tconst bottom = top + height;\r\n\t\t\tif (bottom > absoluteY) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\ttop,\r\n\t\t\t\t\trow,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\ttop = bottom;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\tfunction _getTargetFrozenColAt(grid, absoluteX) {\r\n\t\tif (!grid[_].frozenColCount) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tlet {left} = grid[_].scroll;\r\n\t\tconst colCount = grid[_].frozenColCount;\r\n\t\tfor (let col = 0; col < colCount; col++) {\r\n\t\t\tconst width = _getColWidth(grid, col);\r\n\t\t\tconst right = left + width;\r\n\t\t\tif (right > absoluteX) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tleft,\r\n\t\t\t\t\tcol,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tleft = right;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\tfunction _getFrozenRowsRect(grid) {\r\n\t\tif (!grid[_].frozenRowCount) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tconst {top} = grid[_].scroll;\r\n\t\tlet height = 0;\r\n\t\tconst rowCount = grid[_].frozenRowCount;\r\n\t\tfor (let row = 0; row < rowCount; row++) {\r\n\t\t\theight += _getRowHeight(grid, row);\r\n\t\t}\r\n\t\treturn new Rect(\r\n\t\t\t\tgrid[_].scroll.left,\r\n\t\t\t\ttop,\r\n\t\t\t\tgrid[_].canvas.width,\r\n\t\t\t\theight\r\n\t\t);\r\n\t}\r\n\tfunction _getFrozenColsRect(grid) {\r\n\t\tif (!grid[_].frozenColCount) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tconst {left} = grid[_].scroll;\r\n\t\tlet width = 0;\r\n\t\tconst colCount = grid[_].frozenColCount;\r\n\t\tfor (let col = 0; col < colCount; col++) {\r\n\t\t\twidth += _getColWidth(grid, col);\r\n\t\t}\r\n\t\treturn new Rect(\r\n\t\t\t\tleft,\r\n\t\t\t\tgrid[_].scroll.top,\r\n\t\t\t\twidth,\r\n\t\t\t\tgrid[_].canvas.height\r\n\t\t);\r\n\t}\r\n\tfunction _isCellDrawing(grid, col, row) {\r\n\t\tif (!grid[_].drawCells[row]) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn !!grid[_].drawCells[row][col];\r\n\t}\r\n\tfunction _putCellDrawing(grid, col, row, context) {\r\n\t\tif (!grid[_].drawCells[row]) {\r\n\t\t\tgrid[_].drawCells[row] = {};\r\n\t\t}\r\n\t\tgrid[_].drawCells[row][col] = context;\r\n\t}\r\n\tfunction _removeCellDrawing(grid, col, row) {\r\n\t\tif (!grid[_].drawCells[row]) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tdelete grid[_].drawCells[row][col];\r\n\t\tif (Object.keys(grid[_].drawCells[row]).length === 0) {\r\n\t\t\tdelete grid[_].drawCells[row];\r\n\t\t}\r\n\t}\r\n\tfunction _drawCell(grid, ctx, col, absoluteLeft, width, row, absoluteTop, height, visibleRect,\r\n\t\t\tskipAbsoluteTop, skipAbsoluteLeft, drawLayers) {\r\n\t\tconst rect = new Rect(\r\n\t\t\t\tabsoluteLeft - visibleRect.left,\r\n\t\t\t\tabsoluteTop - visibleRect.top,\r\n\t\t\t\twidth,\r\n\t\t\t\theight\r\n\t\t);\r\n\r\n\t\tconst drawRect = Rect.bounds(\r\n\t\t\t\tMath.max(absoluteLeft, skipAbsoluteLeft) - visibleRect.left,\r\n\t\t\t\tMath.max(absoluteTop, skipAbsoluteTop) - visibleRect.top,\r\n\t\t\t\trect.right,\r\n\t\t\t\trect.bottom\r\n\t\t);\r\n\r\n\t\tif (drawRect.height > 0 && drawRect.width > 0) {\r\n\t\t\tctx.save();\r\n\t\t\ttry {\r\n\t\t\t\tconst dcContext = new DrawCellContext(\r\n\t\t\t\t\t\tcol, row,\r\n\t\t\t\t\t\tctx, rect, drawRect,\r\n\t\t\t\t\t\t_isCellDrawing(grid, col, row),\r\n\t\t\t\t\t\tgrid[_].selection,\r\n\t\t\t\t\t\tdrawLayers\r\n\t\t\t\t);\r\n\t\t\t\tconst p = grid.onDrawCell(col, row, dcContext);\r\n\t\t\t\tif (isPromise(p)) {\r\n\t\t\t\t\t//\r\n\t\t\t\t\t_putCellDrawing(grid, col, row, dcContext);\r\n\r\n\t\t\t\t\tconst pCol = col;\r\n\t\t\t\t\tdcContext._delayMode(grid, () => {\r\n\t\t\t\t\t\t_removeCellDrawing(grid, pCol, row);\r\n\t\t\t\t\t});\r\n\t\t\t\t\tp.then(() => {\r\n\t\t\t\t\t\tdcContext.terminate();\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} finally {\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction _drawRow(grid, ctx, initFrozenCol, initCol,\r\n\t\t\tdrawRight, row, absoluteTop, height, visibleRect, skipAbsoluteTop, drawLayers) {\r\n\t\tconst {colCount} = grid[_];\r\n\t\tconst drawOuter = (col, absoluteLeft) => {\r\n\t\t\t//\r\n\t\t\tif (col >= (colCount - 1) && grid[_].canvas.width > (absoluteLeft - visibleRect.left)) {\r\n\t\t\t\tconst outerLeft = absoluteLeft - visibleRect.left;\r\n\t\t\t\tctx.save();\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.fillStyle = grid.underlayBackgroundColor || '#F6F6F6';\r\n\t\t\t\tctx.rect(outerLeft, absoluteTop - visibleRect.top, grid[_].canvas.width - outerLeft, height);\r\n\t\t\t\tctx.fill();\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tlet skipAbsoluteLeft = 0;\r\n\t\tif (initFrozenCol) {\r\n\t\t\tlet absoluteLeft = initFrozenCol.left;\r\n\t\t\tconst count = grid[_].frozenColCount;\r\n\t\t\tfor (let {col} = initFrozenCol; col < count; col++) {\r\n\t\t\t\tconst width = _getColWidth(grid, col);\r\n\r\n\t\t\t\t_drawCell(grid, ctx, col, absoluteLeft, width, row, absoluteTop, height, visibleRect,\r\n\t\t\t\t\t\tskipAbsoluteTop, 0,\r\n\t\t\t\t\t\tdrawLayers);\r\n\t\t\t\t\t\r\n\t\t\t\tabsoluteLeft += width;\r\n\t\t\t\tif (drawRight <= absoluteLeft) { //\r\n\t\t\t\t\tdrawOuter(col, absoluteLeft);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tskipAbsoluteLeft = absoluteLeft;\r\n\t\t}\r\n\r\n\t\tlet absoluteLeft = initCol.left;\r\n\t\tfor (let {col} = initCol; col < colCount; col++) {\r\n\t\t\tconst width = _getColWidth(grid, col);\r\n\t\t\t_drawCell(grid, ctx, col, absoluteLeft, width, row, absoluteTop, height, visibleRect,\r\n\t\t\t\t\tskipAbsoluteTop, skipAbsoluteLeft,\r\n\t\t\t\t\tdrawLayers);\r\n\r\n\t\t\tabsoluteLeft += width;\r\n\t\t\tif (drawRight <= absoluteLeft) { //\r\n\t\t\t\tdrawOuter(col, absoluteLeft);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tdrawOuter(colCount - 1, absoluteLeft);\r\n\r\n\t}\r\n\tfunction _invalidateRect(grid, drawRect) {\r\n\t\tconst visibleRect = _getVisibleRect(grid);\r\n\t\tconst {rowCount} = grid[_];\r\n\t\tconst ctx = grid._getInitContext();\r\n\r\n\t\tconst initRow = _getTargetRowAt(grid, Math.max(visibleRect.top, drawRect.top)) || {\r\n\t\t\ttop: _getRowsHeight(grid, 0, rowCount - 1),\r\n\t\t\trow: rowCount\r\n\t\t};\r\n\t\tconst initCol = _getTargetColAt(grid, Math.max(visibleRect.left, drawRect.left)) || {\r\n\t\t\tleft: _getColsWidth(grid, 0, grid[_].colCount - 1),\r\n\t\t\tcol: grid[_].colCount\r\n\t\t};\r\n\t\tconst drawBottom = Math.min(visibleRect.bottom, drawRect.bottom);\r\n\t\tconst drawRight = Math.min(visibleRect.right, drawRect.right);\r\n\r\n\t\tconst initFrozenRow = _getTargetFrozenRowAt(grid, Math.max(visibleRect.top, drawRect.top));\r\n\t\tconst initFrozenCol = _getTargetFrozenColAt(grid, Math.max(visibleRect.left, drawRect.left));\r\n\r\n\t\tconst drawLayers = new DrawLayers();\r\n\r\n\t\tconst drawOuter = (row, absoluteTop) => {\r\n\t\t\t//\r\n\t\t\tif (row >= (rowCount - 1) && grid[_].canvas.height > (absoluteTop - visibleRect.top)) {\r\n\t\t\t\tconst outerTop = absoluteTop - visibleRect.top;\r\n\t\t\t\tctx.save();\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.fillStyle = grid.underlayBackgroundColor || '#F6F6F6';\r\n\t\t\t\tctx.rect(0, outerTop, grid[_].canvas.width, grid[_].canvas.height - outerTop);\r\n\t\t\t\tctx.fill();\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tlet skipAbsoluteTop = 0;\r\n\t\tif (initFrozenRow) {\r\n\t\t\tlet absoluteTop = initFrozenRow.top;\r\n\t\t\tconst count = grid[_].frozenRowCount;\r\n\t\t\tfor (let {row} = initFrozenRow; row < count; row++) {\r\n\t\t\t\tconst height = _getRowHeight(grid, row);\r\n\t\t\t\t_drawRow(grid,\r\n\t\t\t\t\t\tctx, initFrozenCol, initCol, drawRight,\r\n\t\t\t\t\t\trow, absoluteTop, height, visibleRect, 0,\r\n\t\t\t\t\t\tdrawLayers\r\n\t\t\t\t);\r\n\t\t\t\tabsoluteTop += height;\r\n\t\t\t\tif (drawBottom <= absoluteTop) { //\r\n\t\t\t\t\tdrawOuter(row, absoluteTop);\r\n\t\t\t\t\tdrawLayers.draw(ctx);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tskipAbsoluteTop = absoluteTop;\r\n\t\t}\r\n\r\n\t\tlet absoluteTop = initRow.top;\r\n\t\tfor (let {row} = initRow; row < rowCount; row++) {\r\n\t\t\tconst height = _getRowHeight(grid, row);\r\n\t\t\t\t\r\n\t\t\t//\r\n\t\t\t_drawRow(grid,\r\n\t\t\t\t\tctx, initFrozenCol, initCol, drawRight,\r\n\t\t\t\t\trow, absoluteTop, height, visibleRect, skipAbsoluteTop,\r\n\t\t\t\t\tdrawLayers\r\n\t\t\t);\r\n\r\n\t\t\tabsoluteTop += height;\r\n\t\t\tif (drawBottom <= absoluteTop) { //\r\n\t\t\t\tdrawOuter(row, absoluteTop);\r\n\t\t\t\tdrawLayers.draw(ctx);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\tdrawOuter(rowCount - 1, absoluteTop);\r\n\r\n\t\tdrawLayers.draw(ctx);\r\n\t}\r\n\r\n\tfunction _toPxWidth(grid, width) {\r\n\t\treturn Math.round(calc.toPx(width, grid[_].calcWidthContext));\r\n\t}\r\n\r\n\tfunction _getDefaultColPxWidth(grid) {\r\n\t\treturn _toPxWidth(grid, grid.defaultColWidth);\r\n\t}\r\n\r\n\tfunction _adjustColWidth(grid, col, orgWidth) {\r\n\t\tconst limit = grid[_].colWidthsLimit[col];\r\n\t\tif (!limit) {\r\n\t\t\treturn orgWidth;\r\n\t\t}\r\n\t\t\r\n\t\tif (limit.min) {\r\n\t\t\tconst min = _toPxWidth(grid, limit.min);\r\n\t\t\tif (min > orgWidth) {\r\n\t\t\t\treturn min;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (limit.max) {\r\n\t\t\tconst max = _toPxWidth(grid, limit.max);\r\n\t\t\tif (max < orgWidth) {\r\n\t\t\t\treturn max;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn orgWidth;\r\n\t}\r\n\r\n\tfunction _getColWidth(grid, col) {\r\n\t\tconst width = grid[_].colWidthsMap.get(col);\r\n\t\tif (width) {\r\n\t\t\treturn _adjustColWidth(grid, col, _toPxWidth(grid, width));\r\n\t\t}\r\n\t\treturn _getDefaultColPxWidth(grid);\r\n\t}\r\n\tfunction _setColWidth(grid, col, width) {\r\n\t\tgrid[_].colWidthsMap.put(col, width);\r\n\t}\r\n\tfunction _getColsWidth(grid, startCol, endCol) {\r\n\t\tconst colCount = endCol - startCol + 1;\r\n\t\tlet w = _getDefaultColPxWidth(grid) * colCount;\r\n\t\tgrid[_].colWidthsMap.each(startCol, endCol, (width, col) => {\r\n\t\t\tw += _adjustColWidth(grid, col, _toPxWidth(grid, width)) - _getDefaultColPxWidth(grid);\r\n\t\t});\r\n\t\treturn w;\r\n\t}\r\n\r\n\tfunction _getRowHeight(grid, row) {\r\n\t\tconst internal = grid.getRowHeightInternal(row);\r\n\t\tif (isDef(internal)) {\r\n\t\t\treturn internal;\r\n\t\t}\r\n\t\tconst height = grid[_].rowHeightsMap.get(row);\r\n\t\tif (height) {\r\n\t\t\treturn height;\r\n\t\t}\r\n\t\treturn grid[_].defaultRowHeight;\r\n\t}\r\n\tfunction _setRowHeight(grid, row, height) {\r\n\t\tgrid[_].rowHeightsMap.put(row, height);\r\n\t}\r\n\tfunction _getRowsHeight(grid, startRow, endRow) {\r\n\t\tconst internal = grid.getRowsHeightInternal(startRow, endRow);\r\n\t\tif (isDef(internal)) {\r\n\t\t\treturn internal;\r\n\t\t}\r\n\t\tconst rowCount = endRow - startRow + 1;\r\n\t\tlet h = grid[_].defaultRowHeight * rowCount;\r\n\t\tgrid[_].rowHeightsMap.each(startRow, endRow, (height) => {\r\n\t\t\th += height - grid[_].defaultRowHeight;\r\n\t\t});\r\n\t\treturn h;\r\n\t}\r\n\r\n\tfunction _getScrollWidth(grid) {\r\n\t\tlet w = _getDefaultColPxWidth(grid) * grid[_].colCount;\r\n\t\tgrid[_].colWidthsMap.eachAll((width, col) => {\r\n\t\t\tw += _adjustColWidth(grid, col, _toPxWidth(grid, width)) - _getDefaultColPxWidth(grid);\r\n\t\t});\r\n\t\treturn w;\r\n\t}\r\n\tfunction _getScrollHeight(grid, row) {\r\n\t\tconst internal = grid.getScrollHeightInternal(row);\r\n\t\tif (isDef(internal)) {\r\n\t\t\treturn internal;\r\n\t\t}\r\n\t\tlet h = grid[_].defaultRowHeight * grid[_].rowCount;\r\n\t\tgrid[_].rowHeightsMap.eachAll((height) => {\r\n\t\t\th += height - grid[_].defaultRowHeight;\r\n\t\t});\r\n\t\treturn h;\r\n\t}\r\n\tfunction _onScroll(grid, e) {\r\n\t\tconst lastLeft = grid[_].scroll.left;\r\n\t\tconst lastTop = grid[_].scroll.top;\r\n\t\tconst moveX = grid[_].scrollable.scrollLeft - lastLeft;\r\n\t\tconst moveY = grid[_].scrollable.scrollTop - lastTop;\r\n\r\n\t\t//\r\n\t\tgrid[_].scroll = {\r\n\t\t\tleft: grid[_].scrollable.scrollLeft,\r\n\t\t\ttop: grid[_].scrollable.scrollTop,\r\n\t\t};\r\n\t\tconst visibleRect = _getVisibleRect(grid);\r\n\t\tif ((Math.abs(moveX) >= visibleRect.width) || (Math.abs(moveY) >= visibleRect.height)) {\r\n\t\t\t//\r\n\t\t\t_invalidateRect(grid, visibleRect);\r\n\t\t} else {\r\n\t\t\t//\r\n\t\t\tgrid[_].context.drawImage(grid[_].canvas, -moveX, -moveY);\r\n\r\n\t\t\t\t\r\n\t\t\tif (moveX !== 0) {\r\n\t\t\t\t//\r\n\t\t\t\tconst redrawRect = visibleRect.copy();\r\n\t\t\t\tif (moveX < 0) {\r\n\t\t\t\t\tredrawRect.width = -moveX;\r\n\t\t\t\t\tif (grid[_].frozenColCount > 0) {\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t\tconst frozenRect = _getFrozenColsRect(grid);\r\n\t\t\t\t\t\tredrawRect.width += frozenRect.width;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (moveX > 0) {\r\n\t\t\t\t\tredrawRect.left = redrawRect.right - moveX;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\t\t\t\t_invalidateRect(grid, redrawRect);\r\n\r\n\t\t\t\tif (moveX > 0) {\r\n\t\t\t\t\tif (grid[_].frozenColCount > 0) {\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t\t_invalidateRect(grid, _getFrozenColsRect(grid));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (moveY !== 0) {\r\n\t\t\t\t//\r\n\t\t\t\tconst redrawRect = visibleRect.copy();\r\n\t\t\t\tif (moveY < 0) {\r\n\t\t\t\t\tredrawRect.height = -moveY;\r\n\t\t\t\t\tif (grid[_].frozenRowCount > 0) {\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t\tconst frozenRect = _getFrozenRowsRect(grid);\r\n\t\t\t\t\t\tredrawRect.height += frozenRect.height;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (moveY > 0) {\r\n\t\t\t\t\tredrawRect.top = redrawRect.bottom - moveY;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t//\r\n\t\t\t\t_invalidateRect(grid, redrawRect);\r\n\r\n\t\t\t\tif (moveY > 0) {\r\n\t\t\t\t\tif (grid[_].frozenRowCount > 0) {\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t\t_invalidateRect(grid, _getFrozenRowsRect(grid));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction _onKeyDownMove(grid, e) {\r\n\t\tconst {shiftKey} = e;\r\n\t\tconst keyCode = getKeyCode(e);\r\n\t\tconst focusCell = shiftKey ? grid.selection._focus : grid.selection._sel;\r\n\t\tif (keyCode === KEY_LEFT) {\r\n\t\t\tconst col = grid.getMoveLeftColByKeyDownInternal(focusCell);\r\n\t\t\tif (col < 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_moveFocusCell(grid, col, focusCell.row, shiftKey);\r\n\t\t\tcancelEvent(e);\r\n\t\t} else if (keyCode === KEY_UP) {\r\n\t\t\tconst row = grid.getMoveUpRowByKeyDownInternal(focusCell);\r\n\t\t\tif (row < 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_moveFocusCell(grid, focusCell.col, row, shiftKey);\r\n\t\t\tcancelEvent(e);\r\n\t\t} else if (keyCode === KEY_RIGHT) {\r\n\t\t\tconst col = grid.getMoveRightColByKeyDownInternal(focusCell);\r\n\t\t\tif (grid.colCount <= col) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_moveFocusCell(grid, col, focusCell.row, shiftKey);\r\n\t\t\tcancelEvent(e);\r\n\t\t} else if (keyCode === KEY_DOWN) {\r\n\t\t\tconst row = grid.getMoveDownRowByKeyDownInternal(focusCell);\r\n\t\t\tif (grid.rowCount <= row) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_moveFocusCell(grid, focusCell.col, row, shiftKey);\r\n\t\t\tcancelEvent(e);\r\n\t\t} else if (keyCode === KEY_HOME) {\r\n\t\t\tconst row = e.ctrlKey ? 0 : focusCell.row;\r\n\t\t\t_moveFocusCell(grid, 0, row, e.shiftKey);\r\n\t\t\tcancelEvent(e);\r\n\t\t} else if (keyCode === KEY_END) {\r\n\t\t\tconst row = e.ctrlKey ? grid.rowCount - 1 : focusCell.row;\r\n\t\t\t_moveFocusCell(grid, grid.colCount - 1, row, shiftKey);\r\n\t\t\tcancelEvent(e);\r\n\t\t}\r\n\t}\r\n\tfunction _moveFocusCell(grid, col, row, shiftKey) {\r\n\t\tconst offset = grid.getOffsetInvalidateCells();\r\n\r\n\t\tfunction extendRange(range) {\r\n\t\t\tif (offset > 0) {\r\n\t\t\t\trange.start.col -= offset;\r\n\t\t\t\trange.start.row -= offset;\r\n\t\t\t\trange.end.col += offset;\r\n\t\t\t\trange.end.row += offset;\r\n\t\t\t}\r\n\t\t\treturn range;\r\n\t\t}\r\n\r\n\t\tconst beforeRange = extendRange(grid.selection.range);\r\n\t\tconst beforeRect = grid.getCellsRect(\r\n\t\t\t\tbeforeRange.start.col, beforeRange.start.row,\r\n\t\t\t\tbeforeRange.end.col, beforeRange.end.row\r\n\t\t);\r\n\r\n\t\tgrid.selection._setFocusCell(col, row, shiftKey);\r\n\t\tgrid.makeVisibleCell(col, row);\r\n\t\tgrid.focusCell(col, row);\r\n\t\t\t\r\n\t\tconst afterRange = extendRange(grid.selection.range);\r\n\t\tconst afterRect = grid.getCellsRect(\r\n\t\t\t\tafterRange.start.col, afterRange.start.row,\r\n\t\t\t\tafterRange.end.col, afterRange.end.row\r\n\t\t);\r\n\r\n\t\tif (afterRect.intersection(beforeRect)) {\r\n\t\t\tconst invalidateRect = Rect.max(afterRect, beforeRect);\r\n\t\t\t_invalidateRect(grid, invalidateRect);\r\n\t\t} else {\r\n\t\t\t_invalidateRect(grid, beforeRect);\r\n\t\t\t_invalidateRect(grid, afterRect);\r\n\t\t}\r\n\t}\r\n\tfunction _getMouseAbstractPoint(grid, e) {\r\n\t\tif (isTouchEvent(e)) {\r\n\t\t\te = e.changedTouches[0];\r\n\t\t}\r\n\t\tconst clientX = e.clientX || (e.pageX + window.scrollX);\r\n\t\tconst clientY = e.clientY || (e.pageY + window.scrollY);\r\n\t\tconst rect = grid[_].canvas.getBoundingClientRect();\r\n\t\tif (rect.right <= clientX) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (rect.bottom <= clientY) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tconst x = clientX - rect.left + grid[_].scroll.left;\r\n\t\tconst y = clientY - rect.top + grid[_].scroll.top;\r\n\t\treturn {x, y};\r\n\t}\r\n\r\n\tfunction _bindEvents(grid) {\r\n\t\tconst getCellEventArgsSet = (e) => {\r\n\t\t\tconst abstractPos = _getMouseAbstractPoint(grid, e);\r\n\t\t\tif (!abstractPos) {\r\n\t\t\t\treturn {};\r\n\t\t\t}\r\n\t\t\tconst cell = grid.getCellAt(abstractPos.x, abstractPos.y);\r\n\t\t\tif (cell.col < 0 || cell.row < 0) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tabstractPos,\r\n\t\t\t\t\tcell\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\tconst eventArgs = {\r\n\t\t\t\tcol: cell.col,\r\n\t\t\t\trow: cell.row,\r\n\t\t\t\tevent: e,\r\n\t\t\t};\r\n\t\t\treturn {\r\n\t\t\t\tabstractPos,\r\n\t\t\t\tcell,\r\n\t\t\t\teventArgs\r\n\t\t\t};\r\n\t\t};\r\n\t\tconst canResizeColumn = (col) => {\r\n\t\t\tconst limit = grid[_].colWidthsLimit[col];\r\n\t\t\tif (!limit || !limit.min || !limit.max) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\treturn limit.max !== limit.min;\r\n\t\t};\r\n\t\tgrid[_].handler.on(grid[_].element, 'mousedown', (e) => {\r\n\t\t\tconst eventArgsSet = getCellEventArgsSet(e);\r\n\t\t\tconst {abstractPos, eventArgs} = eventArgsSet;\r\n\t\t\tif (!abstractPos) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (eventArgs) {\r\n\t\t\t\tconst results = grid.fireListeners(EVENT_TYPE.MOUSEDOWN_CELL, eventArgs);\r\n\t\t\t\tif (array.findIndex(results, (v) => !v) >= 0) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (getMouseButtons(e) !== 1) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst resizeCol = _getResizeColAt(grid, abstractPos.x, abstractPos.y);\r\n\t\t\tif (resizeCol >= 0 && canResizeColumn(resizeCol)) {\r\n\t\t\t\t//\r\n\t\t\t\tgrid[_].columnResizer.start(resizeCol, e);\r\n\t\t\t} else {\r\n\t\t\t\t//\r\n\t\t\t\tgrid[_].cellSelector.start(e);\r\n\t\t\t}\r\n\t\t});\r\n\t\tlet doubleTapBefore = null;\r\n\t\tlet longTouchId = null;\r\n\t\tgrid[_].handler.on(grid[_].element, 'touchstart', (e) => {\r\n\t\t\r\n\t\t\tif (!doubleTapBefore) {\r\n\t\t\t\tdoubleTapBefore = getCellEventArgsSet(e).eventArgs;\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tdoubleTapBefore = null;\r\n\t\t\t\t}, 350);\r\n\t\t\t} else {\r\n\t\t\t\tconst {eventArgs} = getCellEventArgsSet(e);\r\n\t\t\t\tif (eventArgs &&\r\n\t\t\t\t\teventArgs.col === doubleTapBefore.col &&\r\n\t\t\t\t\teventArgs.row === doubleTapBefore.row) {\r\n\t\t\t\t\tgrid.fireListeners(EVENT_TYPE.DBLTAP_CELL, eventArgs);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tdoubleTapBefore = null;\r\n\r\n\t\t\t\tif (e.defaultPrevented) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tlongTouchId = setTimeout(() => {\r\n\t\t\t\t//\r\n\t\t\t\tlongTouchId = null;\r\n\t\t\t\tconst abstractPos = _getMouseAbstractPoint(grid, e);\r\n\t\t\t\tif (!abstractPos) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst resizeCol = _getResizeColAt(grid, abstractPos.x, abstractPos.y, 15);\r\n\t\t\t\tif (resizeCol >= 0 && canResizeColumn(resizeCol)) {\r\n\t\t\t\t\t//\r\n\t\t\t\t\tgrid[_].columnResizer.start(resizeCol, e);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t//\r\n\t\t\t\t\tgrid[_].cellSelector.start(e);\r\n\t\t\t\t}\r\n\t\t\t}, 500);\r\n\t\t});\r\n\r\n\t\tfunction cancel(e) {\r\n\t\t\tif (longTouchId) {\r\n\t\t\t\tclearTimeout(longTouchId);\r\n\t\t\t\tlongTouchId = null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tgrid[_].handler.on(grid[_].element, 'touchcancel', cancel);\r\n\t\tgrid[_].handler.on(grid[_].element, 'touchmove', cancel);\r\n\t\tgrid[_].handler.on(grid[_].element, 'touchend', (e) => {\r\n\t\t\tif (longTouchId) {\r\n\t\t\t\tclearTimeout(longTouchId);\r\n\t\t\t\tgrid[_].cellSelector.select(e);\r\n\t\t\t\tlongTouchId = null;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tlet isMouseover = false;\r\n\t\tlet mouseEnterCell = null;\r\n\t\tlet mouseOverCell = null;\r\n\t\tfunction onMouseenterCell(cell) {\r\n\t\t\tgrid.fireListeners(EVENT_TYPE.MOUSEENTER_CELL, cell);\r\n\t\t\tmouseEnterCell = cell;\r\n\t\t}\r\n\t\tfunction onMouseleaveCell() {\r\n\t\t\tconst beforeMouseCell = mouseEnterCell;\r\n\t\t\tmouseEnterCell = null;\r\n\t\t\tif (beforeMouseCell) {\r\n\t\t\t\tgrid.fireListeners(EVENT_TYPE.MOUSELEAVE_CELL, {\r\n\t\t\t\t\tcol: beforeMouseCell.col,\r\n\t\t\t\t\trow: beforeMouseCell.row,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tfunction onMouseoverCell(cell) {\r\n\t\t\tgrid.fireListeners(EVENT_TYPE.MOUSEOVER_CELL, cell);\r\n\t\t\tmouseOverCell = cell;\r\n\t\t}\r\n\t\tfunction onMouseoutCell() {\r\n\t\t\tconst beforeMouseCell = mouseOverCell;\r\n\t\t\tmouseOverCell = null;\r\n\t\t\tif (beforeMouseCell) {\r\n\t\t\t\tgrid.fireListeners(EVENT_TYPE.MOUSEOUT_CELL, {\r\n\t\t\t\t\tcol: beforeMouseCell.col,\r\n\t\t\t\t\trow: beforeMouseCell.row,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst scrollElement = grid[_].scrollable.getElement();\r\n\t\tgrid[_].handler.on(scrollElement, 'mouseover', (e) => {\r\n\t\t\tisMouseover = true;\r\n\t\t});\r\n\t\tgrid[_].handler.on(scrollElement, 'mouseout', (e) => {\r\n\t\t\tisMouseover = false;\r\n\t\t\tonMouseoutCell();\r\n\t\t});\r\n\r\n\t\tgrid[_].handler.on(grid[_].element, 'mouseleave', (e) => {\r\n\t\t\tonMouseleaveCell();\r\n\t\t});\r\n\t\t\t\r\n\t\tgrid[_].handler.on(grid[_].element, 'mousemove', (e) => {\r\n\t\t\tconst eventArgsSet = getCellEventArgsSet(e);\r\n\t\t\tconst {abstractPos, eventArgs} = eventArgsSet;\r\n\t\t\tif (eventArgs) {\r\n\t\t\t\tconst beforeMouseCell = mouseEnterCell;\r\n\t\t\t\tif (beforeMouseCell) {\r\n\t\t\t\t\tgrid.fireListeners(EVENT_TYPE.MOUSEMOVE_CELL, eventArgs);\r\n\t\t\t\t\tif (beforeMouseCell.col !== eventArgs.col || beforeMouseCell.row !== eventArgs.row) {\r\n\t\t\t\t\t\tonMouseoutCell();\r\n\t\t\t\t\t\tonMouseleaveCell();\r\n\t\t\t\t\t\tconst cell = {\r\n\t\t\t\t\t\t\tcol: eventArgs.col,\r\n\t\t\t\t\t\t\trow: eventArgs.row,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tonMouseenterCell(cell);\r\n\t\t\t\t\t\tif (isMouseover) {\r\n\t\t\t\t\t\t\tonMouseoverCell(cell);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (isMouseover && !mouseOverCell) {\r\n\t\t\t\t\t\tonMouseoverCell({\r\n\t\t\t\t\t\t\tcol: eventArgs.col,\r\n\t\t\t\t\t\t\trow: eventArgs.row,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst cell = {\r\n\t\t\t\t\t\tcol: eventArgs.col,\r\n\t\t\t\t\t\trow: eventArgs.row,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tonMouseenterCell(cell);\r\n\t\t\t\t\tif (isMouseover) {\r\n\t\t\t\t\t\tonMouseoverCell(cell);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgrid.fireListeners(EVENT_TYPE.MOUSEMOVE_CELL, eventArgs);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tonMouseoutCell();\r\n\t\t\t\tonMouseleaveCell();\r\n\t\t\t}\r\n\t\t\tif (grid[_].columnResizer.moving(e) || grid[_].cellSelector.moving(e)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst {style} = grid[_].element;\r\n\t\t\tif (!abstractPos) {\r\n\t\t\t\tif (style.cursor === 'col-resize') {\r\n\t\t\t\t\tstyle.cursor = '';\r\n\t\t\t\t}\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst resizeCol = _getResizeColAt(grid, abstractPos.x, abstractPos.y);\r\n\t\t\tif (resizeCol >= 0 && canResizeColumn(resizeCol)) {\r\n\t\t\t\tstyle.cursor = 'col-resize';\r\n\t\t\t} else {\r\n\t\t\t\tif (style.cursor === 'col-resize') {\r\n\t\t\t\t\tstyle.cursor = '';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tgrid[_].handler.on(grid[_].element, 'click', (e) => {\r\n\t\t\tif (grid[_].columnResizer.lastMoving(e) || grid[_].cellSelector.lastMoving(e)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!grid.hasListeners(EVENT_TYPE.CLICK_CELL)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst {eventArgs} = getCellEventArgsSet(e);\r\n\t\t\tif (!eventArgs) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tgrid.fireListeners(EVENT_TYPE.CLICK_CELL, eventArgs);\r\n\t\t});\r\n\t\tgrid[_].handler.on(grid[_].element, 'dblclick', (e) => {\r\n\t\t\tif (!grid.hasListeners(EVENT_TYPE.DBLCLICK_CELL)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst {eventArgs} = getCellEventArgsSet(e);\r\n\t\t\tif (!eventArgs) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tgrid.fireListeners(EVENT_TYPE.DBLCLICK_CELL, eventArgs);\r\n\t\t});\r\n\t\tgrid[_].focusControl.listen('keydown', (keyCode, e) => {\r\n\t\t\tgrid.fireListeners(EVENT_TYPE.KEYDOWN, keyCode, e);\r\n\t\t});\r\n\t\tgrid[_].selection.listen(EVENT_TYPE.SELECTED_CELL, (data) => {\r\n\t\t\tgrid.fireListeners(EVENT_TYPE.SELECTED_CELL, data, data.selected);\r\n\t\t});\r\n\r\n\t\tgrid[_].scrollable.onScroll((e) => {\r\n\t\t\t_onScroll(grid, e);\r\n\t\t\tgrid.fireListeners(EVENT_TYPE.SCROLL, {event: e});\r\n\t\t});\r\n\t\tgrid[_].focusControl.onKeyDownMove((e) => {\r\n\t\t\t_onKeyDownMove(grid, e);\r\n\t\t});\r\n\t\tgrid.listen('copydata', (range) => {\r\n\t\t\tlet copyValue = '';\r\n\t\t\tfor (let {row} = range.start; row <= range.end.row; row++) {\r\n\t\t\t\tfor (let {col} = range.start; col <= range.end.col; col++) {\r\n\t\t\t\t\tconst copyCellValue = grid.getCopyCellValue(col, row);\r\n\t\t\t\t\tif (window.Promise && copyCellValue instanceof window.Promise) {\r\n\t\t\t\t\t\t//\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconst strCellValue = '' + copyCellValue;\r\n\t\t\t\t\t\tif (strCellValue.match(/^\\[object .*\\]$/)) {\r\n\t\t\t\t\t\t\t//object \r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcopyValue += strCellValue;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\tif (col < range.end.col) {\r\n\t\t\t\t\t\tcopyValue += '\\t';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tcopyValue += '\\n';\r\n\t\t\t}\r\n\t\t\treturn copyValue;\r\n\t\t});\r\n\t\tgrid[_].focusControl.onCopy((e) => array.find(grid.fireListeners('copydata', grid[_].selection.range), isDef));\r\n\t\tgrid[_].focusControl.onInput((value) => {\r\n\t\t\tconst {col, row} = grid[_].selection.select;\r\n\t\t\tgrid.fireListeners(EVENT_TYPE.INPUT_CELL, {col, row, value});\r\n\t\t});\r\n\t\tgrid.bindEventsInternal();\r\n\t}\r\n\r\n\tfunction _getResizeColAt(grid, abstractX, abstractY, offset = 5) {\r\n\t\tif (grid[_].frozenRowCount <= 0) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tconst frozenRect = _getFrozenRowsRect(grid);\r\n\t\tif (!frozenRect.inPoint(abstractX, abstractY)) {\r\n\t\t\treturn -1;\r\n\t\t}\r\n\t\tconst cell = grid.getCellAt(abstractX, abstractY);\r\n\t\tconst cellRect = grid.getCellRect(cell.col, cell.row);\r\n\t\tif (abstractX < cellRect.left + offset) {\r\n\t\t\treturn cell.col - 1;\r\n\t\t}\r\n\t\tif (cellRect.right - offset < abstractX) {\r\n\t\t\treturn cell.col;\r\n\t\t}\r\n\t\treturn -1;\r\n\t}\r\n\tfunction _getVisibleRect(grid) {\r\n\t\treturn new Rect(\r\n\t\t\t\tgrid[_].scroll.left,\r\n\t\t\t\tgrid[_].scroll.top,\r\n\t\t\t\tgrid[_].canvas.width,\r\n\t\t\t\tgrid[_].canvas.height\r\n\t\t);\r\n\t}\r\n\tfunction _getScrollableVisibleRect(grid) {\r\n\t\tlet frozenColsWidth = 0;\r\n\t\tif (grid[_].frozenColCount > 0) {\r\n\t\t\t//\r\n\t\t\tconst frozenRect = _getFrozenColsRect(grid);\r\n\t\t\tfrozenColsWidth = frozenRect.width;\r\n\t\t}\r\n\t\tlet frozenRowsHeight = 0;\r\n\t\tif (grid[_].frozenRowCount > 0) {\r\n\t\t\t//\r\n\t\t\tconst frozenRect = _getFrozenRowsRect(grid);\r\n\t\t\tfrozenRowsHeight = frozenRect.height;\r\n\t\t}\r\n\t\treturn new Rect(\r\n\t\t\t\tgrid[_].scroll.left + frozenColsWidth,\r\n\t\t\t\tgrid[_].scroll.top + frozenRowsHeight,\r\n\t\t\t\tgrid[_].canvas.width - frozenColsWidth,\r\n\t\t\t\tgrid[_].canvas.height - frozenRowsHeight\r\n\t\t);\r\n\t}\r\n\r\n\tfunction _toRelativeRect(grid, absoluteRect) {\r\n\t\tconst rect = absoluteRect.copy();\r\n\t\tconst visibleRect = _getVisibleRect(grid);\r\n\t\trect.offsetLeft(-visibleRect.left);\r\n\t\trect.offsetTop(-visibleRect.top);\r\n\r\n\t\treturn rect;\r\n\t}\r\n\t//end private methods\r\n\t//\r\n\t//\r\n\t//\r\n\t//\r\n\r\n\t/**\r\n\t * managing mouse down moving\r\n\t * @private\r\n\t */\r\n\tclass BaseMouseDownMover {\r\n\t\tconstructor(grid) {\r\n\t\t\tthis._grid = grid;\r\n\t\t\tthis._handler = new EventHandler();\r\n\t\t\tthis._events = {};\r\n\t\t\tthis._started = false;\r\n\t\t\tthis._moved = false;\r\n\t\t}\r\n\t\tmoving(e) {\r\n\t\t\treturn !!this._started;\r\n\t\t}\r\n\t\tlastMoving(e) {\r\n\t\t\t// mouseupclick\r\n\t\t\tif (this.moving(e)) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tconst last = this._mouseEndPoint;\r\n\t\t\tif (!last) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tconst pt = _getMouseAbstractPoint(this._grid, e);\r\n\t\t\treturn pt.x === last.x && pt.y === last.y;\r\n\t\t}\r\n\t\t_bindMoveAndUp(e) {\r\n\t\t\tif (!isTouchEvent(e)) {\r\n\t\t\t\tthis._events.mousemove = this._handler.on(document.body, 'mousemove', (e) => this._mouseMove(e));\r\n\t\t\t\tthis._events.mouseup = this._handler.on(document.body, 'mouseup', (e) => this._mouseUp(e));\r\n\t\t\t} else {\r\n\t\t\t\tthis._events.touchmove = this._handler.on(document.body, 'touchmove', (e) => this._mouseMove(e), {passive: false});\r\n\t\t\t\tthis._events.touchend = this._handler.on(document.body, 'touchend', (e) => this._mouseUp(e));\r\n\t\t\t\tthis._events.touchcancel = this._handler.on(document.body, 'touchcancel', (e) => this._mouseUp(e));\r\n\t\t\t}\r\n\t\t\tthis._started = true;\r\n\t\t\tthis._moved = false;\r\n\t\t}\r\n\t\t_mouseMove(e) {\r\n\t\t\tif (!isTouchEvent(e)) {\r\n\t\t\t\tif (getMouseButtons(e) !== 1) {\r\n\t\t\t\t\tthis._mouseUp(e);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tthis._moved = this._moveInternal(e) || this._moved/*calculation on after*/;\r\n\r\n\t\t\tcancelEvent(e);\r\n\t\t}\r\n\t\t_moveInternal(e) {\r\n\t\t\t//protected\r\n\t\t}\r\n\t\t_mouseUp(e) {\r\n\t\t\tthis._handler.off(this._events.mousemove);\r\n\t\t\tthis._handler.off(this._events.touchmove);\r\n\t\t\tthis._handler.off(this._events.mouseup);\r\n\t\t\tthis._handler.off(this._events.touchend);\r\n\t\t\t// this._handler.off(this._events.mouseleave);\r\n\t\t\tthis._handler.off(this._events.touchcancel);\r\n\r\n\t\t\tthis._started = false;\r\n\r\n\t\t\tthis._upInternal(e);\r\n\r\n\t\t\t// mouseupclick\r\n\t\t\tif (this._moved) { //\r\n\t\t\t\tthis._mouseEndPoint = _getMouseAbstractPoint(this._grid, e);\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis._mouseEndPoint = null;\r\n\t\t\t\t}, 10);\r\n\t\t\t}\r\n\t\t}\r\n\t\t_upInternal(e) {\r\n\t\t\t//protected\r\n\t\t}\r\n\t\tdispose() {\r\n\t\t\tthis._handler.dispose();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * managing cell selection operation with mouse\r\n\t * @private\r\n\t */\r\n\tclass CellSelector extends BaseMouseDownMover {\r\n\t\tstart(e) {\r\n\t\t\tconst cell = this._getTargetCell(e);\r\n\t\t\tif (!cell) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_moveFocusCell(this._grid, cell.col, cell.row, e.shiftKey);\r\n\r\n\t\t\tthis._bindMoveAndUp(e);\r\n\r\n\t\t\tthis._cell = cell;\r\n\r\n\t\t\tcancelEvent(e);\r\n\t\t\t_vibrate(e);\r\n\t\t}\r\n\t\tselect(e) {\r\n\t\t\tconst cell = this._getTargetCell(e);\r\n\t\t\tif (!cell) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t_moveFocusCell(this._grid, cell.col, cell.row, e.shiftKey);\r\n\t\t\tthis._cell = cell;\r\n\t\t}\r\n\t\t_moveInternal(e) {\r\n\t\t\tconst cell = this._getTargetCell(e);\r\n\t\t\tif (!cell || (this._cell.col === cell.col && this._cell.row === cell.row)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\t_moveFocusCell(this._grid, cell.col, cell.row, true);\r\n\r\n\t\t\t//make visible\r\n\t\t\tconst makeVisibleCol = (() => {\r\n\t\t\t\tif (cell.col < this._cell.col && 0 < cell.col) {\r\n\t\t\t\t\t// move left\r\n\t\t\t\t\treturn cell.col - 1;\r\n\t\t\t\t} else if (this._cell.col < cell.col && cell.col + 1 < this._grid.colCount) {\r\n\t\t\t\t\t// move right\r\n\t\t\t\t\treturn cell.col + 1;\r\n\t\t\t\t}\r\n\t\t\t\treturn cell.col;\r\n\t\t\t})();\r\n\t\t\tconst makeVisibleRow = (() => {\r\n\t\t\t\tif (cell.row < this._cell.row && 0 < cell.row) {\r\n\t\t\t\t\t// move up\r\n\t\t\t\t\treturn cell.row - 1;\r\n\t\t\t\t} else if (this._cell.row < cell.row && cell.row + 1 < this._grid.rowCount) {\r\n\t\t\t\t\t// move down\r\n\t\t\t\t\treturn cell.row + 1;\r\n\t\t\t\t}\r\n\t\t\t\treturn cell.row;\r\n\t\t\t})();\r\n\t\t\tif (makeVisibleCol !== cell.col || makeVisibleRow !== cell.row) {\r\n\t\t\t\tthis._grid.makeVisibleCell(makeVisibleCol, makeVisibleRow);\r\n\t\t\t}\r\n\t\t\tthis._cell = cell;\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t_getTargetCell(e) {\r\n\t\t\tconst abstractPos = _getMouseAbstractPoint(this._grid, e);\r\n\t\t\tif (!abstractPos) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tconst cell = this._grid.getCellAt(abstractPos.x, abstractPos.y);\r\n\t\t\tif (cell.col < 0 || cell.row < 0) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn cell;\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * managing row width changing operation with mouse\r\n\t * @private\r\n\t */\r\n\tclass ColumnResizer extends BaseMouseDownMover {\r\n\t\tconstructor(grid) {\r\n\t\t\tsuper(grid);\r\n\t\t\tthis._targetCol = -1;\r\n\t\t}\r\n\t\tstart(col, e) {\r\n\t\t\tlet pageX;\r\n\t\t\tif (!isTouchEvent(e)) {\r\n\t\t\t\t({pageX} = e);\r\n\t\t\t} else {\r\n\t\t\t\t({pageX} = e.changedTouches[0]);\r\n\t\t\t}\r\n\r\n\t\t\tthis._x = pageX;\r\n\t\t\tthis._preX = 0;\r\n\r\n\t\t\tthis._bindMoveAndUp(e);\r\n\r\n\t\t\tthis._targetCol = col;\r\n\t\t\tthis._invalidateAbsoluteLeft = _getColsWidth(this._grid, 0, col - 1);\r\n\r\n\t\t\tcancelEvent(e);\r\n\t\t\t_vibrate(e);\r\n\t\t}\r\n\t\t_moveInternal(e) {\r\n\t\t\tconst pageX = isTouchEvent(e) ? e.changedTouches[0].pageX : e.pageX;\r\n\r\n\t\t\tconst x = pageX - this._x;\r\n\t\t\tconst moveX = x - this._preX;\r\n\t\t\tthis._preX = x;\r\n\t\t\tconst pre = this._grid.getColWidth(this._targetCol);\r\n\t\t\tlet afterSize = _adjustColWidth(this._grid, this._targetCol, pre + moveX);\r\n\t\t\tif (afterSize < 10 && moveX < 0) {\r\n\t\t\t\tafterSize = 10;\r\n\t\t\t}\r\n\t\t\t_setColWidth(this._grid, this._targetCol, afterSize);\r\n\r\n\t\t\tconst rect = _getVisibleRect(this._grid);\r\n\t\t\trect.left = this._invalidateAbsoluteLeft;\r\n\t\t\t_invalidateRect(this._grid, rect);\r\n\r\n\t\t\tthis._grid.fireListeners(EVENT_TYPE.RESIZE_COLUMN, {col: this._targetCol});\r\n\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\t_upInternal(e) {\r\n\t\t\tthis._grid.updateScroll();\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\r\n\tfunction setSafeInputValue(input, value) {\r\n\t\tconst {type} = input;\r\n\t\tinput.type = '';\r\n\t\tinput.value = value;\r\n\t\tif (type) {\r\n\t\t\tinput.type = type;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Manage focus\r\n\t * @private\r\n\t */\r\n\tclass FocusControl extends EventTarget {\r\n\t\tconstructor(grid, parentElement, scrollable) {\r\n\t\t\tsuper();\r\n\t\t\tthis._grid = grid;\r\n\t\t\tthis._scrollable = scrollable;\r\n\t\t\tthis._handler = new EventHandler();\r\n\t\t\tthis._input = document.createElement('input');\r\n\t\t\tthis._input.classList.add('grid-focus-control');\r\n\t\t\tthis._input.readOnly = true;\r\n\t\t\tparentElement.appendChild(this._input);\r\n\r\n\t\t\tthis._handler.on(this._input, 'compositionstart', (e) => {\r\n\t\t\t\tthis._input.classList.add('composition');\r\n\t\t\t\tthis._input.style.font = this._grid.font || '16px sans-serif';\r\n\t\t\t\tthis._isComposition = true;\r\n\t\t\t\tgrid.focus();\r\n\t\t\t});\r\n\t\t\tthis._handler.on(this._input, 'compositionend', (e) => {\r\n\t\t\t\tthis._isComposition = false;\r\n\t\t\t\tthis._input.classList.remove('composition');\r\n\t\t\t\tthis._input.style.font = '';\r\n\t\t\t\tif (!this._input.readOnly) {\r\n\t\t\t\t\tthis.fireListeners('input', this._input.value);\r\n\t\t\t\t}\r\n\t\t\t\tsetSafeInputValue(this._input, '');\r\n\t\t\t});\r\n\t\t\tthis._handler.on(this._input, 'keypress', (e) => {\r\n\t\t\t\tif (this._isComposition) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!this._input.readOnly && e.key && e.key.length === 1) {\r\n\t\t\t\t\tif (e.key === 'c' && (e.ctrlKey || e.metaKey)) {\r\n\t\t\t\t\t\t//copy! for Firefox\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.fireListeners('input', e.key);\r\n\t\t\t\t\t\tcancelEvent(e);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tsetSafeInputValue(this._input, '');\r\n\t\t\t});\r\n\t\t\tthis._handler.on(this._input, 'keydown', (e) => {\r\n\t\t\t\tif (this._isComposition) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst keyCode = getKeyCode(e);\r\n\t\t\t\tthis.fireListeners('keydown', keyCode, e);\r\n\r\n\t\t\t\tif (!this._input.readOnly && this._input.value) {\r\n\t\t\t\t\t// for Safari\r\n\t\t\t\t\tthis.fireListeners('input', this._input.value);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetSafeInputValue(this._input, '');\r\n\t\t\t});\r\n\t\t\tconst inputClear = (e) => {\r\n\t\t\t\tif (this._isComposition) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tsetSafeInputValue(this._input, '');\r\n\t\t\t};\r\n\r\n\t\t\tthis._handler.on(this._input, 'input', inputClear);\r\n\t\t\tthis._handler.on(this._input, 'keyup', inputClear);\r\n\t\t\tthis._handler.on(document, 'keydown', (e) => {\r\n\t\t\t\tif (!browser.IE) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (e.target !== this._input) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst keyCode = getKeyCode(e);\r\n\t\t\t\tif (keyCode === KEY_ALPHA_C && e.ctrlKey) {\r\n\t\t\t\t\tsetSafeInputValue(this._input, 'dummy');\r\n\t\t\t\t\tthis._input.select();\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tsetSafeInputValue(this._input, '');\r\n\t\t\t\t\t}, 100);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis._handler.on(document, 'copy', (e) => {\r\n\t\t\t\tif (this._isComposition) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tif (!isDescendantElement(parentElement, e.target)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tsetSafeInputValue(this._input, '');\r\n\t\t\t\tconst data = array.find(this.fireListeners('copy'), isDef);\r\n\t\t\t\tif (isDef(data)) {\r\n\t\t\t\t\tcancelEvent(e);\r\n\t\t\t\t\tif (browser.IE) {\r\n\t\t\t\t\t\twindow.clipboardData.setData('Text', data); // IE\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\te.clipboardData.setData('text/plain', data); // Chrome, Firefox\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tonKeyDownMove(fn) {\r\n\t\t\tthis._handler.on(this._input, 'keydown', (e) => {\r\n\t\t\t\tif (this._isComposition) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tconst keyCode = getKeyCode(e);\r\n\t\t\t\tif (keyCode === KEY_LEFT ||\r\n\t\t\t\t\tkeyCode === KEY_UP ||\r\n\t\t\t\t\tkeyCode === KEY_RIGHT ||\r\n\t\t\t\t\tkeyCode === KEY_DOWN ||\r\n\t\t\t\t\tkeyCode === KEY_HOME ||\r\n\t\t\t\t\tkeyCode === KEY_END\r\n\t\t\t\t) {\r\n\t\t\t\t\tfn(e);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\tonInput(fn) {\r\n\t\t\treturn this.listen('input', fn);\r\n\t\t}\r\n\t\tonCopy(fn) {\r\n\t\t\treturn this.listen('copy', fn);\r\n\t\t}\r\n\t\tfocus() {\r\n\t\t\t// this._input.value = '';\r\n\t\t\tthis._input.focus();\r\n\t\t}\r\n\t\tsetFocusRect(rect) {\r\n\t\t\tconst top = this._scrollable.calcTop(rect.top);\r\n\t\t\tthis._input.style.top = (top - style.getScrollBarSize()).toFixed() + 'px';//position:relative IE position:relative\r\n\t\t\tthis._input.style.left = rect.left.toFixed() + 'px';\r\n\t\t\tthis._input.style.width = rect.width.toFixed() + 'px';\r\n\t\t\tthis._input.style.height = rect.height.toFixed() + 'px';\r\n\t\t}\r\n\t\tset editMode(editMode) {\r\n\t\t\tthis._input.readOnly = !editMode;\r\n\t\t}\r\n\t\tresetInputStatus() {\r\n\t\t\tconst el = this._input;\r\n\t\t\tconst composition = el.classList.contains('composition');\r\n\t\t\t\r\n\t\t\tconst atts = el.attributes;\r\n\t\t\tconst removeNames = [];\r\n\t\t\tfor (let i = 0, n = atts.length; i < n; i++) {\r\n\t\t\t\tconst att = atts[i];\r\n\t\t\t\tif (!this._inputStatus.hasOwnProperty(att.nodeName)) {\r\n\t\t\t\t\tremoveNames.push(att.name);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tremoveNames.forEach((removeName) => {\r\n\t\t\t\tel.removeAttribute(removeName);\r\n\t\t\t});\r\n\t\t\tfor (const name in this._inputStatus) {\r\n\t\t\t\tel.setAttribute(name, this._inputStatus[name]);\r\n\t\t\t}\r\n\t\t\tif (composition) {\r\n\t\t\t\tel.classList.add('composition');\r\n\t\t\t\tel.style.font = this._grid.font || '16px sans-serif';\r\n\t\t\t} else {\r\n\t\t\t\tel.classList.remove('composition');\r\n\t\t\t}\r\n\t\t}\r\n\t\tstoreInputStatus() {\r\n\t\t\tconst el = this._input;\r\n\t\t\tthis._inputStatus = {};\r\n\t\t\tconst atts = el.attributes;\r\n\t\t\tfor (let i = 0, n = atts.length; i < n; i++) {\r\n\t\t\t\tconst att = atts[i];\r\n\t\t\t\tthis._inputStatus[att.name] = att.value;\r\n\t\t\t}\r\n\t\t}\r\n\t\tsetDefaultInputStatus() {\r\n\t\t\t// \r\n\t\t\t// this._input.style.font = this._grid.font || '16px sans-serif';\r\n\t\t}\r\n\t\tget editMode() {\r\n\t\t\treturn !this._input.readOnly;\r\n\t\t}\r\n\t\tget input() {\r\n\t\t\treturn this._input;\r\n\t\t}\r\n\t\tdispose() {\r\n\t\t\tsuper.dispose();\r\n\t\t\tthis._handler.dispose();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Selected area management\r\n\t */\r\n\tclass Selection extends EventTarget {\r\n\t\tconstructor(grid) {\r\n\t\t\tsuper();\r\n\t\t\tthis._grid = grid;\r\n\r\n\t\t\tthis._sel = {col: 0, row: 0};\r\n\t\t\tthis._focus = {col: 0, row: 0};\r\n\t\t\t\r\n\t\t\tthis._start = {col: 0, row: 0};\r\n\t\t\tthis._end = {col: 0, row: 0};\r\n\t\t}\r\n\t\tget range() {\r\n\t\t\tconst startCol = Math.min(this._start.col, this._end.col);\r\n\t\t\tconst startRow = Math.min(this._start.row, this._end.row);\r\n\t\t\tconst endCol = Math.max(this._start.col, this._end.col);\r\n\t\t\tconst endRow = Math.max(this._start.row, this._end.row);\r\n\t\t\treturn {\r\n\t\t\t\tstart: {\r\n\t\t\t\t\tcol: startCol,\r\n\t\t\t\t\trow: startRow,\r\n\t\t\t\t},\r\n\t\t\t\tend: {\r\n\t\t\t\t\tcol: endCol,\r\n\t\t\t\t\trow: endRow,\r\n\t\t\t\t},\r\n\t\t\t\tinCell(col, row) {\r\n\t\t\t\t\treturn startCol <= col && col <= endCol &&\r\n\t\t\t\t\t\tstartRow <= row && row <= endRow;\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t}\r\n\t\tget select() {\r\n\t\t\treturn {\r\n\t\t\t\tcol: this._sel.col,\r\n\t\t\t\trow: this._sel.row\r\n\t\t\t};\r\n\t\t}\r\n\t\tset select(cell = {}) {\r\n\t\t\tthis._wrapFireSelectedEvent(() => {\r\n\t\t\t\tconst {\r\n\t\t\t\t\tcol = 0,\r\n\t\t\t\t\trow = 0\r\n\t\t\t\t} = cell;\r\n\t\t\t\tthis._setSelectCell(col, row);\r\n\t\t\t\tthis._setFocusCell(col, row, true);\r\n\t\t\t});\r\n\t\t}\r\n\t\t_setSelectCell(col, row) {\r\n\t\t\tthis._wrapFireSelectedEvent(() => {\r\n\t\t\t\tthis._sel = {col, row};\r\n\t\t\t\tthis._start = {col, row};\r\n\t\t\t});\r\n\t\t}\r\n\t\t_setFocusCell(col, row, keepSelect) {\r\n\t\t\tthis._wrapFireSelectedEvent(() => {\r\n\t\t\t\tif (!keepSelect) {\r\n\t\t\t\t\tthis._setSelectCell(col, row);\r\n\t\t\t\t}\r\n\t\t\t\tthis._focus = {col, row};\r\n\t\t\t\tthis._end = {col, row};\r\n\t\t\t});\r\n\t\t}\r\n\t\t_wrapFireSelectedEvent(callback) {\r\n\t\t\tif (this._isWraped) {\r\n\t\t\t\tcallback();\r\n\t\t\t} else {\r\n\t\t\t\tthis._isWraped = true;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst before = {\r\n\t\t\t\t\t\tcol: this._sel.col,\r\n\t\t\t\t\t\trow: this._sel.row,\r\n\t\t\t\t\t\tselected: false,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tcallback();\r\n\t\t\t\t\tconst after = {\r\n\t\t\t\t\t\tcol: this._sel.col,\r\n\t\t\t\t\t\trow: this._sel.row,\r\n\t\t\t\t\t\tselected: true,\r\n\t\t\t\t\t\tbefore: {\r\n\t\t\t\t\t\t\tcol: before.col,\r\n\t\t\t\t\t\t\trow: before.row,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tbefore.after = {\r\n\t\t\t\t\t\tcol: after.col,\r\n\t\t\t\t\t\trow: after.row,\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.fireListeners(EVENT_TYPE.SELECTED_CELL, before);\r\n\t\t\t\t\tthis.fireListeners(EVENT_TYPE.SELECTED_CELL, after);\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tthis._isWraped = false;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * This class manages the drawing process for each layer\r\n\t */\r\n\tclass DrawLayers {\r\n\t\tconstructor() {\r\n\t\t\tthis._layers = {};\r\n\t\t}\r\n\t\taddDraw(level, fn) {\r\n\t\t\tconst l = this._layers[level] || (this._layers[level] = new DrawLayer(level));\r\n\t\t\tl.addDraw(fn);\r\n\t\t}\r\n\t\tdraw(ctx) {\r\n\t\t\tconst list = [];\r\n\t\t\tfor (const k in this._layers) {\r\n\t\t\t\tlist.push(this._layers[k]);\r\n\t\t\t}\r\n\t\t\tlist.sort((a, b) => a.level - b.level);\r\n\t\t\tlist.forEach((l) => l.draw(ctx));\r\n\t\t}\r\n\t}\r\n\tclass DrawLayer {\r\n\t\tconstructor(level) {\r\n\t\t\tthis._level = level;\r\n\t\t\tthis._list = [];\r\n\t\t}\r\n\t\tget level() {\r\n\t\t\treturn this._level;\r\n\t\t}\r\n\t\taddDraw(fn) {\r\n\t\t\tthis._list.push(fn);\r\n\t\t}\r\n\t\tdraw(ctx) {\r\n\t\t\tthis._list.forEach((fn) => {\r\n\t\t\t\tctx.save();\r\n\t\t\t\ttry {\r\n\t\t\t\t\tfn(ctx);\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tctx.restore();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * Context of cell drawing\r\n\t */\r\n\tclass DrawCellContext {\r\n\t\t/**\r\n\t\t * @private\r\n\t\t */\r\n\t\tconstructor(col, row, ctx, rect, drawRect, drawing, selection, drawLayers) {\r\n\t\t\tthis._col = col;\r\n\t\t\tthis._row = row;\r\n\t\t\tthis._mode = 0;\r\n\t\t\tthis._ctx = ctx;\r\n\t\t\tthis._rect = rect;\r\n\t\t\tthis._drawRect = drawRect;\r\n\t\t\tthis._drawing = drawing;\r\n\t\t\tthis._selection = selection;\r\n\t\t\tthis._drawLayers = drawLayers;\r\n\t\t}\r\n\t\tget drawing() {\r\n\t\t\tif (this._mode === 0) {\r\n\t\t\t\treturn this._drawing;\r\n\t\t\t} else {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\t\tget row() {\r\n\t\t\treturn this._row;\r\n\t\t}\r\n\t\tget col() {\r\n\t\t\treturn this._col;\r\n\t\t}\r\n\t\t/**\r\n\t\t * select status.\r\n\t\t * @return {object} select status\r\n\t\t */\r\n\t\tgetSelectState() {\r\n\t\t\tconst sel = this._selection.select;\r\n\t\t\treturn {\r\n\t\t\t\tselected: sel.col === this._col && sel.row === this._row,\r\n\t\t\t\tselection: this._selection.range.inCell(this._col, this._row),\r\n\t\t\t};\r\n\t\t}\r\n\t\t/**\r\n\t\t * Canvas context.\r\n\t\t * @return {CanvasRenderingContext2D} Canvas context.\r\n\t\t */\r\n\t\tgetContext() {\r\n\t\t\tif (this._mode === 0) {\r\n\t\t\t\treturn this._ctx;\r\n\t\t\t} else {\r\n\t\t\t\treturn this._grid._getInitContext();\r\n\t\t\t}\r\n\t\t}\r\n\t\t/**\r\n\t\t * Rectangle of cell.\r\n\t\t * @return {Rect} rect Rectangle of cell.\r\n\t\t */\r\n\t\tgetRect() {\r\n\t\t\tif (this._mode === 0) {\r\n\t\t\t\treturn this._rect;\r\n\t\t\t} else {\r\n\t\t\t\tif (this._rect) {\r\n\t\t\t\t\treturn this._rect;\r\n\t\t\t\t}\r\n\t\t\t\treturn this._grid.getCellRelativeRect(this._col, this._row);\r\n\t\t\t}\r\n\t\t}\r\n\t\tsetRect(rect) {\r\n\t\t\tthis._rect = rect;\r\n\t\t}\r\n\t\t/**\r\n\t\t * Rectangle of Drawing range.\r\n\t\t * @return {Rect} Rectangle of Drawing range.\r\n\t\t */\r\n\t\tgetDrawRect() {\r\n\t\t\tif (this._mode === 0) {\r\n\t\t\t\treturn this._drawRect;\r\n\t\t\t} else {\r\n\t\t\t\tconst absoluteRect = this._grid.getCellRect(this._col, this._row);\r\n\t\t\t\treturn this._toRelativeDrawRect(absoluteRect);\r\n\t\t\t}\r\n\t\t}\r\n\t\t/**\r\n\t\t * get Context of current state\r\n\t\t * @return {DrawCellContext} current DrawCellContext.\r\n\t\t */\r\n\t\ttoCurrentContext() {\r\n\t\t\tif (this._mode === 0) {\r\n\t\t\t\treturn this;\r\n\t\t\t} else {\r\n\t\t\t\tconst absoluteRect = this._grid.getCellRect(this._col, this._row);\r\n\t\t\t\tconst rect = _toRelativeRect(this._grid, absoluteRect);\r\n\t\t\t\tconst drawRect = this._toRelativeDrawRect(absoluteRect);\r\n\t\t\t\tconst context = new DrawCellContext(\r\n\t\t\t\t\t\tthis._col, this._row, this.getContext(), rect, drawRect, this.drawing, this._selection,\r\n\t\t\t\t\t\tthis._drawLayers\r\n\t\t\t\t);\r\n\t\t\t\t// toCurrentContext  toCurrentContext\r\n\t\t\t\tcontext.toCurrentContext = this.toCurrentContext.bind(this);\r\n\t\t\t\treturn context;\r\n\t\t\t}\r\n\t\t}\r\n\t\taddLayerDraw(level, fn) {\r\n\t\t\tthis._drawLayers.addDraw(level, fn);\r\n\t\t}\r\n\t\t_toRelativeDrawRect(absoluteRect) {\r\n\t\t\tconst visibleRect = _getVisibleRect(this._grid);\r\n\t\t\tlet rect = absoluteRect.copy();\r\n\t\t\tif (!rect.intersection(visibleRect)) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tconst isFrozenCell = this._grid.isFrozenCell(this._col, this._row);\r\n\t\t\tif (this._grid.frozenColCount >= 0 && (!isFrozenCell || !isFrozenCell.col)) {\r\n\t\t\t\tconst fRect = this._grid.getCellRect(this._grid.frozenColCount - 1, this._row);\r\n\t\t\t\trect = Rect.bounds(\r\n\t\t\t\t\t\tMath.max(rect.left, fRect.right),\r\n\t\t\t\t\t\trect.top,\r\n\t\t\t\t\t\trect.right,\r\n\t\t\t\t\t\trect.bottom\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t\tif (this._grid.frozenRowCount >= 0 && (!isFrozenCell || !isFrozenCell.row)) {\r\n\t\t\t\tconst fRect = this._grid.getCellRect(this._col, this._grid.frozenRowCount - 1);\r\n\t\t\t\trect = Rect.bounds(\r\n\t\t\t\t\t\trect.left,\r\n\t\t\t\t\t\tMath.max(rect.top, fRect.bottom),\r\n\t\t\t\t\t\trect.right,\r\n\t\t\t\t\t\trect.bottom\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\t\r\n\t\t\tif (!rect.intersection(visibleRect)) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\trect.offsetLeft(-visibleRect.left);\r\n\t\t\trect.offsetTop(-visibleRect.top);\r\n\r\n\t\t\treturn rect;\r\n\t\t}\r\n\t\t_delayMode(grid, onTerminate) {\r\n\t\t\tthis._mode = 1;\r\n\t\t\tthis._ctx = null;\r\n\t\t\tthis._rect = null;\r\n\t\t\tthis._drawRect = null;\r\n\t\t\tthis._grid = grid;\r\n\t\t\tthis._onTerminate = onTerminate;\r\n\t\t}\r\n\t\t/**\r\n\t\t * terminate\r\n\t\t * @return {void}\r\n\t\t */\r\n\t\tterminate() {\r\n\t\t\tif (this._mode !== 0) {\r\n\t\t\t\tthis._onTerminate();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * DrawGrid\r\n\t * @classdesc cheetahGrid.core.DrawGrid\r\n\t * @extends EventTarget\r\n\t * @memberof cheetahGrid.core\r\n\t */\r\n\tclass DrawGrid extends EventTarget {\r\n\t\tstatic get EVENT_TYPE() {\r\n\t\t\treturn EVENT_TYPE;\r\n\t\t}\r\n\t\t/**\r\n\t\t * constructor\r\n\t\t *\r\n\t\t * <pre>\r\n\t\t * Constructor options\r\n\t\t * -----\r\n\t\t * rowCount: grid row count.default 10\r\n\t\t * colCount: grid col count.default 10\r\n\t\t * frozenColCount: default 0\r\n\t\t * frozenRowCount: default 0\r\n\t\t * defaultRowHeight: default grid row height. default 40\r\n\t\t * defaultColWidth: default grid col width. default 80\r\n\t\t * parentElement: canvas parentElement\r\n\t\t * font: default font\r\n\t\t * underlayBackgroundColor: underlay background color\r\n\t\t * -----\r\n\t\t * </pre>\r\n\t\t *\r\n\t\t * @constructor\r\n\t\t * @param  {Object} options Constructor options\r\n\t\t */\r\n\t\tconstructor(\r\n\t\t\t\t{\r\n\t\t\t\t\trowCount = 10,\r\n\t\t\t\t\tcolCount = 10,\r\n\t\t\t\t\tfrozenColCount = 0,\r\n\t\t\t\t\tfrozenRowCount = 0,\r\n\t\t\t\t\tdefaultRowHeight = 40,\r\n\t\t\t\t\tdefaultColWidth = 80,\r\n\t\t\t\t\tfont,\r\n\t\t\t\t\tunderlayBackgroundColor,\r\n\t\t\t\t\tparentElement,\r\n\t\t\t\t} = {}) {\r\n\t\t\tsuper();\r\n\t\t\tthis[_] = {};\r\n\t\t\tstyle.initDocument();\r\n\t\t\tthis[_].element = createRootElement();\r\n\t\t\tthis[_].scrollable = new Scrollable();\r\n\t\t\tthis[_].handler = new EventHandler();\r\n\t\t\tthis[_].selection = new Selection(this);\r\n\t\t\tthis[_].focusControl = new FocusControl(this, this[_].scrollable.getElement(), this[_].scrollable);\r\n\r\n\t\t\tthis[_].canvas = hiDPI.transform(document.createElement('canvas'));\r\n\t\t\tthis[_].context = this[_].canvas.getContext('2d', {alpha: false});\r\n\r\n\t\t\tthis[_].rowCount = rowCount;\r\n\t\t\tthis[_].colCount = colCount;\r\n\t\t\tthis[_].frozenColCount = frozenColCount;\r\n\t\t\tthis[_].frozenRowCount = frozenRowCount;\r\n\r\n\t\t\tthis[_].defaultRowHeight = defaultRowHeight;\r\n\t\t\tthis[_].defaultColWidth = defaultColWidth;\r\n\r\n\t\t\tthis[_].font = font;\r\n\t\t\tthis[_].underlayBackgroundColor = underlayBackgroundColor;\r\n\r\n\t\t\t/////\r\n\t\t\tthis[_].rowHeightsMap = new NumberMap();\r\n\t\t\tthis[_].colWidthsMap = new NumberMap();\r\n\t\t\tthis[_].colWidthsLimit = {};\r\n\t\t\tthis[_].calcWidthContext = {\r\n\t\t\t\t_: this[_],\r\n\t\t\t\tget full() {\r\n\t\t\t\t\treturn this._.canvas.width;\r\n\t\t\t\t},\r\n\t\t\t\tget em() {\r\n\t\t\t\t\treturn this._.context.measureText('').width;\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tthis[_].columnResizer = new ColumnResizer(this);\r\n\t\t\tthis[_].cellSelector = new CellSelector(this);\r\n\r\n\t\t\tthis[_].drawCells = {};\r\n\r\n\t\t\tthis[_].element.appendChild(this[_].canvas);\r\n\t\t\tthis[_].element.appendChild(this[_].scrollable.getElement());\r\n\t\t\tthis.updateScroll();\r\n\t\t\tif (parentElement) {\r\n\t\t\t\tparentElement.appendChild(this[_].element);\r\n\t\t\t\tthis.updateSize();\r\n\t\t\t} else {\r\n\t\t\t\tthis.updateSize();\r\n\t\t\t}\r\n\t\t\t_bindEvents(this);\r\n\t\t}\r\n\t\tgetElement() {\r\n\t\t\treturn this[_].element;\r\n\t\t}\r\n\t\tget canvas() {\r\n\t\t\treturn this[_].canvas;\r\n\t\t}\r\n\t\tfocus() {\r\n\t\t\tconst {col, row} = this[_].selection.select;\r\n\t\t\tthis.focusCell(col, row);\r\n\t\t}\r\n\t\tget selection() {\r\n\t\t\treturn this[_].selection;\r\n\t\t}\r\n\t\tget rowCount() {\r\n\t\t\treturn this[_].rowCount;\r\n\t\t}\r\n\t\tset rowCount(rowCount) {\r\n\t\t\tthis[_].rowCount = rowCount;\r\n\t\t\tthis.updateScroll();\r\n\t\t}\r\n\t\tget colCount() {\r\n\t\t\treturn this[_].colCount;\r\n\t\t}\r\n\t\tset colCount(colCount) {\r\n\t\t\tthis[_].colCount = colCount;\r\n\t\t\tthis.updateScroll();\r\n\t\t}\r\n\t\tget frozenColCount() {\r\n\t\t\treturn this[_].frozenColCount;\r\n\t\t}\r\n\t\tset frozenColCount(frozenColCount) {\r\n\t\t\tthis[_].frozenColCount = frozenColCount;\r\n\t\t}\r\n\t\tget frozenRowCount() {\r\n\t\t\treturn this[_].frozenRowCount;\r\n\t\t}\r\n\t\tset frozenRowCount(frozenRowCount) {\r\n\t\t\tthis[_].frozenRowCount = frozenRowCount;\r\n\t\t}\r\n\t\tget defaultRowHeight() {\r\n\t\t\treturn this[_].rowCount;\r\n\t\t}\r\n\t\tset defaultRowHeight(defaultRowHeight) {\r\n\t\t\tthis[_].defaultRowHeight = defaultRowHeight;\r\n\t\t\tthis.updateScroll();\r\n\t\t}\r\n\t\tget defaultColWidth() {\r\n\t\t\treturn this[_].defaultColWidth;\r\n\t\t}\r\n\t\tset defaultColWidth(defaultColWidth) {\r\n\t\t\tthis[_].defaultColWidth = defaultColWidth;\r\n\t\t\tthis.updateScroll();\r\n\t\t}\r\n\t\tget font() {\r\n\t\t\treturn this[_].font;\r\n\t\t}\r\n\t\tset font(font) {\r\n\t\t\tthis[_].font = font;\r\n\t\t}\r\n\t\tget underlayBackgroundColor() {\r\n\t\t\treturn this[_].underlayBackgroundColor;\r\n\t\t}\r\n\t\tset underlayBackgroundColor(underlayBackgroundColor) {\r\n\t\t\tthis[_].underlayBackgroundColor = underlayBackgroundColor;\r\n\t\t}\r\n\t\tconfigure(name, value) {\r\n\t\t\tconst cfg = this[_].config || (this[_].config = {});\r\n\t\t\tif (isDef(value)) {\r\n\t\t\t\tcfg[name] = value;\r\n\t\t\t}\r\n\t\t\treturn cfg[name];\r\n\t\t}\r\n\t\tupdateSize() {\r\n\t\t\t//\r\n\t\t\tthis[_].canvas.style.width = '';\r\n\t\t\tthis[_].canvas.style.height = '';\r\n\t\t\tconst width = Math.floor(this[_].canvas.offsetWidth ||\r\n\t\t\t\t\t/*for legacy*/this[_].canvas.parentElement.offsetWidth - style.getScrollBarSize());\r\n\t\t\tconst height = Math.floor(this[_].canvas.offsetHeight ||\r\n\t\t\t\t\t/*for legacy*/this[_].canvas.parentElement.offsetHeight - style.getScrollBarSize());\r\n\r\n\t\t\tthis[_].canvas.width = width;\r\n\t\t\tthis[_].canvas.height = height;\r\n\r\n\t\t\t//style\r\n\t\t\tthis[_].canvas.style.width = `${width}px`;\r\n\t\t\tthis[_].canvas.style.height = `${height}px`;\r\n\r\n\t\t\tconst sel = this[_].selection.select;\r\n\t\t\tthis[_].focusControl.setFocusRect(this.getCellRect(sel.col, sel.row));\r\n\t\t}\r\n\t\tupdateScroll() {\r\n\t\t\tthis[_].scrollable.setScrollSize(_getScrollWidth(this), _getScrollHeight(this));\r\n\t\t\tthis[_].scroll = {\r\n\t\t\t\tleft: this[_].scrollable.scrollLeft,\r\n\t\t\t\ttop: this[_].scrollable.scrollTop,\r\n\t\t\t};\r\n\t\t}\r\n\t\tgetRowHeight(row) {\r\n\t\t\treturn _getRowHeight(this, row);\r\n\t\t}\r\n\t\tsetRowHeight(row, height) {\r\n\t\t\t_setRowHeight(this, row, height);\r\n\t\t\tthis.updateScroll();\r\n\t\t}\r\n\t\tgetColWidth(col) {\r\n\t\t\treturn _getColWidth(this, col);\r\n\t\t}\r\n\t\tsetColWidth(col, width) {\r\n\t\t\t_setColWidth(this, col, width);\r\n\t\t\tthis.updateScroll();\r\n\t\t}\r\n\t\tgetMaxColWidth(col) {\r\n\t\t\tconst obj = this[_].colWidthsLimit[col];\r\n\t\t\treturn obj && obj.max || undefined;\r\n\t\t}\r\n\t\tsetMaxColWidth(col, maxwidth) {\r\n\t\t\tconst obj = this[_].colWidthsLimit[col] || (this[_].colWidthsLimit[col] = {});\r\n\t\t\tobj.max = maxwidth;\r\n\t\t}\r\n\t\tgetMinColWidth(col) {\r\n\t\t\tconst obj = this[_].colWidthsLimit[col];\r\n\t\t\treturn obj && obj.min || undefined;\r\n\t\t}\r\n\t\tsetMinColWidth(col, minwidth) {\r\n\t\t\tconst obj = this[_].colWidthsLimit[col] || (this[_].colWidthsLimit[col] = {});\r\n\t\t\tobj.min = minwidth;\r\n\t\t}\r\n\t\tgetCellRect(col, row) {\r\n\t\t\tconst isFrozenCell = this.isFrozenCell(col, row);\r\n\r\n\t\t\tlet absoluteLeft = _getColsWidth(this, 0, col - 1);\r\n\t\t\tconst width = _getColWidth(this, col);\r\n\t\t\tif (isFrozenCell && isFrozenCell.col) {\r\n\t\t\t\tabsoluteLeft += this[_].scroll.left;\r\n\t\t\t}\r\n\r\n\t\t\tlet absoluteTop = _getRowsHeight(this, 0, row - 1);\r\n\t\t\tconst height = _getRowHeight(this, row);\r\n\t\t\tif (isFrozenCell && isFrozenCell.row) {\r\n\t\t\t\tabsoluteTop += this[_].scroll.top;\r\n\t\t\t}\r\n\t\t\treturn new Rect(\r\n\t\t\t\t\tabsoluteLeft,\r\n\t\t\t\t\tabsoluteTop,\r\n\t\t\t\t\twidth,\r\n\t\t\t\t\theight\r\n\t\t\t);\r\n\t\t}\r\n\t\tgetCellRelativeRect(col, row) {\r\n\t\t\treturn _toRelativeRect(this, this.getCellRect(col, row));\r\n\t\t}\r\n\t\tgetCellsRect(startCol, startRow, endCol, endRow) {\r\n\t\t\tconst isFrozenStartCell = this.isFrozenCell(startCol, startRow);\r\n\t\t\tconst isFrozenEndCell = this.isFrozenCell(endCol, endRow);\r\n\r\n\t\t\tlet absoluteLeft = _getColsWidth(this, 0, startCol - 1);\r\n\t\t\tlet width = _getColsWidth(this, startCol, endCol);\r\n\t\t\tif (isFrozenStartCell && isFrozenStartCell.col) {\r\n\t\t\t\tconst scrollLeft = this[_].scroll.left;\r\n\t\t\t\tabsoluteLeft += scrollLeft;\r\n\t\t\t\tif (!isFrozenEndCell || !isFrozenEndCell.col) {\r\n\t\t\t\t\twidth -= scrollLeft;\r\n\t\t\t\t\twidth = Math.max(width, _getColsWidth(this, startCol, this.frozenColCount - 1));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tlet absoluteTop = _getRowsHeight(this, 0, startRow - 1);\r\n\t\t\tlet height = _getRowsHeight(this, startRow, endRow);\r\n\t\t\tif (isFrozenStartCell && isFrozenStartCell.row) {\r\n\t\t\t\tconst scrollTop = this[_].scroll.top;\r\n\t\t\t\tabsoluteTop += scrollTop;\r\n\t\t\t\tif (!isFrozenEndCell || !isFrozenEndCell.row) {\r\n\t\t\t\t\theight -= scrollTop;\r\n\t\t\t\t\theight = Math.max(height, _getColsWidth(this, startRow, this.frozenRowCount - 1));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn new Rect(\r\n\t\t\t\t\tabsoluteLeft,\r\n\t\t\t\t\tabsoluteTop,\r\n\t\t\t\t\twidth,\r\n\t\t\t\t\theight\r\n\t\t\t);\r\n\t\t}\r\n\t\tisFrozenCell(col, row) {\r\n\t\t\tconst isFrozenRow = this[_].frozenRowCount > 0 && row < this[_].frozenRowCount;\r\n\t\t\tconst isFrozenCol = this[_].frozenColCount > 0 && col < this[_].frozenColCount;\r\n\t\t\tif (isFrozenRow || isFrozenCol) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\trow: isFrozenRow,\r\n\t\t\t\t\tcol: isFrozenCol,\r\n\t\t\t\t};\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t}\r\n\t\tgetRowAt(absoluteY) {\r\n\t\t\tconst frozen = _getTargetFrozenRowAt(this, absoluteY);\r\n\t\t\tif (frozen) {\r\n\t\t\t\treturn frozen.row;\r\n\t\t\t}\r\n\t\t\tconst row = _getTargetRowAt(this, absoluteY);\r\n\t\t\treturn row ? row.row : -1;\r\n\r\n\t\t}\r\n\t\tgetColAt(absoluteX) {\r\n\t\t\tconst frozen = _getTargetFrozenColAt(this, absoluteX);\r\n\t\t\tif (frozen) {\r\n\t\t\t\treturn frozen.col;\r\n\t\t\t}\r\n\t\t\tconst col = _getTargetColAt(this, absoluteX);\r\n\t\t\treturn col ? col.col : -1;\r\n\t\t}\r\n\t\tgetCellAt(absoluteX, absoluteY) {\r\n\t\t\treturn {\r\n\t\t\t\trow: this.getRowAt(absoluteY),\r\n\t\t\t\tcol: this.getColAt(absoluteX),\r\n\t\t\t};\r\n\t\t}\r\n\t\tmakeVisibleCell(col, row) {\r\n\t\t\tconst isFrozenCell = this.isFrozenCell(col, row);\r\n\t\t\tif (isFrozenCell && isFrozenCell.col && isFrozenCell.row) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst rect = this.getCellRect(col, row);\r\n\t\t\tconst visibleRect = _getScrollableVisibleRect(this);\r\n\t\t\tif (visibleRect.contains(rect)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (!isFrozenCell || !isFrozenCell.col) {\r\n\t\t\t\tif (rect.left < visibleRect.left) {\r\n\t\t\t\t\tthis[_].scrollable.scrollLeft -= visibleRect.left - rect.left;\r\n\t\t\t\t} else if (visibleRect.right < rect.right) {\r\n\t\t\t\t\tthis[_].scrollable.scrollLeft -= visibleRect.right - rect.right;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (!isFrozenCell || !isFrozenCell.row) {\r\n\t\t\t\tif (rect.top < visibleRect.top) {\r\n\t\t\t\t\tthis[_].scrollable.scrollTop -= visibleRect.top - rect.top;\r\n\t\t\t\t} else if (visibleRect.bottom < rect.bottom) {\r\n\t\t\t\t\tthis[_].scrollable.scrollTop -= visibleRect.bottom - rect.bottom;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tfocusCell(col, row) {\r\n\t\t\tconst oldEditMode = this[_].focusControl.editMode;\r\n\t\t\tif (oldEditMode) {\r\n\t\t\t\tthis[_].focusControl.resetInputStatus();\r\n\t\t\t}\r\n\r\n\t\t\tthis[_].focusControl.setFocusRect(this.getCellRect(col, row));\r\n\t\t\t\r\n\t\t\tconst {col: selCol, row: selRow} = this[_].selection.select;\r\n\t\t\tconst results = this.fireListeners(\r\n\t\t\t\t\tEVENT_TYPE.EDITABLEINPUT_CELL,\r\n\t\t\t\t\t{col: selCol, row: selRow}\r\n\t\t\t);\r\n\t\t\t\r\n\t\t\tconst editMode = (array.findIndex(results, (v) => !!v) >= 0);\r\n\t\t\tthis[_].focusControl.editMode = editMode;\r\n\t\t\t\r\n\t\t\tif (editMode) {\r\n\t\t\t\tthis[_].focusControl.storeInputStatus();\r\n\t\t\t\tthis[_].focusControl.setDefaultInputStatus();\r\n\t\t\t\tthis.fireListeners(\r\n\t\t\t\t\t\tEVENT_TYPE.MODIFY_STATUS_EDITABLEINPUT_CELL,\r\n\t\t\t\t\t\t{col: selCol, row: selRow, input: this[_].focusControl.input}\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\t// Failure occurs in IE if focus is not last\r\n\t\t\tthis[_].focusControl.focus();\r\n\t\t}\r\n\t\tinvalidateCell(col, row) {\r\n\t\t\tthis.invalidateGridRect(col, row);\r\n\t\t}\r\n\t\tinvalidateGridRect(startCol, startRow, endCol = startCol, endRow = startRow) {\r\n\t\t\tconst offset = this.getOffsetInvalidateCells();\r\n\t\t\tif (offset > 0) {\r\n\t\t\t\tstartCol -= offset;\r\n\t\t\t\tstartRow -= offset;\r\n\t\t\t\tendCol += offset;\r\n\t\t\t\tendRow += offset;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst visibleRect = _getVisibleRect(this);\r\n\t\t\tconst cellsRect = this.getCellsRect(startCol, startRow, endCol, endRow);\r\n\t\t\tconst invalidateTarget = visibleRect.intersection(cellsRect);\r\n\t\t\tif (invalidateTarget) {\r\n\r\n\t\t\t\tif (this[_].frozenColCount > 0 && endCol >= this[_].frozenColCount) {\r\n\t\t\t\t\tconst frozenRect = _getFrozenColsRect(this);\r\n\t\t\t\t\tif (frozenRect.intersection(invalidateTarget)) {\r\n\t\t\t\t\t\tinvalidateTarget.left = Math.min(frozenRect.right - 1, frozenRect.right);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this[_].frozenRowCount > 0 && endRow >= this[_].frozenRowCount) {\r\n\t\t\t\t\tconst frozenRect = _getFrozenRowsRect(this);\r\n\t\t\t\t\tif (frozenRect.intersection(invalidateTarget)) {\r\n\t\t\t\t\t\tinvalidateTarget.top = Math.min(frozenRect.bottom - 1, invalidateTarget.top);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t_invalidateRect(this, invalidateTarget);\r\n\t\t\t}\r\n\t\t}\r\n\t\tinvalidate() {\r\n\t\t\tconst visibleRect = _getVisibleRect(this);\r\n\t\t\t_invalidateRect(this, visibleRect);\r\n\t\t}\r\n\t\t/**\r\n\t\t * get cell value at copy action\r\n\t\t * <p>\r\n\t\t * Please implement\r\n\t\t * </p>\r\n\t\t *\r\n\t\t * @protected\r\n\t\t * @param  {number} col Column index of cell.\r\n\t\t * @param  {number} row Row index of cell.\r\n\t\t * @return {string}\r\n\t\t */\r\n\t\tgetCopyCellValue(col, row) {\r\n\t\t\t//Please implement get cell value!!\r\n\t\t}\r\n\t\t/**\r\n\t\t * Draw a cell\r\n\t\t * <p>\r\n\t\t * Please implement cell drawing.\r\n\t\t * </p>\r\n\t\t *\r\n\t\t * @protected\r\n\t\t * @param  {number} col Column index of cell.\r\n\t\t * @param  {number} row Row index of cell.\r\n\t\t * @param  {DrawCellContext} context context of cell drawing.\r\n\t\t * @return {void}\r\n\t\t */\r\n\t\tonDrawCell(col, row, context) {\r\n\t\t\t//Please implement cell drawing!!\r\n\t\t}\r\n\t\taddDisposable(disposable) {\r\n\t\t\tif (!disposable || !disposable.dispose || typeof disposable.dispose !== 'function') {\r\n\t\t\t\tthrow new Error('not disposable!');\r\n\t\t\t}\r\n\t\t\tconst disposables = this[_].disposables = this[_].disposables || [];\r\n\t\t\tdisposables.push(disposable);\r\n\t\t}\r\n\t\tdispose() {\r\n\t\t\tsuper.dispose();\r\n\t\t\tthis[_].handler.dispose();\r\n\t\t\tthis[_].scrollable.dispose();\r\n\t\t\tthis[_].focusControl.dispose();\r\n\t\t\tthis[_].columnResizer.dispose();\r\n\t\t\tthis[_].cellSelector.dispose();\r\n\t\t\tif (this[_].disposables) {\r\n\t\t\t\tthis[_].disposables.forEach((disposable) => disposable.dispose());\r\n\t\t\t\tthis[_].disposables = null;\r\n\t\t\t}\r\n\r\n\t\t\tconst {parentElement} = this[_].element;\r\n\t\t\tif (parentElement) {\r\n\t\t\t\tparentElement.removeChild(this[_].element);\r\n\t\t\t}\r\n\t\t}\r\n\t\tgetAttachCellArea(col, row) {\r\n\t\t\treturn {\r\n\t\t\t\telement: this.getElement(),\r\n\t\t\t\trect: _toRelativeRect(this, this.getCellRect(col, row)),\r\n\t\t\t};\r\n\t\t}\r\n\t\tbindEventsInternal() {\r\n\t\t\t//nop\r\n\t\t}\r\n\t\tgetTargetRowAtInternal(absoluteY) {\r\n\t\t\t// \r\n\t\t}\r\n\t\tgetRowsHeightInternal(startRow, endRow) {\r\n\t\t\t// \r\n\t\t}\r\n\t\tgetRowHeightInternal(row) {\r\n\t\t\t// \r\n\t\t}\r\n\t\tgetScrollHeightInternal(row) {\r\n\t\t\t// \r\n\t\t}\r\n\t\tgetMoveLeftColByKeyDownInternal({col, row}) {\r\n\t\t\treturn col - 1;\r\n\t\t}\r\n\t\tgetMoveRightColByKeyDownInternal({col, row}) {\r\n\t\t\treturn col + 1;\r\n\t\t}\r\n\t\tgetMoveUpRowByKeyDownInternal({col, row}) {\r\n\t\t\treturn row - 1;\r\n\t\t}\r\n\t\tgetMoveDownRowByKeyDownInternal({col, row}) {\r\n\t\t\treturn row + 1;\r\n\t\t}\r\n\t\tgetOffsetInvalidateCells() {\r\n\t\t\treturn 0;\r\n\t\t}\r\n\t\t_getInitContext() {\r\n\t\t\tconst ctx = this[_].context;\r\n\t\t\t//\r\n\t\t\tctx.fillStyle = 'white';\r\n\t\t\tctx.strokeStyle = 'black';\r\n\t\t\tctx.textAlign = 'left';\r\n\t\t\tctx.textBaseline = 'top';\r\n\t\t\tctx.lineWidth = 1;\r\n\t\t\tctx.font = this.font || '16px sans-serif';\r\n\t\t\treturn ctx;\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.exports = DrawGrid;\r\n}","'use strict';\r\n{\r\n\tconst {isDef, obj: {each}} = require('../internal/utils');\r\n\t//private symbol\r\n\tconst {_} = require('../internal/symbolManager').get();\r\n\r\n\tlet nextId = 1;\r\n\t/**\r\n\t * event target.\r\n\t */\r\n\tclass EventTarget {\r\n\t\tconstructor() {\r\n\t\t\tthis[_] = {};\r\n\t\t\tthis[_].listeners = {};\r\n\t\t\tthis[_].listenerData = {};\r\n\t\t}\r\n\t\t/**\r\n\t\t * Adds an event listener.\r\n\t\t * @param  {string} type The event type id.\r\n\t\t * @param  {function} listener Callback method.\r\n\t\t * @return {number} unique id for the listener.\r\n\t\t */\r\n\t\tlisten(type, listener) {\r\n\t\t\tconst list = this[_].listeners[type] || (this[_].listeners[type] = []);\r\n\t\t\tlist.push(listener);\r\n\r\n\t\t\tconst id = nextId++;\r\n\t\t\tthis[_].listenerData[id] = {\r\n\t\t\t\ttype,\r\n\t\t\t\tlistener,\r\n\t\t\t\tremove: () => {\r\n\t\t\t\t\tdelete this[_].listenerData[id];\r\n\t\t\t\t\tconst index = list.indexOf(listener);\r\n\t\t\t\t\tlist.splice(index, 1);\r\n\t\t\t\t\tif (!this[_].listeners[type].length) {\r\n\t\t\t\t\t\tdelete this[_].listeners[type];\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t\treturn id;\r\n\r\n\t\t}\r\n\t\t/**\r\n\t\t * Removes an event listener which was added with listen() by the id returned by listen().\r\n\t\t * @param  {number} id the id returned by listen().\r\n\t\t * @return {void}\r\n\t\t */\r\n\t\tunlisten(id) {\r\n\t\t\tthis[_].listenerData[id].remove();\r\n\t\t}\r\n\t\taddEventListener(type, listener) {\r\n\t\t\tthis.listen(type, listener);\r\n\t\t}\r\n\t\tremoveEventListener(type, listener) {\r\n\t\t\teach(this[_].listenerData, (obj, id) => {\r\n\t\t\t\tif (obj.type === type && obj.listener === listener) {\r\n\t\t\t\t\tthis.unlisten(id);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\thasListeners(type) {\r\n\t\t\treturn !!this[_].listeners[type];\r\n\t\t}\r\n\t\t/**\r\n\t\t * Fires all registered listeners\r\n\t\t * @param  {string}    type The type of the listeners to fire.\r\n\t\t * @param  {...*} args fire arguments\r\n\t\t * @return {*} the result of the last listener\r\n\t\t */\r\n\t\tfireListeners(type, ...args) {\r\n\t\t\tconst list = this[_].listeners[type];\r\n\t\t\tif (!list) {\r\n\t\t\t\treturn [];\r\n\t\t\t}\r\n\t\t\treturn list.\r\n\t\t\t\tmap((listener) => listener.call(this, ...args)).\r\n\t\t\t\tfilter(isDef);\r\n\t\t}\r\n\t\tdispose() {\r\n\t\t\tdelete this[_];\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.exports = EventTarget;\r\n}","'use strict';\r\n{\r\n\tconst DataSource = require('./data/DataSource');\r\n\tconst CachedDataSource = require('./data/CachedDataSource');\r\n\t\r\n\r\n\t/**\r\n\t * data modules\r\n\t * @type {Object}\r\n\t * @namespace cheetahGrid.data\r\n\t * @memberof cheetahGrid\r\n\t */\r\n\tmodule.exports = {\r\n\t\tDataSource,\r\n\t\tCachedDataSource\r\n\t};\r\n}","'use strict';\r\n{\r\n\tconst {getChainSafe} = require('../internal/utils');\r\n\tconst DataSource = require('./DataSource');\r\n\r\n\tfunction _setFieldCache({_fCache}, index, field, value) {\r\n\t\tconst recCache = _fCache[index] || (_fCache[index] = {});\r\n\t\trecCache[field] = value;\r\n\t}\r\n\t/**\r\n\t * grid data source\r\n\t *\r\n\t * @classdesc cheetahGrid.data.CachedDataSource\r\n\t * @extends cheetahGrid.data.DataSource\r\n\t * @memberof cheetahGrid.data\r\n\t */\r\n\tclass CachedDataSource extends DataSource {\r\n\t\tstatic get EVENT_TYPE() {\r\n\t\t\treturn DataSource.EVENT_TYPE;\r\n\t\t}\r\n\t\tstatic ofArray(array) {\r\n\t\t\treturn new CachedDataSource({\r\n\t\t\t\tget: (index) => array[index],\r\n\t\t\t\tlength: array.length\r\n\t\t\t});\r\n\t\t}\r\n\t\tconstructor(opt = {}) {\r\n\t\t\tsuper(opt);\r\n\t\t\tthis._rCache = {};\r\n\t\t\tthis._fCache = {};\r\n\t\t}\r\n\t\tgetOriginal(index) {\r\n\t\t\tif (this._rCache && this._rCache[index]) {\r\n\t\t\t\treturn this._rCache[index];\r\n\t\t\t}\r\n\t\t\treturn super.getOriginal(index);\r\n\t\t}\r\n\t\tgetOriginalField(index, field) {\r\n\t\t\tconst cache = getChainSafe(this._fCache, index, field);\r\n\t\t\tif (cache) {\r\n\t\t\t\treturn cache;\r\n\t\t\t}\r\n\t\t\treturn super.getOriginalField(index, field);\r\n\t\t}\r\n\t\tsetOriginalField(index, field, value) {\r\n\t\t\tconst fCache = this._fCache;\r\n\t\t\tif (fCache && fCache[index]) {\r\n\t\t\t\tdelete fCache[index]; // clear row cache\r\n\t\t\t}\r\n\t\t\treturn super.setOriginalField(index, field, value);\r\n\t\t}\r\n\t\tclearCache() {\r\n\t\t\tif (this._rCache) {\r\n\t\t\t\tthis._rCache = {};\r\n\t\t\t}\r\n\t\t\tif (this._fCache) {\r\n\t\t\t\tthis._fCache = {};\r\n\t\t\t}\r\n\t\t}\r\n\t\tfieldPromiseCallBackInternal(index, field, val) {\r\n\t\t\t_setFieldCache(this, index, field, val);\r\n\t\t}\r\n\t\trecordPromiseCallBackInternal(index, val) {\r\n\t\t\tthis._rCache[index] = val;\r\n\t\t}\r\n\t\tdispose() {\r\n\t\t\tsuper.dispose();\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.exports = CachedDataSource;\r\n}","'use strict';\r\n{\r\n\tconst {array, isDef, isPromise, getOrApply, applyChainSafe, emptyFn} = require('../internal/utils');\r\n\tconst sort = require('../internal/sort');\r\n\tconst EventTarget = require('../core/EventTarget');\r\n\r\n\tconst EVENT_TYPE = {\r\n\t\tUPDATE_LENGTH: 'update_length',\r\n\t\tUPDATED_LENGTH: 'updated_length',\r\n\t\tUPDATED_ORDER: 'updated_order',\r\n\t};\r\n\r\n\tfunction getValue(value, setPromiseBack) {\r\n\t\tvalue = getOrApply(value);\r\n\t\tif (isPromise(value)) {\r\n\t\t\tvalue = value.then((r) => {\r\n\t\t\t\tif (!isPromise(r)) {\r\n\t\t\t\t\tsetPromiseBack(r);\r\n\t\t\t\t}\r\n\t\t\t\treturn getValue(r, setPromiseBack);\r\n\t\t\t});\r\n\t\t\t//\r\n\t\t\tsetPromiseBack(value);\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\r\n\tfunction getField(record, field, setPromiseBack) {\r\n\t\tif (!isDef(record)) {\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\t\tif (isPromise(record)) {\r\n\t\t\treturn record.then((r) => getField(r, field, setPromiseBack));\r\n\t\t}\r\n\t\tif (field in record) {\r\n\t\t\treturn getValue(record[field], setPromiseBack);\r\n\t\t}\r\n\t\tif (typeof field === 'function') {\r\n\t\t\treturn getValue(field(record), setPromiseBack);\r\n\t\t}\r\n\r\n\t\tconst ss = (field + '').split('.');\r\n\t\tif (ss.length <= 1) {\r\n\t\t\treturn getValue(record[field], setPromiseBack);\r\n\t\t}\r\n\t\treturn getValue(applyChainSafe(record, (val, name) => getField(val, name, emptyFn), ...ss), setPromiseBack);\r\n\t}\r\n\tfunction setField(record, field, value) {\r\n\t\tif (field in record) {\r\n\t\t\trecord[field] = value;\r\n\t\t} else if (typeof field === 'function') {\r\n\t\t\treturn field(record, value);\r\n\t\t} else if (typeof field === 'string') {\r\n\t\t\tconst ss = (field + '').split('.');\r\n\t\t\tlet obj = record;\r\n\t\t\tconst {length} = ss;\r\n\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\tconst f = ss[i];\r\n\t\t\t\tif (i === length - 1) {\r\n\t\t\t\t\tobj[f] = value;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj = obj[f] || (obj[f] = {});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\trecord[field] = value;\r\n\t\t}\r\n\t\treturn true;\r\n\t}\r\n\tfunction _getIndex(dataSource, index) {\r\n\t\tif (!dataSource._sortedIndexMap) {\r\n\t\t\treturn index;\r\n\t\t}\r\n\t\tconst mapIndex = dataSource._sortedIndexMap[index];\r\n\t\treturn isDef(mapIndex) ? mapIndex : index;\r\n\t}\r\n\r\n\t/**\r\n\t * grid data source\r\n\t *\r\n\t * @classdesc cheetahGrid.data.DataSource\r\n\t * @extends EventTarget\r\n\t * @memberof cheetahGrid.data\r\n\t */\r\n\tclass DataSource extends EventTarget {\r\n\t\tstatic get EVENT_TYPE() {\r\n\t\t\treturn EVENT_TYPE;\r\n\t\t}\r\n\t\tstatic ofArray(array) {\r\n\t\t\treturn new DataSource({\r\n\t\t\t\tget: (index) => array[index],\r\n\t\t\t\tlength: array.length\r\n\t\t\t});\r\n\t\t}\r\n\t\tconstructor({get, length = 0} = {}) {\r\n\t\t\tsuper();\r\n\t\t\tthis._get = get;\r\n\t\t\tthis._length = length;\r\n\t\t\tthis._sortedIndexMap = false;\r\n\t\t}\r\n\t\tget(index) {\r\n\t\t\treturn this.getOriginal(_getIndex(this, index));\r\n\t\t}\r\n\t\tgetField(index, field) {\r\n\t\t\treturn this.getOriginalField(_getIndex(this, index), field);\r\n\t\t}\r\n\t\thasField(index, field) {\r\n\t\t\treturn this.hasOriginalField(_getIndex(this, index), field);\r\n\t\t}\r\n\t\tsetField(index, field, value) {\r\n\t\t\treturn this.setOriginalField(_getIndex(this, index), field, value);\r\n\t\t}\r\n\t\tsort(field, order) {\r\n\t\t\tconst sortedIndexMap = new Array(this._length);\r\n\r\n\t\t\tconst orderFn = order !== 'desc'\r\n\t\t\t\t? (v1, v2) => v1 === v2 ? 0 : v1 > v2 ? 1 : -1\r\n\t\t\t\t: (v1, v2) => v1 === v2 ? 0 : v1 < v2 ? 1 : -1;\r\n\r\n\t\t\treturn sort.sortPromise(\r\n\t\t\t\t\t(index) => isDef(sortedIndexMap[index])\r\n\t\t\t\t\t\t? sortedIndexMap[index]\r\n\t\t\t\t\t\t: (sortedIndexMap[index] = index),\r\n\t\t\t\t\t(index, rel) => {\r\n\t\t\t\t\t\tsortedIndexMap[index] = rel;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tthis._length,\r\n\t\t\t\t\torderFn,\r\n\t\t\t\t\t(index) => this.getOriginalField(index, field)\r\n\t\t\t).then(() => {\r\n\t\t\t\tthis._sortedIndexMap = sortedIndexMap;\r\n\t\t\t\tthis.fireListeners(EVENT_TYPE.UPDATED_ORDER);\r\n\t\t\t});\r\n\t\t}\r\n\t\tget length() {\r\n\t\t\treturn this._length;\r\n\t\t}\r\n\t\tset length(length) {\r\n\t\t\tconst results = this.fireListeners(EVENT_TYPE.UPDATE_LENGTH, length);\r\n\t\t\tif (array.findIndex(results, (v) => !v) >= 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tthis._length = length;\r\n\t\t\tthis.fireListeners(EVENT_TYPE.UPDATED_LENGTH, this._length);\r\n\t\t}\r\n\t\tdispose() {\r\n\t\t\tsuper.dispose();\r\n\t\t}\r\n\t\tgetOriginal(index) {\r\n\t\t\treturn getValue(this._get(index), (val) => {\r\n\t\t\t\tthis.recordPromiseCallBackInternal(index, val);\r\n\t\t\t});\r\n\t\t}\r\n\t\tgetOriginalField(index, field) {\r\n\t\t\tif (!isDef(field)) {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t\tconst record = this.getOriginal(index);\r\n\t\t\treturn getField(record, field, (val) => {\r\n\t\t\t\tthis.fieldPromiseCallBackInternal(index, field, val);\r\n\t\t\t});\r\n\t\t}\r\n\t\thasOriginalField(index, field) {\r\n\t\t\tif (!isDef(field)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (typeof field === 'function') {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\tconst record = this.getOriginal(index);\r\n\t\t\treturn field in record;\r\n\t\t}\r\n\t\tsetOriginalField(index, field, value) {\r\n\t\t\tif (!isDef(field)) {\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t\tconst record = this.getOriginal(index);\r\n\t\t\treturn setField(record, field, value);\r\n\t\t}\r\n\t\tfieldPromiseCallBackInternal(index, field, val) {\r\n\t\t\t//\r\n\t\t}\r\n\t\trecordPromiseCallBackInternal(index, val) {\r\n\t\t\t//\r\n\t\t}\r\n\t}\r\n\tDataSource.EMPTY = new DataSource({\r\n\t\tlength: 0,\r\n\t});\r\n\r\n\tmodule.exports = DataSource;\r\n}","'use strict';\r\n\r\nconst {isDef} = require('../internal/utils');\r\nclass Inline {\r\n\tconstructor(content) {\r\n\t\tthis._content = isDef(content) ? content : '';\r\n\t}\r\n\twidth({ctx}) {\r\n\t\treturn ctx.measureText(this._content).width;\r\n\t}\r\n\tfont() {\r\n\t\treturn null;\r\n\t}\r\n\tcolor() {\r\n\t\treturn null;\r\n\t}\r\n\tcanDraw() {\r\n\t\treturn true;\r\n\t}\r\n\tonReady(fn) {\r\n\t\t\r\n\t}\r\n\tdraw({\r\n\t\tctx,\r\n\t\tcanvashelper,\r\n\t\trect,\r\n\t\toffset,\r\n\t\toffsetLeft,\r\n\t\toffsetRight,\r\n\t}) {\r\n\t\tcanvashelper.fillTextRect(ctx, this._content,\r\n\t\t\t\trect.left, rect.top, rect.width, rect.height,\r\n\t\t\t\t{\r\n\t\t\t\t\toffset: offset + 1,\r\n\t\t\t\t\tpadding: {\r\n\t\t\t\t\t\tleft: offsetLeft,\r\n\t\t\t\t\t\tright: offsetRight,\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t}\r\n}\r\nmodule.exports = Inline;","'use strict';\r\n\r\n\r\nconst Inline = require('./Inline');\r\n\r\nclass InlineDrawer extends Inline {\r\n\tconstructor(\r\n\t\t\t{\r\n\t\t\t\tdraw,\r\n\t\t\t\twidth,\r\n\t\t\t\theight,\r\n\t\t\t\tcolor,\r\n\t\t\t}) {\r\n\t\tsuper();\r\n\t\t\r\n\t\tthis._draw = draw;\r\n\t\tthis._width = width;\r\n\t\tthis._height = height;\r\n\t\tthis._color = color;\r\n\t}\r\n\twidth({ctx}) {\r\n\t\treturn this._width;\r\n\t}\r\n\tfont() {\r\n\t\treturn null;\r\n\t}\r\n\tcolor() {\r\n\t\treturn this._color;\r\n\t}\r\n\tcanDraw() {\r\n\t\treturn true;\r\n\t}\r\n\tonReady(callback) {\r\n\t}\r\n\tdraw(\r\n\t\t\t{\r\n\t\t\t\tctx,\r\n\t\t\t\tcanvashelper,\r\n\t\t\t\trect,\r\n\t\t\t\toffset,\r\n\t\t\t\toffsetLeft,\r\n\t\t\t\toffsetRight,\r\n\t\t\t}) {\r\n\t\tthis._draw({\r\n\t\t\tctx,\r\n\t\t\tcanvashelper,\r\n\t\t\trect,\r\n\t\t\toffset,\r\n\t\t\toffsetLeft,\r\n\t\t\toffsetRight,\r\n\t\t});\r\n\t}\r\n}\r\n\r\nmodule.exports = InlineDrawer;","'use strict';\r\n\r\n\r\nconst Inline = require('./Inline');\r\nconst fonts = require('../internal/fonts');\r\n\r\nclass InlineIcon extends Inline {\r\n\tconstructor(icon) {\r\n\t\tsuper();\r\n\t\tthis._icon = icon || {};\r\n\t}\r\n\twidth({ctx}) {\r\n\t\tconst icon = this._icon;\r\n\t\tif (icon.width) {\r\n\t\t\treturn icon.width;\r\n\t\t}\r\n\t\tif (icon.font && fonts.check(icon.font, icon.content)) {\r\n\t\t\tctx.save();\r\n\t\t\ttry {\r\n\t\t\t\tctx.font = icon.font || ctx.font;\r\n\t\t\t\treturn ctx.measureText(icon.content).width;\r\n\t\t\t} finally {\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\tfont() {\r\n\t\treturn this._icon.font;\r\n\t}\r\n\tcolor() {\r\n\t\treturn this._icon.color;\r\n\t}\r\n\tcanDraw() {\r\n\t\tconst icon = this._icon;\r\n\t\treturn icon.font ? fonts.check(icon.font, icon.content) : true;\r\n\t}\r\n\tonReady(callback) {\r\n\t\tconst icon = this._icon;\r\n\t\tif (icon.font && !fonts.check(icon.font, icon.content)) {\r\n\t\t\tfonts.load(icon.font, icon.content, callback);\r\n\t\t}\r\n\t}\r\n\tdraw(\r\n\t\t\t{\r\n\t\t\t\tctx,\r\n\t\t\t\tcanvashelper,\r\n\t\t\t\trect,\r\n\t\t\t\toffset,\r\n\t\t\t\toffsetLeft,\r\n\t\t\t\toffsetRight,\r\n\t\t\t}) {\r\n\t\tconst icon = this._icon;\r\n\t\tif (icon.content) {\r\n\t\t\tcanvashelper.fillTextRect(ctx, icon.content,\r\n\t\t\t\t\trect.left, rect.top, rect.width, rect.height,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\toffset: offset + 1,\r\n\t\t\t\t\t\tpadding: {\r\n\t\t\t\t\t\t\tleft: offsetLeft,\r\n\t\t\t\t\t\t\tright: offsetRight,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports = InlineIcon;","'use strict';\r\n\r\nconst Inline = require('./Inline');\r\nconst {getCacheOrLoad} = require('../internal/imgs');\r\nconst {isPromise} = require('../internal/utils');\r\n\r\nclass InlineImage extends Inline {\r\n\tconstructor(\r\n\t\t\t{\r\n\t\t\t\tsrc,\r\n\t\t\t\twidth,\r\n\t\t\t\theight,\r\n\t\t\t\timageLeft,\r\n\t\t\t\timageTop,\r\n\t\t\t\timageWidth,\r\n\t\t\t\timageHeight,\r\n\t\t\t}) {\r\n\t\tsuper();\r\n\t\tthis._src = src;\r\n\t\tthis._width = width;\r\n\t\tthis._height = height;\r\n\t\tthis._imageLeft = imageLeft;\r\n\t\tthis._imageTop = imageTop;\r\n\t\tthis._imageWidth = imageWidth;\r\n\t\tthis._imageHeight = imageHeight;\r\n\r\n\t\tthis._onloaded = [];\r\n\r\n\r\n\t\tthis._loaded = false;\r\n\t\tif (isPromise(src)) {\r\n\t\t\tsrc.then((s) => {\r\n\t\t\t\tthis._src = s;\r\n\t\t\t\tthis._loadImage(s);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis._loadImage(src);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\t_loadImage(src) {\r\n\t\tconst img = this._inlineImg = getCacheOrLoad('InlineImage', 50, src);\r\n\t\tif (isPromise(img)) {\r\n\t\t\timg.then((i) => {\r\n\t\t\t\tthis._loaded = true;\r\n\t\t\t\tthis._inlineImg = i;\r\n\r\n\t\t\t\tthis._onloaded.forEach((fn) => fn());\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis._loaded = true;\r\n\t\t}\r\n\t}\r\n\twidth({ctx}) {\r\n\t\treturn this._width || (this._loaded ? this._inlineImg.width : 0);\r\n\t}\r\n\tfont() {\r\n\t\treturn null;\r\n\t}\r\n\tcolor() {\r\n\t\treturn null;\r\n\t}\r\n\tcanDraw() {\r\n\t\treturn this._loaded;\r\n\t}\r\n\tonReady(callback) {\r\n\t\tif (isPromise(this._src) || isPromise(this._inlineImg)) {\r\n\t\t\tthis._onloaded.push(() => callback());\r\n\t\t}\r\n\t}\r\n\tdraw(\r\n\t\t\t{\r\n\t\t\t\tctx,\r\n\t\t\t\tcanvashelper,\r\n\t\t\t\trect,\r\n\t\t\t\toffset,\r\n\t\t\t\toffsetLeft,\r\n\t\t\t\toffsetRight,\r\n\t\t\t}) {\r\n\t\tconst img = this._inlineImg;\r\n\t\tcanvashelper.drawInlineImageRect(ctx, img,\r\n\t\t\t\tthis._imageLeft || 0, this._imageTop || 0,\r\n\t\t\t\tthis._imageWidth || img.width, this._imageHeight || img.height,\r\n\t\t\t\tthis._width || img.width, this._height || img.height,\r\n\t\t\t\trect.left, rect.top, rect.width, rect.height,\r\n\t\t\t\t{\r\n\t\t\t\t\toffset: offset + 1,\r\n\t\t\t\t\tpadding: {\r\n\t\t\t\t\t\tleft: offsetLeft,\r\n\t\t\t\t\t\tright: offsetRight,\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t}\r\n}\r\n\r\nmodule.exports = InlineImage;","'use strict';\r\n\r\nconst Inline = require('./Inline');\r\nconst {calcStartPosition} = require('../internal/canvases');\r\nconst path2DManager = require('../internal/path2DManager');\r\n\r\nclass InlinePath2D extends Inline {\r\n\tconstructor(\r\n\t\t\t{\r\n\t\t\t\tpath,\r\n\t\t\t\twidth,\r\n\t\t\t\theight,\r\n\t\t\t\tcolor,\r\n\t\t\t}) {\r\n\t\tsuper();\r\n\t\t// IEPath2Dpolyfill\r\n\t\tthis._path = new path2DManager.Path2D(path);\r\n\t\tthis._width = width;\r\n\t\tthis._height = height;\r\n\t\tthis._color = color;\r\n\t}\r\n\twidth({ctx}) {\r\n\t\treturn this._width;\r\n\t}\r\n\tfont() {\r\n\t\treturn null;\r\n\t}\r\n\tcolor() {\r\n\t\treturn this._color;\r\n\t}\r\n\tcanDraw() {\r\n\t\treturn true;\r\n\t}\r\n\tonReady(callback) {\r\n\t}\r\n\tdraw({\r\n\t\tctx,\r\n\t\tcanvashelper,\r\n\t\trect,\r\n\t\toffset,\r\n\t\toffsetLeft,\r\n\t\toffsetRight\r\n\t}) {\r\n\t\toffset++;\r\n\t\tconst padding = {\r\n\t\t\tleft: offsetLeft,\r\n\t\t\tright: offsetRight,\r\n\t\t};\r\n\t\tctx.save();\r\n\t\ttry {\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.rect(rect.left, rect.top, rect.width, rect.height);\r\n\t\t\t//clip\r\n\t\t\tctx.clip();\r\n\r\n\t\t\t//\r\n\t\t\tconst pos = calcStartPosition(ctx, rect, this._width, this._height, {\r\n\t\t\t\toffset,\r\n\t\t\t\tpadding\r\n\t\t\t});\r\n\t\t\tctx.translate(pos.x, pos.y);\r\n\t\t\tctx.fill(this._path);\r\n\t\t} finally {\r\n\t\t\tctx.restore();\r\n\t\t}\r\n\t}\r\n}\r\n\r\nmodule.exports = InlinePath2D;","'use strict';\r\n\r\nconst InlineImage = require('./InlineImage');\r\nconst {then} = require('../internal/utils');\r\n\r\nfunction buildSvgDataUrl(svg) {\r\n\tconst data = (typeof svg === 'string') ? svg : new XMLSerializer().serializeToString(svg);\r\n\tconst url = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(data); //svgbase64\r\n\treturn url;\r\n}\r\nfunction getSvgElement(svg) {\r\n\tif (typeof svg === 'string') {\r\n\t\tconst parser = new DOMParser();\r\n\t\treturn parser.parseFromString(svg, 'image/svg+xml');\r\n\t} else {\r\n\t\treturn svg;\r\n\t}\r\n}\r\n\r\nclass InlineSvg extends InlineImage {\r\n\tconstructor(\r\n\t\t\t{\r\n\t\t\t\tsvg,\r\n\t\t\t\twidth,\r\n\t\t\t\theight,\r\n\t\t\t\timageLeft,\r\n\t\t\t\timageTop,\r\n\t\t\t\timageWidth,\r\n\t\t\t\timageHeight,\r\n\t\t\t}) {\r\n\t\tconst svgElem = then(svg, getSvgElement);\r\n\t\tconst elmWidth = svgElem.getAttribute ? svgElem.getAttribute('width') : null;\r\n\t\tconst elmHeight = svgElem.getAttribute ? svgElem.getAttribute('height') : null;\r\n\t\tsuper({\r\n\t\t\tsrc: then(svg, buildSvgDataUrl),\r\n\t\t\twidth: width || elmWidth,\r\n\t\t\theight: height || elmHeight,\r\n\t\t\timageWidth: elmWidth,\r\n\t\t\timageHeight: elmHeight,\r\n\t\t});\r\n\t}\r\n}\r\n\r\nmodule.exports = InlineSvg;","'use strict';\r\n\r\n\r\nconst Inline = require('./Inline');\r\nconst InlineIcon = require('./InlineIcon');\r\nconst InlineImage = require('./InlineImage');\r\nconst InlineSvg = require('./InlineSvg');\r\nconst InlineDrawer = require('./InlineDrawer');\r\nconst InlinePath2D = require('./InlinePath2D');\r\nconst {isDef} = require('../internal/utils');\r\nconst {calcStartPosition} = require('../internal/canvases');\r\nconst icons = require('../icons');\r\nconst path2DManager = require('../internal/path2DManager');\r\n\r\nfunction drawRegisteredIcon(ctx, icon,\r\n\t\tdrawWidth, drawHeight,\r\n\t\tleft, top, width, height,\r\n\t\t{\r\n\t\t\toffset = 2,\r\n\t\t\tpadding,\r\n\t\t} = {}) {\r\n\tconst rect = {\r\n\t\tleft,\r\n\t\ttop,\r\n\t\twidth,\r\n\t\theight,\r\n\t\tright: left + width,\r\n\t\tbottom: top + height,\r\n\t};\r\n\tctx.save();\r\n\ttry {\r\n\t\tctx.beginPath();\r\n\t\tctx.rect(rect.left, rect.top, rect.width, rect.height);\r\n\t\t//clip\r\n\t\tctx.clip();\r\n\r\n\t\t//\r\n\t\tconst pos = calcStartPosition(ctx, rect, drawWidth, drawHeight, {\r\n\t\t\toffset,\r\n\t\t\tpadding\r\n\t\t});\r\n\t\tpath2DManager.fill(icon, ctx, pos.x, pos.y, drawWidth, drawHeight);\r\n\t} finally {\r\n\t\tctx.restore();\r\n\t}\r\n}\r\n\r\n\r\nmodule.exports = {\r\n\ticonOf(icon) {\r\n\t\tif (icon instanceof Inline) {\r\n\t\t\treturn icon;\r\n\t\t}\r\n\t\tif (!icon) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (icon.font && icon.content) {\r\n\t\t\treturn new InlineIcon(icon);\r\n\t\t}\r\n\t\tif (icon.src) {\r\n\t\t\treturn new InlineImage({\r\n\t\t\t\tsrc: icon.src,\r\n\t\t\t\twidth: icon.width,\r\n\t\t\t\theight: icon.width,\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (icon.svg) {\r\n\t\t\treturn new InlineSvg({\r\n\t\t\t\tsvg: icon.svg,\r\n\t\t\t\twidth: icon.width,\r\n\t\t\t\theight: icon.width,\r\n\t\t\t});\r\n\t\t}\r\n\t\tif (icon.path) {\r\n\t\t\treturn new InlinePath2D({\r\n\t\t\t\tpath: icon.path,\r\n\t\t\t\twidth: icon.width,\r\n\t\t\t\theight: icon.width,\r\n\t\t\t\tcolor: icon.color,\r\n\t\t\t});\r\n\t\t}\r\n\t\tconst regedIcons = icons.get();\r\n\t\tif (icon.name && regedIcons[icon.name]) {\r\n\t\t\tconst regedIcon = regedIcons[icon.name];\r\n\t\t\tconst width = icon.width || Math.max(regedIcon.width, regedIcon.height);\r\n\t\t\treturn new InlineDrawer({\r\n\t\t\t\tdraw({\r\n\t\t\t\t\tctx,\r\n\t\t\t\t\tcanvashelper,\r\n\t\t\t\t\trect,\r\n\t\t\t\t\toffset,\r\n\t\t\t\t\toffsetLeft,\r\n\t\t\t\t\toffsetRight,\r\n\t\t\t\t}) {\r\n\t\t\t\t\tdrawRegisteredIcon(ctx, regedIcon,\r\n\t\t\t\t\t\t\twidth, width,\r\n\t\t\t\t\t\t\trect.left, rect.top, rect.width, rect.height,\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\toffset: offset + 1,\r\n\t\t\t\t\t\t\t\tpadding: {\r\n\t\t\t\t\t\t\t\t\tleft: offsetLeft,\r\n\t\t\t\t\t\t\t\t\tright: offsetRight,\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\twidth,\r\n\t\t\t\theight: width,\r\n\t\t\t\tcolor: icon.color,\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn new InlineIcon(icon);\r\n\t},\r\n\tof(content) {\r\n\t\tif (!isDef(content)) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tif (content instanceof Inline) {\r\n\t\t\treturn content;\r\n\t\t}\r\n\t\treturn new Inline(content);\r\n\t},\r\n\tbuildInlines(icons, inline) {\r\n\t\tconst result = [];\r\n\t\tif (icons) {\r\n\t\t\tresult.push(...(icons.map((icon) => this.iconOf(icon)).filter((e) => !!e)));\r\n\t\t}\r\n\t\tif (Array.isArray(inline) && inline.filter((il) => il instanceof Inline).length) {\r\n\t\t\tresult.push(...(inline.map((il) => this.of(il)).filter((e) => !!e)));\r\n\t\t} else {\r\n\t\t\tconst il = this.of(inline);\r\n\t\t\tif (il) {\r\n\t\t\t\tresult.push(il);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n};","'use strict';\r\n{\r\n\tconst BaseStyle = require('./style/BaseStyle');\r\n\tconst Style = require('./style/Style');\r\n\r\n\tconst style = {\r\n\t\tget BaseStyle() {\r\n\t\t\treturn BaseStyle;\r\n\t\t},\r\n\t\tget Style() {\r\n\t\t\treturn Style;\r\n\t\t},\r\n\t\tof(columnStyle, StyleClass) {\r\n\t\t\tif (columnStyle) {\r\n\t\t\t\tif (columnStyle instanceof Style) {\r\n\t\t\t\t\treturn columnStyle;\r\n\t\t\t\t} else if (typeof columnStyle === 'function') {\r\n\t\t\t\t\treturn style.of(columnStyle(), StyleClass);\r\n\t\t\t\t}\r\n\t\t\t\treturn new StyleClass(columnStyle);\r\n\t\t\t} else {\r\n\t\t\t\treturn StyleClass.DEFAULT;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tmodule.exports = style;\r\n}","'use strict';\r\n{\r\n\tconst EventTarget = require('../../core/EventTarget');\r\n\r\n\tconst EVENT_TYPE = {\r\n\t\tCHANGE_STYLE: 'change_style',\r\n\t};\r\n\r\n\tlet defaultStyle;\r\n\tclass BaseStyle extends EventTarget {\r\n\t\tstatic get EVENT_TYPE() {\r\n\t\t\treturn EVENT_TYPE;\r\n\t\t}\r\n\t\tstatic get DEFAULT() {\r\n\t\t\treturn defaultStyle ? defaultStyle : (defaultStyle = new BaseStyle());\r\n\t\t}\r\n\t\tconstructor(\r\n\t\t\t\t{\r\n\t\t\t\t\ttextAlign = 'left',\r\n\t\t\t\t\ttextBaseline = 'middle',\r\n\t\t\t\t\tbgColor\r\n\t\t\t\t} = {}) {\r\n\t\t\tsuper();\r\n\t\t\tthis._textAlign = textAlign;\r\n\t\t\tthis._textBaseline = textBaseline;\r\n\t\t\tthis._bgColor = bgColor;\r\n\t\t}\r\n\t\tget textAlign() {\r\n\t\t\treturn this._textAlign;\r\n\t\t}\r\n\t\tset textAlign(textAlign) {\r\n\t\t\tthis._textAlign = textAlign;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tget textBaseline() {\r\n\t\t\treturn this._textBaseline;\r\n\t\t}\r\n\t\tset textBaseline(textBaseline) {\r\n\t\t\tthis._textBaseline = textBaseline;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tget bgColor() {\r\n\t\t\treturn this._bgColor;\r\n\t\t}\r\n\t\tset bgColor(bgColor) {\r\n\t\t\tthis._bgColor = bgColor;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tdoChangeStyle() {\r\n\t\t\tthis.fireListeners(EVENT_TYPE.CHANGE_STYLE);\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new BaseStyle(this);\r\n\t\t}\r\n\t}\r\n\tmodule.exports = BaseStyle;\r\n}","'use strict';\r\n{\r\n\tconst BaseStyle = require('./BaseStyle');\r\n\tlet defaultStyle;\r\n\tclass Style extends BaseStyle {\r\n\t\tstatic get DEFAULT() {\r\n\t\t\treturn defaultStyle ? defaultStyle : (defaultStyle = new Style());\r\n\t\t}\r\n\t\tconstructor(style = {}) {\r\n\t\t\tsuper(style);\r\n\t\t\tthis._color = style.color;\r\n\t\t}\r\n\t\tget color() {\r\n\t\t\treturn this._color;\r\n\t\t}\r\n\t\tset color(color) {\r\n\t\t\tthis._color = color;\r\n\t\t\tthis.doChangeStyle();\r\n\t\t}\r\n\t\tclone() {\r\n\t\t\treturn new Style(this);\r\n\t\t}\r\n\t}\r\n\tmodule.exports = Style;\r\n}","'use strict';\r\n{\r\n\tconst Header = require('./type/Header');\r\n\tconst SortHeader = require('./type/SortHeader');\r\n\r\n\tconst type = {\r\n\t\tcreate(headerCell) {\r\n\t\t\tif (headerCell.sort) {\r\n\t\t\t\treturn new SortHeader(headerCell);\r\n\t\t\t}\r\n\t\t\treturn new Header(headerCell);\r\n\t\t}\r\n\t};\r\n\tmodule.exports = type;\r\n}","'use strict';\r\n{\r\n\tconst styleContents = require('../style');\r\n\tconst {Style} = styleContents;\r\n\r\n\tclass BaseHeader {\r\n\t\tconstructor(headerCell) {\r\n\t\t\tthis._headerCell = headerCell;\r\n\t\t\tthis.onDrawCell = this.onDrawCell.bind(this);//\r\n\t\t}\r\n\t\tget StyleClass() {\r\n\t\t\treturn Style;\r\n\t\t}\r\n\t\tonDrawCell(cellValue, info, context, grid) {\r\n\t\t\tconst {style, drawCellBase} = info;\r\n\t\t\tdelete info.getRecord;\r\n\t\t\tdelete info.style;\r\n\t\t\tconst helper = grid.getGridCanvasHelper();\r\n\t\t\tdrawCellBase();\r\n\t\t\t//\r\n\t\t\tthis.drawInternal(\r\n\t\t\t\t\tcellValue,\r\n\t\t\t\t\tcontext,\r\n\t\t\t\t\tstyleContents.of(style, this.StyleClass),\r\n\t\t\t\t\thelper,\r\n\t\t\t\t\tgrid,\r\n\t\t\t\t\tinfo\r\n\t\t\t);\r\n\t\t}\r\n\t\tdrawInternal(value, context, style, helper, grid, info) {\r\n\t\t\t\r\n\t\t}\r\n\t\tbindGridEvent(grid) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\tmodule.exports = BaseHeader;\r\n}","'use strict';\r\n{\r\n\tconst styleContents = require('../style');\r\n\tconst {Style} = styleContents;\r\n\tconst BaseHeader = require('./BaseHeader');\r\n\r\n\tclass Header extends BaseHeader {\r\n\t\tget StyleClass() {\r\n\t\t\treturn Style;\r\n\t\t}\r\n\t\tdrawInternal(value, context, style, helper, grid, {drawCellBase}) {\r\n\t\t\tconst {\r\n\t\t\t\ttextAlign,\r\n\t\t\t\ttextBaseline,\r\n\t\t\t\tcolor,\r\n\t\t\t\tfont,\r\n\t\t\t\tbgColor,\r\n\t\t\t} = style;\r\n\t\t\t\r\n\t\t\tif (bgColor) {\r\n\t\t\t\tdrawCellBase({\r\n\t\t\t\t\tbgColor,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\thelper.text(value, context, {\r\n\t\t\t\ttextAlign,\r\n\t\t\t\ttextBaseline,\r\n\t\t\t\tcolor,\r\n\t\t\t\tfont,\r\n\t\t\t});\r\n\t\t}\r\n\t\tbindGridEvent(grid) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\tmodule.exports = Header;\r\n}","'use strict';\r\n{\r\n\tconst styleContents = require('../style');\r\n\tconst {Style} = styleContents;\r\n\tconst BaseHeader = require('./BaseHeader');\r\n\tconst {isDef} = require('../../internal/utils');\r\n\tconst {EVENT_TYPE: {\r\n\t\tCLICK_CELL,\r\n\t\tMOUSEOVER_CELL,\r\n\t\tMOUSEOUT_CELL,\r\n\t\tMOUSEMOVE_CELL,\r\n\t}} = require('../../core/DrawGrid');\r\n\r\n\tclass SortHeader extends BaseHeader {\r\n\t\tconstructor(headerCell) {\r\n\t\t\tsuper(headerCell);\r\n\t\t\tthis._sort = headerCell.sort;\r\n\t\t\tthis._range = headerCell.range;\r\n\t\t}\r\n\t\tget StyleClass() {\r\n\t\t\treturn Style;\r\n\t\t}\r\n\t\tdrawInternal(value, context, style, helper, grid, {drawCellBase}) {\r\n\t\t\tconst {\r\n\t\t\t\ttextAlign,\r\n\t\t\t\ttextBaseline = 'middle',\r\n\t\t\t\tcolor,\r\n\t\t\t\tbgColor,\r\n\t\t\t\tfont,\r\n\t\t\t} = style;\r\n\t\t\t\r\n\t\t\tif (bgColor) {\r\n\t\t\t\tdrawCellBase({\r\n\t\t\t\t\tbgColor,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tconst state = grid.sortState;\r\n\t\t\tlet order = undefined;\r\n\t\t\tif (this._range.isCellInRange(state.col, this._range.startRow)) {\r\n\t\t\t\torder = state.order;\r\n\t\t\t}\r\n\r\n\t\t\tconst ctx = context.getContext();\r\n\t\t\tconst arrowSize = ctx.measureText('').width * 1.2;\r\n\r\n\t\t\thelper.text(value, context, {\r\n\t\t\t\ttextAlign,\r\n\t\t\t\ttextBaseline,\r\n\t\t\t\tcolor,\r\n\t\t\t\tfont,\r\n\t\t\t\ticons: [{\r\n\t\t\t\t\tname: isDef(order) ? (order === 'asc' ? 'arrow_downward' : 'arrow_upward') : null,\r\n\t\t\t\t\twidth: arrowSize,\r\n\t\t\t\t\tcolor: 'rgba(0, 0, 0, 0.38)',\r\n\t\t\t\t}],\r\n\t\t\t});\r\n\t\t}\r\n\t\t_executeSort(newState, grid) {\r\n\t\t\tif (typeof this._sort === 'function') {\r\n\t\t\t\tthis._sort(newState.order, newState.col, grid);\r\n\t\t\t} else {\r\n\t\t\t\tgrid.dataSource.sort(grid.getField(newState.col), newState.order);\r\n\t\t\t}\r\n\t\t}\r\n\t\tbindGridEvent(grid) {\r\n\t\t\treturn [\r\n\t\t\t\tgrid.listen(CLICK_CELL, (e) => {\r\n\t\t\t\t\tif (!this._range.isCellInRange(e.col, e.row)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst state = grid.sortState;\r\n\t\t\t\t\tlet newState;\r\n\t\t\t\t\tif (this._range.isCellInRange(state.col, e.row)) {\r\n\t\t\t\t\t\tnewState = {\r\n\t\t\t\t\t\t\tcol: this._range.startCol,\r\n\t\t\t\t\t\t\torder: state.order === 'asc' ? 'desc' : 'asc'\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tnewState = {\r\n\t\t\t\t\t\t\tcol: this._range.startCol,\r\n\t\t\t\t\t\t\torder: 'asc'\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgrid.sortState = newState;\r\n\t\t\t\t\tthis._executeSort(newState, grid);\r\n\t\t\t\t\tgrid.invalidateGridRect(0, 0, grid.colCount - 1, grid.rowCount - 1);\r\n\t\t\t\t}),\r\n\t\t\t\t// mouse move\r\n\t\t\t\tgrid.listen(MOUSEOVER_CELL, (e) => {\r\n\t\t\t\t\tif (!this._range.isCellInRange(e.col, e.row)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgrid.getElement().style.cursor = 'pointer';\r\n\t\t\t\t}),\r\n\t\t\t\t//MOUSEENTER'col-resize'move\r\n\t\t\t\tgrid.listen(MOUSEMOVE_CELL, (e) => {\r\n\t\t\t\t\tif (!this._range.isCellInRange(e.col, e.row)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!grid.getElement().style.cursor) {\r\n\t\t\t\t\t\tgrid.getElement().style.cursor = 'pointer';\r\n\t\t\t\t\t}\r\n\t\t\t\t}),\r\n\t\t\t\tgrid.listen(MOUSEOUT_CELL, (e) => {\r\n\t\t\t\t\tif (!this._range.isCellInRange(e.col, e.row)) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tgrid.getElement().style.cursor = '';\r\n\t\t\t\t}),\r\n\t\t\t];\r\n\t\t}\r\n\t}\r\n\tmodule.exports = SortHeader;\r\n}","/*eslint-disable camelcase*/\r\n'use strict';\r\n\r\nconst {extend} = require('./internal/utils');\r\nconst plugins = require('./plugins/icons');\r\nconst builtins = {\r\n\tget arrow_upward() {\r\n\t\treturn require('../../webpack-loader/svg-to-icon-js-loader!material-design-icons/navigation/svg/production/ic_arrow_upward_48px.svg');\r\n\t},\r\n\tget arrow_downward() {\r\n\t\treturn require('../../webpack-loader/svg-to-icon-js-loader!material-design-icons/navigation/svg/production/ic_arrow_downward_48px.svg');\r\n\t},\r\n\tget edit() {\r\n\t\treturn require('../../webpack-loader/svg-to-icon-js-loader!material-design-icons/image/svg/production/ic_edit_48px.svg');\r\n\t},\r\n\tget add() {\r\n\t\treturn require('../../webpack-loader/svg-to-icon-js-loader!material-design-icons/content/svg/production/ic_add_48px.svg');\r\n\t},\r\n\tget star() {\r\n\t\treturn require('../../webpack-loader/svg-to-icon-js-loader!material-design-icons/toggle/svg/production/ic_star_24px.svg');\r\n\t},\r\n\tget star_border() {\r\n\t\treturn require('../../webpack-loader/svg-to-icon-js-loader!material-design-icons/toggle/svg/production/ic_star_border_24px.svg');\r\n\t},\r\n\tget star_half() {\r\n\t\treturn require('../../webpack-loader/svg-to-icon-js-loader!material-design-icons/toggle/svg/production/ic_star_half_24px.svg');\r\n\t},\r\n};\r\n\r\nmodule.exports = {\r\n\tget() {\r\n\t\treturn extend(builtins, plugins);\r\n\t}\r\n};","'use strict';\r\n{\r\n\tconst {obj: {each}} = require('./utils');\r\n\tlet nextId = 1;\r\n\r\n\tclass EventHandler {\r\n\t\tconstructor() {\r\n\t\t\tthis._listeners = {};\r\n\t\t}\r\n\t\ton(target, type, listener, ...options) {\r\n\t\t\tif (target.addEventListener) {\r\n\t\t\t\ttarget.addEventListener(type, listener, ...options);\r\n\t\t\t}\r\n\t\t\tconst obj = {\r\n\t\t\t\ttarget, type, listener, options\r\n\t\t\t};\r\n\t\t\tconst id = nextId++;\r\n\t\t\tthis._listeners[id] = obj;\r\n\t\t\treturn id;\r\n\t\t}\r\n\t\ttryWithOffEvents(target, type, call) {\r\n\t\t\tconst list = [];\r\n\t\t\ttry {\r\n\t\t\t\teach(this._listeners, (obj) => {\r\n\t\t\t\t\tif (obj.target === target && obj.type === type) {\r\n\t\t\t\t\t\tif (obj.target.removeEventListener) {\r\n\t\t\t\t\t\t\tobj.target.removeEventListener(obj.type, obj.listener, ...obj.options);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlist.push(obj);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tcall();\r\n\t\t\t} finally {\r\n\t\t\t\tlist.forEach((obj) => {\r\n\t\t\t\t\tif (obj.target.addEventListener) {\r\n\t\t\t\t\t\tobj.target.addEventListener(obj.type, obj.listener, ...obj.options);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t\toff(id) {\r\n\t\t\tif (!id) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tconst obj = this._listeners[id];\r\n\t\t\tif (!obj) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tdelete this._listeners[id];\r\n\t\t\tif (obj.target.removeEventListener) {\r\n\t\t\t\tobj.target.removeEventListener(obj.type, obj.listener, ...obj.options);\r\n\t\t\t}\r\n\t\t}\r\n\t\tfire(target, type, ...args) {\r\n\t\t\teach(this._listeners, (obj) => {\r\n\t\t\t\tif (obj.target === target && obj.type === type) {\r\n\t\t\t\t\tobj.listener.call(obj.target, ...args);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\thasListener(target, type) {\r\n\t\t\tlet result = false;\r\n\t\t\teach(this._listeners, (obj) => {\r\n\t\t\t\tif (obj.target === target && obj.type === type) {\r\n\t\t\t\t\tresult = true;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tclear() {\r\n\t\t\teach(this._listeners, (obj) => {\r\n\t\t\t\tif (obj.target.removeEventListener) {\r\n\t\t\t\t\tobj.target.removeEventListener(obj.type, obj.listener, ...obj.options);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tthis._listeners = {};\r\n\t\t}\r\n\t\tdispose() {\r\n\t\t\tthis.clear();\r\n\t\t\tthis._listeners = null;\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.exports = EventHandler;\r\n}","'use strict';\r\n\r\nclass LRUCache {\r\n\tconstructor(cacheSize) {\r\n\t\tthis._list = [];\r\n\t\tthis._map = {};\r\n\t\tthis._cacheSize = cacheSize || 50;\r\n\t}\r\n\tget(key) {\r\n\t\tconst val = this._map[key];\r\n\t\tif (val) {\r\n\t\t\tconst idx = this._list.indexOf(key);\r\n\t\t\tthis._list.splice(idx, 1);\r\n\t\t\tthis._list.push(key);\r\n\t\t}\r\n\t\treturn val;\r\n\t}\r\n\tput(key, value) {\r\n\t\tif (this._map[key]) {\r\n\t\t\tconst idx = this._list.indexOf(key);\r\n\t\t\tthis._list.splice(idx, 1);\r\n\t\t}\r\n\t\tthis._map[key] = value;\r\n\t\tthis._list.push(key);\r\n\t\tif (this._list.length > this._cacheSize) {\r\n\t\t\tconst remKey = this._list.shift();\r\n\t\t\tdelete this._map[remKey];\r\n\t\t}\r\n\t}\r\n}\r\nmodule.exports = LRUCache;","'use strict';\r\n{\r\n\tconst indexFirst = (ary, elm) => {\r\n\t\tlet low = 0;\r\n\t\tlet high = ary.length - 1;\r\n\t\twhile (low <= high) {\r\n\t\t\tconst i = Math.floor((low + high) / 2);\r\n\t\t\tif (ary[i] === elm) {\r\n\t\t\t\treturn i;\r\n\t\t\t} else if (ary[i] > elm) {\r\n\t\t\t\thigh = i - 1;\r\n\t\t\t} else {\r\n\t\t\t\tlow = i + 1;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn high < 0 ? 0 : high;\r\n\t};\r\n\r\n\r\n\tclass NumberMap {\r\n\t\tconstructor() {\r\n\t\t\tthis._keys = [];\r\n\t\t\tthis._vals = {};\r\n\t\t\tthis._sorted = false;\r\n\t\t}\r\n\t\tput(key, value) {\r\n\t\t\tif (!(key in this._vals)) {\r\n\t\t\t\tthis._keys.push(key);\r\n\t\t\t\tthis._sorted = false;\r\n\t\t\t}\r\n\t\t\tthis._vals[key] = value;\r\n\t\t}\r\n\t\tget(key) {\r\n\t\t\treturn this._vals[key];\r\n\t\t}\r\n\t\teachAll(fn) {\r\n\t\t\tthis._keys.forEach((key) => {\r\n\t\t\t\tfn(this.get(key), key);\r\n\t\t\t});\r\n\t\t}\r\n\t\teach(keyFrom, keyTo, fn) {\r\n\t\t\tconst {_keys: keys} = this;\r\n\t\t\tconst {length} = keys;\r\n\t\t\tif (!this._sorted) {\r\n\t\t\t\tkeys.sort((a, b) => {\r\n\t\t\t\t\tif (a < b) { return -1; }\r\n\t\t\t\t\tif (a > b) { return 1; }\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t});\r\n\t\t\t\tthis._sorted = true;\r\n\t\t\t}\r\n\r\n\t\t\tfor (let i = indexFirst(keys, keyFrom); i < length; i++) {\r\n\t\t\t\tconst key = keys[i];\r\n\t\t\t\tif (keyFrom <= key && key <= keyTo) {\r\n\t\t\t\t\tfn(this.get(key), key);\r\n\t\t\t\t} else if (keyTo < key) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tmodule.exports = NumberMap;\r\n}","'use strict';\r\n{\r\n\tclass Rect {\r\n\t\tconstructor(left, top, width, height) {\r\n\t\t\tthis._left = left;\r\n\t\t\tthis._top = top;\r\n\t\t\tthis._width = width;\r\n\t\t\tthis._height = height;\r\n\t\t}\r\n\t\tstatic bounds(left, top, right, bottom) {\r\n\t\t\treturn new Rect(left, top, right - left, bottom - top);\r\n\t\t}\r\n\t\tstatic max(rect1, rect2) {\r\n\t\t\treturn Rect.bounds(\r\n\t\t\t\t\tMath.min(rect1.left, rect2.left),\r\n\t\t\t\t\tMath.min(rect1.top, rect2.top),\r\n\t\t\t\t\tMath.max(rect1.right, rect2.right),\r\n\t\t\t\t\tMath.max(rect1.bottom, rect2.bottom)\r\n\t\t\t);\r\n\t\t}\r\n\t\tget left() {\r\n\t\t\treturn this._left;\r\n\t\t}\r\n\t\tset left(left) {\r\n\t\t\tconst {right} = this;\r\n\t\t\tthis._left = left;\r\n\t\t\tthis.right = right;\r\n\t\t}\r\n\t\tget top() {\r\n\t\t\treturn this._top;\r\n\t\t}\r\n\t\tset top(top) {\r\n\t\t\tconst {bottom} = this;\r\n\t\t\tthis._top = top;\r\n\t\t\tthis.bottom = bottom;\r\n\t\t}\r\n\t\tget width() {\r\n\t\t\treturn this._width;\r\n\t\t}\r\n\t\tset width(width) {\r\n\t\t\tthis._width = width;\r\n\t\t\tthis._right = undefined;\r\n\t\t}\r\n\t\tget height() {\r\n\t\t\treturn this._height;\r\n\t\t}\r\n\t\tset height(height) {\r\n\t\t\tthis._height = height;\r\n\t\t\tthis._bottom = undefined;\r\n\t\t}\r\n\t\tget right() {\r\n\t\t\treturn this._right !== undefined ? this._right : (this._right = this.left + this.width);\r\n\t\t}\r\n\t\tset right(right) {\r\n\t\t\tthis._right = right;\r\n\t\t\tthis.width = right - this.left;\r\n\t\t}\r\n\t\tget bottom() {\r\n\t\t\treturn this._bottom !== undefined ? this._bottom : (this._bottom = this.top + this.height);\r\n\t\t}\r\n\t\tset bottom(bottom) {\r\n\t\t\tthis._bottom = bottom;\r\n\t\t\tthis.height = bottom - this.top;\r\n\t\t}\r\n\t\toffsetLeft(offset) {\r\n\t\t\tthis._left += offset;\r\n\t\t\tthis._right = undefined;\r\n\t\t}\r\n\t\toffsetTop(offset) {\r\n\t\t\tthis._top += offset;\r\n\t\t\tthis._bottom = undefined;\r\n\t\t}\r\n\t\tcopy() {\r\n\t\t\treturn new Rect(this.left, this.top, this.width, this.height);\r\n\t\t}\r\n\t\tintersection(rect) {\r\n\t\t\tconst x0 = Math.max(this.left, rect.left);\r\n\t\t\tconst x1 = Math.min(this.left + this.width, rect.left + rect.width);\r\n\t\t\tif (x0 <= x1) {\r\n\t\t\t\tconst y0 = Math.max(this.top, rect.top);\r\n\t\t\t\tconst y1 = Math.min(this.top + this.height, rect.top + rect.height);\r\n\t\t\t\tif (y0 <= y1) {\r\n\t\t\t\t\treturn Rect.bounds(x0, y0, x1, y1);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tcontains(another) {\r\n\t\t\treturn this.left <= another.left &&\r\n\t\t\t\t\tthis.left + this.width >= another.left + another.width &&\r\n\t\t\t\t\tthis.top <= another.top &&\r\n\t\t\t\t\tthis.top + this.height >= another.top + another.height;\r\n\t\t}\r\n\t\tinPoint(x, y) {\r\n\t\t\treturn this.left <= x &&\r\n\t\t\t\t\tthis.left + this.width >= x &&\r\n\t\t\t\t\tthis.top <= y &&\r\n\t\t\t\t\tthis.top + this.height >= y;\r\n\t\t}\r\n\t}\r\n\tmodule.exports = Rect;\r\n}","'use strict';\r\n{\r\n\tconst EventHandler = require('./EventHandler');\r\n\tconst style = require('./style');\r\n\tconst {browser} = require('./utils');\r\n\t\r\n\tconst MAX_SCROLL = browser.heightLimit - 1000;\r\n\r\n\tfunction _update(scrollable) {\r\n\t\tlet domHeight;\r\n\t\tif (scrollable._height > MAX_SCROLL) {\r\n\t\t\tconst sbSize = style.getScrollBarSize();\r\n\t\t\tconst offsetHeight = scrollable._scrollable.offsetHeight;\r\n\t\t\tconst vScrollRange = MAX_SCROLL - offsetHeight + sbSize;\r\n\t\t\tconst rScrollRange = scrollable._height - offsetHeight + sbSize;\r\n\t\t\tscrollable._p = vScrollRange / rScrollRange;\r\n\t\t\tdomHeight = MAX_SCROLL;\r\n\t\t} else {\r\n\t\t\tscrollable._p = 1;\r\n\t\t\tdomHeight = scrollable._height;\r\n\t\t}\r\n\r\n\t\tscrollable._endPointElement.style.top = domHeight.toFixed() + 'px';\r\n\t\tscrollable._endPointElement.style.left = scrollable._width.toFixed() + 'px';\r\n\t\t\r\n\t}\r\n\r\n\tclass Scrollable {\r\n\t\tconstructor() {\r\n\t\t\tthis._handler = new EventHandler();\r\n\r\n\t\t\tthis._scrollable = document.createElement('div');\r\n\t\t\tthis._scrollable.classList.add('grid-scrollable');\r\n\t\t\tthis._height = 0;\r\n\t\t\tthis._width = 0;\r\n\r\n\t\t\tthis._endPointElement = document.createElement('div');\r\n\t\t\tthis._endPointElement.classList.add('grid-scroll-end-point');\r\n\t\t\t_update(this);\r\n\t\t\tthis._scrollable.appendChild(this._endPointElement);\r\n\r\n\t\t\t// const mousewheelevt = (/Firefox/i.test(navigator.userAgent)) ? 'DOMMouseScroll' : 'mousewheel'; //FF doesn't recognize mousewheel as of FF3.x\r\n\t\t\t// this._handler.on(this._scrollable, mousewheelevt, (evt) => {\r\n\t\t\t// const delta = evt.detail ? evt.detail * (-120) : evt.wheelDelta;\r\n\t\t\t// const point = Math.min(Math.abs(delta) / 12, this.scrollHeight / 5);\r\n\t\t\t// this.scrollTop += delta < 0 ? point : -point;\r\n\t\t\t// });\r\n\t\t}\r\n\t\tcalcTop(top) {\r\n\t\t\tconst relativeTop = top - this.scrollTop;\r\n\t\t\treturn this._scrollable.scrollTop + relativeTop;\r\n\t\t}\r\n\t\tgetElement() {\r\n\t\t\treturn this._scrollable;\r\n\t\t}\r\n\t\tsetScrollSize(width, height) {\r\n\t\t\tthis._width = width;\r\n\t\t\tthis._height = height;\r\n\t\t\t_update(this);\r\n\t\t}\r\n\t\tget scrollWidth() {\r\n\t\t\treturn this._width;\r\n\t\t}\r\n\t\tset scrollWidth(width) {\r\n\t\t\tthis._width = width;\r\n\t\t\t_update(this);\r\n\t\t}\r\n\t\tget scrollHeight() {\r\n\t\t\treturn this._height;\r\n\t\t}\r\n\t\tset scrollHeight(height) {\r\n\t\t\tthis._height = height;\r\n\t\t\t_update(this);\r\n\t\t}\r\n\t\tget scrollLeft() {\r\n\t\t\treturn Math.ceil(this._scrollable.scrollLeft);\r\n\t\t}\r\n\t\tset scrollLeft(scrollLeft) {\r\n\t\t\tthis._scrollable.scrollLeft = scrollLeft;\r\n\t\t}\r\n\t\tget scrollTop() {\r\n\t\t\treturn Math.ceil(this._scrollable.scrollTop / this._p);\r\n\t\t}\r\n\t\tset scrollTop(scrollTop) {\r\n\t\t\tthis._scrollable.scrollTop = scrollTop * this._p;\r\n\t\t}\r\n\t\tonScroll(fn) {\r\n\t\t\tthis._handler.on(this._scrollable, 'scroll', fn);\r\n\t\t}\r\n\t\tdispose() {\r\n\t\t\tthis._handler.dispose();\r\n\t\t}\r\n\t}\r\n\r\n\r\n\tmodule.exports = Scrollable;\r\n}","'use strict';\r\n{\r\n\tfunction cubicBezier(x2, y2, x3, y3) {\r\n\t\tlet step;\r\n\t\tconst err = 0.0001;\r\n\r\n\t\tx2 *= 3;\r\n\t\ty2 *= 3;\r\n\t\tx3 *= 3;\r\n\t\ty3 *= 3;\r\n\t\t\t\r\n\t\treturn function(t) {\r\n\t\t\tlet p,\r\n\t\t\t\ta,\r\n\t\t\t\tb,\r\n\t\t\t\tc,\r\n\t\t\t\td,\r\n\t\t\t\tx,\r\n\t\t\t\ts;\r\n\t\t\tif (t < 0 || 1 < t) {\r\n\t\t\t\tthrow new Error(t);\r\n\t\t\t}\r\n\t\t\t\t\r\n\t\t\tp = step || t;\r\n\r\n\t\t\tdo {\r\n\t\t\t\ta = 1 - p;\r\n\t\t\t\tb = a * a;\r\n\t\t\t\tc = p * p;\r\n\t\t\t\td = c * p;\r\n\t\t\t\t\t\r\n\t\t\t\tx = x2 * b * p + x3 * a * c + d;\r\n\t\t\t\ts = t - x;\r\n\t\t\t\tp += s * 0.5;\r\n\t\t\t} while (err < Math.abs(s));\r\n\r\n\t\t\tstep = p;\r\n\t\t\treturn\ty2 * b * p + y3 * a * c + d;\r\n\t\t};\r\n\t}\r\n\tconst EASINGS = {\r\n\t\tlinear(p) {\r\n\t\t\treturn p;\r\n\t\t},\r\n\t\teaseIn: cubicBezier(0.420, 0.000, 1.000, 1.000),\r\n\t\teaseOut: cubicBezier(0.000, 0.000, 0.580, 1.000),\r\n\t\teaseInOut: cubicBezier(0.420, 0.000, 0.580, 1.000),\r\n\t};\r\n\r\n\tconst raf = window.requestAnimationFrame || setTimeout;\r\n\t\r\n\tfunction now() {\r\n\t\treturn Date.now();\r\n\t}\r\n\t/**\r\n\t * <pre>\r\n\t * Animates.\r\n\t * </pre>\r\n\t * @function\r\n\t * @param {number} duration animation time.\r\n\t * @param {function} step\r\n\t * @param {function|string} easing\r\n\t * @returns {object} Deferred object.\r\n\t */\r\n\tmodule.exports = (duration, step, easing) => {\r\n\t\tconst startedAt = now();\r\n\r\n\t\tif (!easing) {\r\n\t\t\teasing = EASINGS.easeInOut;\r\n\t\t} else if (typeof easing === 'string') {\r\n\t\t\teasing = EASINGS[easing];\r\n\t\t}\r\n\r\n\t\tlet canceledFlg = false;\r\n\t\tconst createAnim = (resolve, reject) => {\r\n\t\t\tconst anim = () => {\r\n\t\t\t\tconst point = now() - startedAt;\r\n\t\t\t\tif (canceledFlg) {\r\n\t\t\t\t\t//cancel\r\n\t\t\t\t\tif (reject) { reject(); }\r\n\t\t\t\t} else if (point >= duration) {\r\n\t\t\t\t\t//end\r\n\t\t\t\t\tstep(1);\r\n\t\t\t\t\tif (resolve) { resolve(); }\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstep(easing(point / duration));\r\n\r\n\t\t\t\t\traf(anim, 1);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t\treturn anim;\r\n\t\t};\r\n\t\tconst cancel = () => {\r\n\t\t\tcanceledFlg = true;\r\n\t\t};\r\n\t\tif (window.Promise) {\r\n\t\t\tconst result = new window.Promise((resolve, reject) => {\r\n\t\t\t\tconst anim = createAnim(resolve, reject);\r\n\t\t\t\tstep(0);\r\n\t\t\t\tanim();\r\n\t\t\t});\r\n\t\t\tresult.cancel = cancel;\r\n\t\t\treturn result;\r\n\t\t} else {\r\n\t\t\tconst anim = createAnim(() => {}, () => {});\r\n\t\t\tstep(0);\r\n\t\t\tanim();\r\n\t\t\treturn {\r\n\t\t\t\tcancel,\r\n\t\t\t};\r\n\t\t}\r\n\t};\r\n}","'use strict';\r\n\r\nfunction parse(calcStr) {\r\n\tfunction replacer(match, num, unit) {\r\n\t\tswitch (unit) {\r\n\t\tcase '%':\r\n\t\t\treturn `(${num} * this.full / 100)`;\r\n\t\tcase 'em':\r\n\t\t\treturn `(${num} * this.em)`;\r\n\t\tcase 'px':\r\n\t\t\treturn `(${num})`;\r\n\t\tdefault:\r\n\t\t\tthrow new Error('calc error');\r\n\t\t}\r\n\t}\r\n\tconst script = calcStr.replace(/^calc\\((.*)\\)$/, '$1').\r\n\t\treplace(/(\\d+)([A-Za-z%]+)/g, replacer).\r\n\t\treplace(/(\\d*\\.\\d+)([A-Za-z%]+)/g, replacer);\r\n\treturn {\r\n\t\teval(context) {\r\n\t\t\treturn (() => {\r\n\t\t\t\tfunction calc(v) { // eslint-disable-line no-unused-vars\r\n\t\t\t\t\treturn v;\r\n\t\t\t\t}\r\n\t\t\t\treturn eval(script);// eslint-disable-line no-eval\r\n\t\t\t}).call(context);\r\n\t\t}\r\n\t};\r\n}\r\nfunction toPx(value, context) {\r\n\tif (/^calc\\(.*\\)$/.test(value)) {\r\n\t\treturn parse(value).eval(context);\r\n\t}\r\n\tif (/^[+-]?\\d+\\.?\\d*%$/.test(value)) {\r\n\t\treturn context.full * value.substr(0, value.length - 1) / 100;\r\n\t}\r\n\tif (/^[+-]?\\d+\\.?\\d*px$/.test(value)) {\r\n\t\treturn value.substr(0, value.length - 2) - 0;\r\n\t}\r\n\tif (/^[+-]?\\d+\\.?\\d*em$/.test(value)) {\r\n\t\treturn context.em * (value.substr(0, value.length - 2) - 0);\r\n\t}\r\n\treturn value - 0;\r\n}\r\n\r\nmodule.exports = {\r\n\tparse,\r\n\ttoPx(value, context) {\r\n\t\tif (typeof value === 'string') {\r\n\t\t\treturn toPx(value.trim(), context);\r\n\t\t}\r\n\t\treturn value - 0;\r\n\t}\r\n};","'use strict';\r\n{\r\n\r\n\tfunction calcBasePosition(ctx, rect,\r\n\t\t\t{\r\n\t\t\t\toffset = 0,\r\n\t\t\t\tpadding: {\r\n\t\t\t\t\tleft: paddingLeft = 0,\r\n\t\t\t\t\tright: paddingRight = 0,\r\n\t\t\t\t} = {},\r\n\t\t\t} = {}) {\r\n\t\t// const textAlign = ctx.textAlign || 'left';\r\n\t\t// const textBaseline = ctx.textBaseline || 'middle';\r\n\t\t// ctx.textAlign = textAlign;\r\n\t\t// ctx.textBaseline = textBaseline;\r\n\r\n\t\t// let x = rect.left + offset + paddingLeft;\r\n\t\t// if (textAlign === 'right' || textAlign === 'end') {\r\n\t\t// \tx = rect.right - offset - paddingRight;\r\n\t\t// } else if (textAlign === 'center') {\r\n\t\t// \tx = rect.left + ((rect.width + paddingLeft - paddingRight) / 2);\r\n\t\t// }\r\n\t\t// let y = rect.top + offset;\r\n\t\t// if (textBaseline === 'bottom' || textBaseline === 'alphabetic' || textBaseline === 'ideographic') {\r\n\t\t// \ty = rect.bottom - offset;\r\n\t\t// } else if (textBaseline === 'middle') {\r\n\t\t// \ty = rect.top + (rect.height / 2);\r\n\t\t// }\r\n\t\t// return {x, y};\r\n\t\treturn calcStartPosition(ctx, rect, 0, 0, {\r\n\t\t\toffset,\r\n\t\t\tpadding: {\r\n\t\t\t\tleft: paddingLeft,\r\n\t\t\t\tright: paddingRight,\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tfunction calcStartPosition(ctx, rect, width, height,\r\n\t\t\t{\r\n\t\t\t\toffset = 0,\r\n\t\t\t\tpadding: {\r\n\t\t\t\t\tleft: paddingLeft = 0,\r\n\t\t\t\t\tright: paddingRight = 0,\r\n\t\t\t\t} = {},\r\n\t\t\t} = {}) {\r\n\t\tconst textAlign = ctx.textAlign || 'left';\r\n\t\tconst textBaseline = ctx.textBaseline || 'middle';\r\n\t\tctx.textAlign = textAlign;\r\n\t\tctx.textBaseline = textBaseline;\r\n\r\n\t\tlet x = rect.left + offset + paddingLeft;\r\n\t\tif (textAlign === 'right' || textAlign === 'end') {\r\n\t\t\tx = rect.right - width - offset - paddingRight;\r\n\t\t} else if (textAlign === 'center') {\r\n\t\t\tx = rect.left + ((rect.width - width + paddingLeft - paddingRight) / 2);\r\n\t\t}\r\n\t\tlet y = rect.top + offset;\r\n\t\tif (textBaseline === 'bottom' || textBaseline === 'alphabetic' || textBaseline === 'ideographic') {\r\n\t\t\ty = rect.bottom - height - offset;\r\n\t\t} else if (textBaseline === 'middle') {\r\n\t\t\ty = rect.top + ((rect.height - height) / 2);\r\n\t\t}\r\n\t\treturn {x, y};\r\n\t}\r\n\r\n\tmodule.exports = {\r\n\t\tcalcBasePosition,\r\n\t\tcalcStartPosition,\r\n\t};\r\n}","'use strict';\r\n{\r\n\tconst rgbMap = {};\r\n\tfunction styleColorToRGB(color) {\r\n\t\tconst dummy = document.createElement('div');\r\n\t\tconst {style} = dummy;\r\n\t\tstyle.color = color;\r\n\t\tstyle.position = 'fixed';\r\n\t\tstyle.height = '1px';\r\n\t\tstyle.width = '1px';\r\n\t\tstyle.opacity = 0;\r\n\t\tdocument.body.appendChild(dummy);\r\n\t\tconst {color: styleColor} = document.defaultView.getComputedStyle(dummy, '');\r\n\t\tdocument.body.removeChild(dummy);\r\n\t\treturn colorToRGB0(styleColor);\r\n\t}\r\n\r\n\tfunction hexToNum(hex) {\r\n\t\treturn parseInt(hex, 16);\r\n\t}\r\n\tfunction createRGB(r, g, b, a = 1) {\r\n\t\treturn {r, g, b, a};\r\n\t}\r\n\tfunction tripleHexToRGB({1: r, 2: g, 3: b}) {\r\n\t\treturn createRGB(hexToNum(r + r), hexToNum(g + g), hexToNum(b + b));\r\n\t}\r\n\tfunction sextupleHexToRGB({1: r1, 2: r2, 3: g1, 4: g2, 5: b1, 6: b2}) {\r\n\t\treturn createRGB(hexToNum(r1 + r2), hexToNum(g1 + g2), hexToNum(b1 + b2));\r\n\t}\r\n\t\r\n\tfunction testRGB({r, g, b, a}) {\r\n\t\treturn 0 <= r && r <= 255 &&\r\n\t\t0 <= g && g <= 255 &&\r\n\t\t0 <= b && b <= 255 &&\r\n\t\t0 <= a && a <= 1;\r\n\t}\r\n\tfunction rateToByte(r) {\r\n\t\treturn Math.ceil(r * 255 / 100);\r\n\t}\r\n\tfunction colorToRGB0(color) {\r\n\t\tif (color.match(/^#[0-9a-f]{3}$/i)) {\r\n\t\t\treturn tripleHexToRGB(color);\r\n\t\t}\r\n\t\tif (color.match(/^#[0-9a-f]{6}$/i)) {\r\n\t\t\treturn sextupleHexToRGB(color);\r\n\t\t}\r\n\t\tlet ret = color.match(/^rgb\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*\\)$/i);\r\n\t\tif (ret) {\r\n\t\t\tconst rgb = createRGB(ret[1] - 0, ret[2] - 0, ret[3] - 0);\r\n\t\t\tif (testRGB(rgb)) {\r\n\t\t\t\treturn rgb;\r\n\t\t\t}\r\n\t\t}\r\n\t\tret = color.match(/^rgba\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3})\\s*,\\s*(\\d(\\.\\d)?)\\s*\\)$/i);\r\n\t\tif (ret) {\r\n\t\t\tconst rgb = createRGB(ret[1] - 0, ret[2] - 0, ret[3] - 0, ret[4] - 0);\r\n\t\t\tif (testRGB(rgb)) {\r\n\t\t\t\treturn rgb;\r\n\t\t\t}\r\n\t\t}\r\n\t\tret = color.match(/^rgb\\(\\s*(\\d{1,3}(\\.\\d)?)%\\s*,\\s*(\\d{1,3}(\\.\\d)?)%\\s*,\\s*(\\d{1,3}(\\.\\d)?)%\\s*\\)$/i);\r\n\t\tif (ret) {\r\n\t\t\tconst rgb = createRGB(rateToByte(ret[1]), rateToByte(ret[3]), rateToByte(ret[5]));\r\n\t\t\tif (testRGB(rgb)) {\r\n\t\t\t\treturn rgb;\r\n\t\t\t}\r\n\t\t}\r\n\t\tret = color.match(/^rgba\\(\\s*(\\d{1,3}(\\.\\d)?)%\\s*,\\s*(\\d{1,3}(\\.\\d)?)%\\s*,\\s*(\\d{1,3}(\\.\\d)?)%\\s*,\\s*(\\d(\\.\\d)?)\\s*\\)$/i);\r\n\t\tif (ret) {\r\n\t\t\tconst rgb = createRGB(rateToByte(ret[1]), rateToByte(ret[3]), rateToByte(ret[5]), ret[7] - 0);\r\n\t\t\tif (testRGB(rgb)) {\r\n\t\t\t\treturn rgb;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\tfunction colorToRGB(color) {\r\n\t\tif (typeof color !== 'string') {\r\n\t\t\treturn createRGB(0, 0, 0, 0);\r\n\t\t}\r\n\t\tcolor = color.toLowerCase().trim();\r\n\t\tif (rgbMap[color]) {\r\n\t\t\treturn rgbMap[color];\r\n\t\t}\r\n\t\treturn colorToRGB0(color) || (rgbMap[color] = styleColorToRGB(color));\r\n\t}\r\n\r\n\tmodule.exports = {\r\n\t\tcolorToRGB\r\n\t};\r\n}","'use strict';\r\n\r\nmodule.exports = {\r\n\t'Array_isArray': window.Array.isArray\r\n};","'use strict';\r\n\r\nconst {isDef} = require('./utils');\r\n\r\nfunction createElement(tagName, {classList, text, html} = {}) {\r\n\tconst element = document.createElement(tagName);\r\n\tif (classList) {\r\n\t\tif (Array.isArray(classList)) {\r\n\t\t\telement.classList.add(...classList);\r\n\t\t} else {\r\n\t\t\telement.classList.add(classList);\r\n\t\t}\r\n\t}\r\n\tif (text) {\r\n\t\telement.textContent = text;\r\n\t} else if (html) {\r\n\t\telement.innerHTML = html;\r\n\t}\r\n\treturn element;\r\n}\r\n\r\nfunction empty(dom) {\r\n\tlet c;\r\n\twhile ((c = dom.firstChild)) {\r\n\t\tdom.removeChild(c);\r\n\t}\r\n}\r\nfunction isNode(arg) {\r\n\treturn !!(arg.nodeType && arg.nodeName);\r\n}\r\nfunction toNode(arg) {\r\n\tif (isNode(arg)) {\r\n\t\treturn arg;\r\n\t}\r\n\tconst dom = createElement('div', {html: arg});\r\n\treturn Array.prototype.slice.call(dom.childNodes);\r\n}\r\nfunction toNodeList(arg) {\r\n\tif ((window.jQuery && arg instanceof window.jQuery)) {\r\n\t\treturn Array.prototype.map.call(arg, (a) => a);\r\n\t}\r\n\tif (Array.isArray(arg)) {\r\n\t\treturn arg.map(toNode);\r\n\t}\r\n\treturn [toNode(arg)];\r\n}\r\n\r\nfunction appendHtml(dom, inner) {\r\n\ttoNodeList(inner).forEach((node) => {\r\n\t\tdom.appendChild(node);\r\n\t});\r\n}\r\n\r\nfunction disableFocus(el) {\r\n\tel.dataset.disableBeforeTabIndex = el.tabIndex;\r\n\tel.tabIndex = -1;\r\n\tArray.prototype.slice.call(el.children, 0).forEach(disableFocus);\r\n}\r\nfunction enableFocus(el) {\r\n\tif ('disableBeforeTabIndex' in el.dataset) {\r\n\t\tel.tabIndex = el.dataset.disableBeforeTabIndex;\r\n\t}\r\n\tArray.prototype.slice.call(el.children, 0).forEach(enableFocus);\r\n}\r\n\r\nfunction isFocusable(el) {\r\n\treturn isDef(el.tabIndex) && el.tabIndex > -1;\r\n}\r\nfunction findPrevSiblingFocusable(el) {\r\n\tlet n = el.previousSibling;\r\n\twhile (n && !isFocusable(n)) {\r\n\t\tn = n.previousSibling;\r\n\t}\r\n\treturn n;\r\n}\r\nfunction findNextSiblingFocusable(el) {\r\n\tlet n = el.nextSibling;\r\n\twhile (n && !isFocusable(n)) {\r\n\t\tn = n.nextSibling;\r\n\t}\r\n\treturn n;\r\n}\r\n\r\nmodule.exports = {\r\n\tcreateElement,\r\n\tempty,\r\n\tisNode,\r\n\ttoNode,\r\n\ttoNodeList,\r\n\tappendHtml,\r\n\tdisableFocus,\r\n\tenableFocus,\r\n\tisFocusable,\r\n\tfindPrevSiblingFocusable,\r\n\tfindNextSiblingFocusable,\r\n};","'use strict';\r\n{\r\n\tconst loads = {};\r\n\tconst legacy = !document.fonts;\r\n\tconst load = legacy ? function(font, testStr, callback) {\r\n\t\t//for legacy(IE)\r\n\t\tif (loads[font + ' @ ' + testStr]) {\r\n\t\t\tcallback();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\trequire('./legacy/fontwatch/FontWatchRunner').load(font, testStr, () => {\r\n\t\t\tloads[font + ' @ ' + testStr] = true;\r\n\t\t\tcallback();\r\n\t\t}, () => {\r\n\t\t\tloads[font + ' @ ' + testStr] = true;\r\n\t\t\tcallback();\r\n\t\t});\r\n\t} : function(font, testStr, callback) {\r\n\t\tif (loads.all || loads[font]) {\r\n\t\t\tcallback();\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tdocument.fonts.ready.then(() => {\r\n\t\t\tloads.all = true;\r\n\t\t});\r\n\t\tdocument.fonts.load(font).then(() => {\r\n\t\t\tloads[font] = true;\r\n\t\t\tcallback();\r\n\t\t});\r\n\t};\r\n\tconst check = legacy ? function(font, testStr) {\r\n\t\t//for legacy(IE)\r\n\t\tif (loads[font + ' @ ' + testStr]) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tload(font, testStr, () => {});\r\n\t\treturn false;\r\n\t} : function(font, testStr) {\r\n\t\tif (loads.all || loads[font]) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tif (!document.fonts.check(font)) {\r\n\t\t\tload(font, testStr, () => {});\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\treturn true;\r\n\t};\r\n\r\n\t\r\n\tmodule.exports = {\r\n\t\tcheck,\r\n\t\tload\r\n\t};\r\n}","'use strict';\r\n\r\nconst EventHandler = require('./EventHandler');\r\nconst handler = new EventHandler();\r\n\r\nlet ratio;\r\nfunction setRatio() {\r\n\tratio = Math.ceil(window.devicePixelRatio || 1);\r\n\tif (ratio > 1 && (ratio % 2) !== 0) {\r\n\t\tratio += 1;\r\n\t}\r\n}\r\nsetRatio();\r\nhandler.on(window, 'resize', setRatio);\r\n\r\nmodule.exports = {\r\n\ttransform(canvas) {\r\n\t\tconst ctx = canvas.getContext('2d');\r\n\r\n\t\tconst getAttribute = canvas.getAttribute;\r\n\t\tcanvas.getAttribute = function(name, ...args) {\r\n\t\t\tlet result = getAttribute.call(this, name, ...args);\r\n\t\t\tif (name === 'width' || name === 'height') {\r\n\t\t\t\tresult /= ratio;\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t};\r\n\t\tconst setAttribute = canvas.setAttribute;\r\n\t\tcanvas.setAttribute = function(name, val, ...args) {\r\n\t\t\tconst wh = name === 'width' || name === 'height';\r\n\t\t\tif (wh) {\r\n\t\t\t\tval *= ratio;\r\n\t\t\t}\r\n\t\t\tconst result = setAttribute.call(this, name, val, ...args);\r\n\t\t\tif (wh) {\r\n\t\t\t\tctx.scale(ratio, ratio);\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t};\r\n\r\n\t\tObject.defineProperty(canvas, 'width', {\r\n\t\t\tget() {\r\n\t\t\t\treturn canvas.getAttribute('width');\r\n\t\t\t},\r\n\t\t\tset: (val) => {\r\n\t\t\t\tcanvas.setAttribute('width', Math.floor(val));\r\n\t\t\t},\r\n\t\t\tconfigurable: true,\r\n\t\t\tenumerable: true,\r\n\t\t});\r\n\t\tObject.defineProperty(canvas, 'height', {\r\n\t\t\tget() {\r\n\t\t\t\treturn canvas.getAttribute('height');\r\n\t\t\t},\r\n\t\t\tset: (val) => {\r\n\t\t\t\tcanvas.setAttribute('height', Math.floor(val));\r\n\t\t\t},\r\n\t\t\tconfigurable: true,\r\n\t\t\tenumerable: true,\r\n\t\t});\r\n\t\tconst drawImage = ctx.drawImage;\r\n\t\tctx.drawImage = function(img, ...args) {\r\n\t\t\tif (img !== canvas || ratio === 1) {\r\n\t\t\t\treturn drawImage.call(this, img, ...args);\r\n\t\t\t}\r\n\t\t\tthis.save();\r\n\t\t\ttry {\r\n\t\t\t\tthis.scale(1 / ratio, 1 / ratio);\r\n\t\t\t\tif (args.length > 4) {\r\n\t\t\t\t\targs[4] = args[4] * ratio;\r\n\t\t\t\t\targs[5] = args[5] * ratio;\r\n\t\t\t\t} else {\r\n\t\t\t\t\targs[0] = args[0] * ratio;\r\n\t\t\t\t\targs[1] = args[1] * ratio;\r\n\t\t\t\t}\r\n\t\t\t\treturn drawImage.call(this, img, ...args);\r\n\t\t\t} finally {\r\n\t\t\t\tthis.restore();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn canvas;\r\n\t}\r\n};","'use strict';\r\n\r\nconst {isDef} = require('./utils');\r\n\r\nconst ICON_PROP_KEYS = [\r\n\t'content',\r\n\t'font',\r\n\t'color',\r\n\t'className',\r\n\t'isLiga',\r\n\t'width',\r\n\t'src',\r\n\t'svg',\r\n\t'name',\r\n\t'path'\r\n];\r\n\r\nfunction quote(name) {\r\n\tconst quoted = [];\r\n\tconst split = name.split(/,\\s*/);\r\n\tfor (let i = 0; i < split.length; i++) {\r\n\t\tconst part = split[i].replace(/['\"]/g, '');\r\n\t\tif (part.indexOf(' ') === -1 && !(/^\\d/.test(part))) {\r\n\t\t\tquoted.push(part);\r\n\t\t} else {\r\n\t\t\tquoted.push('\\'' + part + '\\'');\r\n\t\t}\r\n\t}\r\n\treturn quoted.join(',');\r\n}\r\n\r\nconst doms = {};\r\nconst props = {};\r\n\r\nfunction getIconProps(tagName, className) {\r\n\tconst tagProps = props[tagName] || (props[tagName] = {});\r\n\tif (tagProps[className]) {\r\n\t\treturn tagProps[className];\r\n\t}\r\n\tconst dom = doms[tagName] || (doms[tagName] = document.createElement(tagName));\r\n\tdom.className = className;\r\n\tdocument.body.appendChild(dom);\r\n\ttry {\r\n\t\tconst beforeStyle = document.defaultView.getComputedStyle(dom, '::before');\r\n\t\tlet content = beforeStyle.getPropertyValue('content');\r\n\t\tif (content.length >= 3 && (content[0] === '\"' || content[0] === '\\'')) {\r\n\t\t\tif (content[0] === content[content.length - 1]) {\r\n\t\t\t\tcontent = content.substr(1, content.length - 2);\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet font = beforeStyle.getPropertyValue('font');\r\n\t\tif (!font) {\r\n\t\t\tfont = beforeStyle.getPropertyValue('font-style') + ' ' +\r\n\t\t\t\tbeforeStyle.getPropertyValue('font-variant') + ' ' +\r\n\t\t\t\tbeforeStyle.getPropertyValue('font-weight') + ' ' +\r\n\t\t\t\tbeforeStyle.getPropertyValue('font-size') + '/' +\r\n\t\t\t\tbeforeStyle.getPropertyValue('line-height') + ' ' +\r\n\t\t\t\tquote(beforeStyle.getPropertyValue('font-family'));\r\n\t\t}\r\n\t\tconst color = beforeStyle.getPropertyValue('color');\r\n\t\tconst width = dom.clientWidth;\r\n\t\tconst isLiga = (beforeStyle.getPropertyValue('font-feature-settings') || '').indexOf('liga') > -1;\r\n\t\t\r\n\t\treturn (tagProps[className] = {\r\n\t\t\tcontent,\r\n\t\t\tfont,\r\n\t\t\tcolor,\r\n\t\t\twidth,\r\n\t\t\tisLiga,\r\n\t\t});\r\n\t} finally {\r\n\t\tdocument.body.removeChild(dom);\r\n\t}\r\n}\r\n\r\nfunction toPropArray(prop, count) {\r\n\tconst result = [];\r\n\tif (Array.isArray(prop)) {\r\n\t\tresult.push(...prop);\r\n\t\tfor (let i = prop.length; i < count; i++) {\r\n\t\t\tresult.push(null);\r\n\t\t}\r\n\t} else {\r\n\t\tfor (let i = 0; i < count; i++) {\r\n\t\t\tresult.push(prop);\r\n\t\t}\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nfunction toSimpleArray(iconProps) {\r\n\tif (!iconProps) {\r\n\t\treturn iconProps;\r\n\t} else if (Array.isArray(iconProps)) {\r\n\t\treturn iconProps;\r\n\t}\r\n\r\n\tconst workData = {};\r\n\r\n\tlet count = 0;\r\n\tICON_PROP_KEYS.forEach((k) => {\r\n\t\tif (iconProps[k]) {\r\n\t\t\tif (Array.isArray(iconProps[k])) {\r\n\t\t\t\tcount = Math.max(count, iconProps[k].length);\r\n\t\t\t} else {\r\n\t\t\t\tcount = Math.max(count, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\r\n\tICON_PROP_KEYS.forEach((k) => {\r\n\t\tworkData[k] = toPropArray(iconProps[k], count);\r\n\t});\r\n\r\n\tconst result = [];\r\n\tfor (let i = 0; i < count; i++) {\r\n\t\tconst data = {};\r\n\t\tICON_PROP_KEYS.forEach((k) => {\r\n\t\t\tdata[k] = workData[k][i];\r\n\t\t});\r\n\t\tresult.push(data);\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nfunction normarize(iconProps) {\r\n\tconst data = {};\r\n\tfor (const k in iconProps) {\r\n\t\tif (k === 'className') {\r\n\t\t\tcontinue;\r\n\t\t}\r\n\t\tdata[k] = iconProps[k];\r\n\t}\r\n\tif (iconProps.className) {\r\n\t\tconst prop = getIconProps(iconProps.tagName || 'i', iconProps.className);\r\n\t\tfor (const k in prop) {\r\n\t\t\tif (!isDef(iconProps[k])) {\r\n\t\t\t\tdata[k] = prop[k];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn data;\r\n}\r\n\r\nmodule.exports = {\r\n\ttoNormarizeArray(iconProps) {\r\n\t\tconst icons = toSimpleArray(iconProps);\r\n\t\tif (!icons) {\r\n\t\t\treturn icons;\r\n\t\t}\r\n\t\treturn icons.map((icon) => normarize(icon));\r\n\t},\r\n\tget iconPropKeys() {\r\n\t\treturn ICON_PROP_KEYS;\r\n\t},\r\n\tgetIconProps,\r\n};\r\n\r\n\r\n","'use strict';\r\n\r\nconst {then} = require('./utils');\r\nconst LRUCache = require('./LRUCache');\r\n\r\nconst allCache = {};\r\n\r\nfunction isDataUrl(url) {\r\n\treturn url.search(/^(data:)/) !== -1;\r\n}\r\n\r\nfunction loadImage(src) {\r\n\tif (!window.Promise) {\r\n\t\tconsole.error('Promise is not loaded. load Promise before this process.');\r\n\t\treturn {\r\n\t\t\tthen() {\r\n\t\t\t\treturn this;\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\tconst img = new Image();\r\n\tconst result = new window.Promise((resolve) => {\r\n\t\timg.onload = () => {\r\n\t\t\tresolve(img);\r\n\t\t};\r\n\t});\r\n\timg.onerror = (e) => {\r\n\t\tconst url = src.length > 200 ? `${src.substr(0, 200)}...` : src;\r\n\t\tconsole.warn(`cannot load: ${url}`);\r\n\t\tthrow new Error(`IMAGE LOAD ERROR: ${url}`);\r\n\t};\r\n\timg.src = isDataUrl(src) ? src : `${src}?${Date.now()}`;\r\n\treturn result;\r\n}\r\n\r\nfunction getCacheOrLoad0(cache, src) {\r\n\treturn then(src, (src) => {\r\n\t\tconst c = cache.get(src);\r\n\t\tif (c) {\r\n\t\t\treturn c;\r\n\t\t}\r\n\t\tconst result = loadImage(src).then((img) => {\r\n\t\t\tcache.put(src, img);\r\n\t\t\treturn img;\r\n\t\t});\r\n\t\tcache.put(src, result);\r\n\t\treturn result;\r\n\t});\r\n}\r\n\r\nfunction getCacheOrLoad(cacheName, cacheSize, src) {\r\n\tconst cache = allCache[cacheName] || (allCache[cacheName] = new LRUCache(cacheSize));\r\n\treturn getCacheOrLoad0(cache, src);\r\n}\r\n\r\nmodule.exports = {\r\n\tloadImage,\r\n\tgetCacheOrLoad,\r\n};\r\n","'use strict';\r\n\r\nconst PathCommandsParser = require('./PathCommandsParser');\r\nconst parser = new PathCommandsParser();\r\n\r\nclass Path2D {\r\n\tconstructor(arg) {\r\n\t\tthis._ops = [];\r\n\t\t[\r\n\t\t\t'closePath',\r\n\t\t\t'moveTo',\r\n\t\t\t'lineTo',\r\n\t\t\t'bezierCurveTo',\r\n\t\t\t'quadraticCurveTo',\r\n\t\t\t'arc',\r\n\t\t\t'rect'\r\n\t\t].forEach((name) => {\r\n\t\t\tthis[name] = (...args) => {\r\n\t\t\t\tthis._ops.push({op: name, args});\r\n\t\t\t};\r\n\t\t});\r\n\t\tif (arg === undefined) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (typeof arg === 'string') {\r\n\t\t\ttry {\r\n\t\t\t\tthis._ops = parser.parse(arg);\r\n\t\t\t} catch (e) {\r\n\t\t\t\tthrow e;\r\n\t\t\t}\r\n\t\t} else if (arg.hasOwnProperty('_ops')) {\r\n\t\t\tthis._ops = [...this._ops];\r\n\t\t} else {\r\n\t\t\tthrow new Error(`Error: ${typeof arg} is not a valid argument to Path`);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst CanvasRenderingContext2D = window.CanvasRenderingContext2D;\r\n\r\nconst originalFill = CanvasRenderingContext2D.prototype.fill;\r\n\r\nCanvasRenderingContext2D.prototype.fill = function(...args) {\r\n\tif (args[0] instanceof Path2D) {\r\n\t\tconst path = args[0];\r\n\t\tthis.beginPath();\r\n\t\tpath._ops.forEach((op) => {\r\n\t\t\tthis[op.op](...op.args);\r\n\t\t});\r\n\t\toriginalFill.apply(this, Array.prototype.slice.call(args, 1));\r\n\t} else {\r\n\t\toriginalFill.apply(this, args);\r\n\t}\r\n};\r\n\r\nmodule.exports = Path2D;\r\n","'use strict';\r\n\r\nfunction mag(v) {\r\n\treturn Math.sqrt(Math.pow(v[0], 2) + Math.pow(v[1], 2));\r\n}\r\n    \r\nfunction dot(u, v) {\r\n\treturn (u[0] * v[0] + u[1] * v[1]);\r\n}\r\n    \r\nfunction ratio(u, v) {\r\n\treturn dot(u, v) / (mag(u) * mag(v));\r\n}\r\n\r\nfunction clamp(value, min, max) {\r\n\treturn Math.min(Math.max(value, min), max);\r\n}\r\n    \r\nfunction angle(u, v) {\r\n\tlet sign = 1.0;\r\n\tif ((u[0] * v[1] - u[1] * v[0]) < 0) {\r\n\t\tsign = -1.0;\r\n\t}\r\n\treturn sign * Math.acos(clamp(ratio(u, v)), -1, 1);\r\n}\r\n    \r\nfunction rotClockwise(v, angle) {\r\n\tconst cost = Math.cos(angle);\r\n\tconst sint = Math.sin(angle);\r\n\treturn [cost * v[0] + sint * v[1], -1 * sint * v[0] + cost * v[1]];\r\n}\r\n    \r\nfunction rotCounterClockwise(v, angle) {\r\n\tconst cost = Math.cos(angle);\r\n\tconst sint = Math.sin(angle);\r\n\treturn [cost * v[0] - sint * v[1], sint * v[0] + cost * v[1]];\r\n}\r\n    \r\nfunction midPoint(u, v) {\r\n\treturn [(u[0] - v[0]) / 2.0, (u[1] - v[1]) / 2.0];\r\n}\r\n    \r\nfunction meanVec(u, v) {\r\n\treturn [(u[0] + v[0]) / 2.0, (u[1] + v[1]) / 2.0];\r\n}\r\n    \r\nfunction pointMul(u, v) {\r\n\treturn [u[0] * v[0], u[1] * v[1]];\r\n}\r\n    \r\nfunction scale(c, v) {\r\n\treturn [c * v[0], c * v[1]];\r\n}\r\n    \r\nfunction sum(u, v) {\r\n\treturn [u[0] + v[0], u[1] + v[1]];\r\n}\r\n// Convert an SVG elliptical arc to a series of canvas commands.\r\n//\r\n// x1, y1, x2, y2: start and stop coordinates of the ellipse.\r\n// rx, ry: radii of the ellipse.\r\n// phi: rotation of the ellipse.\r\n// fA: large arc flag.\r\n// fS: sweep flag.\r\nfunction ellipseFromEllipticalArc(ctx, x1, y1, rx, ry, phi, fA, fS, x2, y2) {\r\n\t// Convert from endpoint to center parametrization, as detailed in:\r\n\t//   http://www.w3.org/TR/SVG/implnote.html#ArcImplementationNotes\r\n\tif (rx === 0 || ry === 0) {\r\n\t\tctx.lineTo(x2, x1);\r\n\t\treturn;\r\n\t}\r\n\tphi = phi * (Math.PI / 180.0);\r\n\trx = Math.abs(rx);\r\n\try = Math.abs(ry);\r\n\tconst xPrime = rotClockwise(midPoint(x1, x2), phi); // F.6.5.1\r\n\tconst xPrime2 = pointMul(xPrime, xPrime);\r\n\tlet rx2 = Math.pow(rx, 2);\r\n\tlet ry2 = Math.pow(ry, 2);\r\n    \r\n\tconst lambda = Math.sqrt(xPrime2[0] / rx2 + xPrime2[1] / ry2);\r\n\tif (lambda > 1) {\r\n\t\trx *= lambda;\r\n\t\try *= lambda;\r\n\t\trx2 = Math.pow(rx, 2);\r\n\t\try2 = Math.pow(ry, 2);\r\n\t}\r\n\tlet factor = Math.sqrt(Math.abs(rx2 * ry2 - rx2 * xPrime2[1] - ry2 * xPrime2[0]) /\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(rx2 * xPrime2[1] + ry2 * xPrime2[0]));\r\n\tif (fA === fS) {\r\n\t\tfactor *= -1.0;\r\n\t}\r\n\tconst cPrime = scale(factor, [rx * xPrime[1] / ry, -ry * xPrime[0] / rx]); // F.6.5.2\r\n\tconst c = sum(rotCounterClockwise(cPrime, phi), meanVec(x1, x2)); // F.6.5.3\r\n\tconst x1UnitVector = [(xPrime[0] - cPrime[0]) / rx, (xPrime[1] - cPrime[1]) / ry];\r\n\tconst x2UnitVector = [(-1.0 * xPrime[0] - cPrime[0]) / rx, (-1.0 * xPrime[1] - cPrime[1]) / ry];\r\n\tconst theta = angle([1, 0], x1UnitVector); // F.6.5.5\r\n\tconst deltaTheta = angle(x1UnitVector, x2UnitVector); // F.6.5.6\r\n\tconst start = theta;\r\n\tconst end = theta + deltaTheta;\r\n\tctx.save();\r\n\tctx.translate(c[0], c[1]);\r\n\tctx.rotate(phi);\r\n\tctx.scale(rx, ry);\r\n\tctx.arc(0, 0, 1, start, end, 1 - fS);\r\n\tctx.restore();\r\n}\r\n\r\nclass PathCommands {\r\n\tconstructor(ctx) {\r\n\t\tlet lMx;\r\n\t\tlet lMy;\r\n\t\tlet lx = 0;\r\n\t\tlet ly = 0;\r\n\t\tlet reflected;\r\n\t\tlet lastCommand = '';\r\n\t\tfunction makeReflected() {\r\n\t\t\tif ('CcSsQqTt'.indexOf(lastCommand) < 0) {\r\n\t\t\t\treturn {x: lx, y: ly};\r\n\t\t\t}\r\n\t\t\treturn reflected;\r\n\t\t}\r\n\r\n\t\tthis.M = (px, py) => {\r\n\t\t\tctx.moveTo(px, py);\r\n\t\t\tlMx = px;\r\n\t\t\tlMy = py;\r\n\t\t\tlx = px;\r\n\t\t\tly = py;\r\n\t\t\tlastCommand = 'M';\r\n\t\t\treturn this;\r\n\t\t};\r\n\t\tthis.m = (px, py) => this.M(px + lx, py + ly);\r\n\t\tthis.L = (px, py) => {\r\n\t\t\tctx.lineTo(px, py);\r\n\t\t\tlx = px;\r\n\t\t\tly = py;\r\n\t\t\tlastCommand = 'L';\r\n\t\t\treturn this;\r\n\t\t};\r\n\t\tthis.l = (px, py) => this.L(px + lx, py + ly);\r\n\t\tthis.H = (px) => this.L(px, ly);\r\n\t\tthis.h = (px) => this.H(px + lx);\r\n\t\tthis.V = (py) => this.L(lx, py);\r\n\t\tthis.v = (py) => this.V(py + ly);\r\n\t\tthis.Z = () => {\r\n\t\t\tctx.closePath();\r\n\t\t\tlx = lMx;\r\n\t\t\tly = lMy;\r\n\t\t\tlastCommand = 'Z';\r\n\t\t\treturn this;\r\n\t\t};\r\n\t\tthis.z = () => this.Z();\r\n\t\t//C x1 y1, x2 y2, x y (or c dx1 dy1, dx2 dy2, dx dy)\r\n\t\tthis.C = (cp1x, cp1y, cp2x, cp2y, px, py) => {\r\n\t\t\tctx.bezierCurveTo(cp1x, cp1y, cp2x, cp2y, px, py);\r\n\t\t\tlx = px;\r\n\t\t\tly = py;\r\n\t\t\treflected = {\r\n\t\t\t\tx: 2 * px - cp2x,\r\n\t\t\t\ty: 2 * py - cp2y,\r\n\t\t\t};\r\n\t\t\tlastCommand = 'C';\r\n\t\t\treturn this;\r\n\t\t};\r\n\t\tthis.c = (cp1x, cp1y, cp2x, cp2y, px, py) => this.C(\r\n\t\t\t\tcp1x + lx, cp1y + ly,\r\n\t\t\t\tcp2x + lx, cp2y + ly,\r\n\t\t\t\tpx + lx, py + ly\r\n\t\t);\r\n\t\t//S x2 y2, x y (or s dx2 dy2, dx dy)\r\n\t\tthis.S = (cpx, cpy, px, py) => {\r\n\t\t\tconst {x: cp1x, y: cp1y} = makeReflected(lastCommand);\r\n\t\t\treturn this.C(cp1x, cp1y, cpx, cpy, px, py);\r\n\t\t};\r\n\t\tthis.s = (cpx, cpy, px, py) => this.S(cpx + lx, cpy + ly, px + lx, py + ly);\r\n\t\t//Q x1 y1, x y (or q dx1 dy1, dx dy)\r\n\t\tthis.Q = (cpx, cpy, px, py) => {\r\n\t\t\tctx.quadraticCurveTo(cpx, cpy, px, py);\r\n\t\t\tlx = px;\r\n\t\t\tly = py;\r\n\t\t\treflected = {\r\n\t\t\t\tx: 2 * px - cpx,\r\n\t\t\t\ty: 2 * py - cpy,\r\n\t\t\t};\r\n\t\t\tlastCommand = 'Q';\r\n\t\t\treturn this;\r\n\t\t};\r\n\t\tthis.q = (cpx, cpy, px, py) => this.Q(cpx + lx, cpy + ly, px + lx, py + ly);\r\n\t\t//T x y (or t dx dy)\r\n\t\tthis.T = (px, py) => {\r\n\t\t\tconst {x: cpx, y: cpy} = makeReflected();\r\n\t\t\treturn this.Q(cpx, cpy, px, py);\r\n\t\t};\r\n\t\tthis.t = (px, py) => this.T(px + lx, py + ly);\r\n\t\t//A rx ry x-axis-rotation large-arc-flag sweep-flag x y\r\n\t\tthis.A = (rx, ry, xAxisRotation, largeArcFlag, sweepFlag, px, py) => {\r\n\t\t\tconst x1 = lx;\r\n\t\t\tconst y1 = ly;\r\n\r\n\t\t\tellipseFromEllipticalArc(ctx, x1, y1, rx, ry, xAxisRotation, largeArcFlag, sweepFlag, px, py);\r\n\r\n\t\t\tlx = px;\r\n\t\t\tly = py;\r\n\t\t\tlastCommand = 'A';\r\n\t\t\treturn this;\r\n\t\t};\r\n\t\t//a rx ry x-axis-rotation large-arc-flag sweep-flag dx dy\r\n\t\tthis.a = (rx, ry, xAxisRotation, largeArcFlag, sweepFlag, px, py) => this.A(\r\n\t\t\t\trx, ry, xAxisRotation, largeArcFlag, sweepFlag, px + lx, py + ly);\r\n\t\t\r\n\t}\r\n}\r\n\r\nmodule.exports = PathCommands;","'use strict';\r\n\r\nconst PathCommands = require('./PathCommands');\r\n\r\nfunction pathTokens(d) {\r\n\tlet idx = 0;\r\n\treturn {\r\n\t\tnext() {\r\n\t\t\tlet s = '';\r\n\t\t\twhile (d.length > idx) {\r\n\t\t\t\tconst c = d[idx];\r\n\t\t\t\tidx++;\r\n\t\t\t\tif (' ,\\n\\r\\t'.indexOf(c) > -1) {\r\n\t\t\t\t\tif (s) {\r\n\t\t\t\t\t\treturn s;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst type = '.+-1234567890'.indexOf(c) > -1 ? 'num' : 'str';\r\n\t\t\t\t\tif (type === 'str') {\r\n\t\t\t\t\t\tif (s) {\r\n\t\t\t\t\t\t\tidx--;\r\n\t\t\t\t\t\t\treturn s;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn c;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ('-+'.indexOf(c) > -1) {\r\n\t\t\t\t\t\tif (s) {\r\n\t\t\t\t\t\t\tidx--;\r\n\t\t\t\t\t\t\treturn s;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (c === '.') {\r\n\t\t\t\t\t\tif (s.indexOf('.') > -1) {\r\n\t\t\t\t\t\t\tidx--;\r\n\t\t\t\t\t\t\treturn s;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\ts += c;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn s || null;\r\n\t\t}\r\n\t};\r\n}\r\n\r\nfunction command(builder, cmd, argsProvider) {\r\n\tif (cmd.toUpperCase() === 'M' || cmd.toUpperCase() === 'L' || cmd.toUpperCase() === 'T') {\r\n\t\tbuilder.command(cmd, argsProvider.next(), argsProvider.next());\r\n\t\treturn cmd === 'M' ? 'L'\r\n\t\t\t: cmd === 'm' ? 'l'\r\n\t\t\t: cmd;\r\n\t} else if (cmd.toUpperCase() === 'H' || cmd.toUpperCase() === 'V') {\r\n\t\tbuilder.command(cmd, argsProvider.next());\r\n\t\treturn cmd;\r\n\t} else if (cmd.toUpperCase() === 'Z') {\r\n\t\tbuilder.command(cmd);\r\n\t\treturn cmd;\r\n\t} else if (cmd.toUpperCase() === 'C') {\r\n\t\tbuilder.command(cmd,\r\n\t\t\t\targsProvider.next(), argsProvider.next(),\r\n\t\t\t\targsProvider.next(), argsProvider.next(),\r\n\t\t\t\targsProvider.next(), argsProvider.next()\r\n\t\t);\r\n\t\treturn cmd;\r\n\t} else if (cmd.toUpperCase() === 'S' || cmd.toUpperCase() === 'Q') {\r\n\t\tbuilder.command(cmd,\r\n\t\t\t\targsProvider.next(), argsProvider.next(),\r\n\t\t\t\targsProvider.next(), argsProvider.next()\r\n\t\t);\r\n\t\treturn cmd;\r\n\t} else if (cmd.toUpperCase() === 'A') {\r\n\t\tbuilder.command(cmd,\r\n\t\t\t\targsProvider.next(), argsProvider.next(),\r\n\t\t\t\targsProvider.next(), argsProvider.next(), argsProvider.next(),\r\n\t\t\t\targsProvider.next(), argsProvider.next()\r\n\t\t);\r\n\t\treturn cmd;\r\n\t} else {\r\n\t\t// https://developer.mozilla.org/ja/docs/Web/SVG/Tutorial/Paths\r\n\t\tconsole.warn('unsupported:' + cmd);\r\n\t}\r\n\treturn null;\r\n}\r\n\r\nconst canvasOperations = window.CanvasRenderingContext2D ? Object.keys(window.CanvasRenderingContext2D.prototype) : [\r\n\t'save',\r\n\t'restore',\r\n\t'beginPath',\r\n\t'closePath',\r\n\t'moveTo',\r\n\t'lineTo',\r\n\t'bezierCurveTo',\r\n\t'quadraticCurveTo',\r\n\t'arc',\r\n\t'arcTo',\r\n\t'ellipse',\r\n\t'rect',\r\n\t'translate',\r\n\t'rotate',\r\n\t'scale',\r\n];\r\n\r\nclass PathCommandsParser {\r\n\tconstructor() {\r\n\t\tthis._commands = new PathCommands(this);\r\n\t\tcanvasOperations.forEach((op) => {\r\n\t\t\tthis[op] = (...args) => {\r\n\t\t\t\tthis._ops.push({\r\n\t\t\t\t\top,\r\n\t\t\t\t\targs,\r\n\t\t\t\t});\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\tcommand(name, ...args) {\r\n\t\targs = args || [];\r\n\t\tfor (let i = 0; i < args.length; i++) {\r\n\t\t\targs[i] = args[i] - 0;\r\n\t\t}\r\n\t\tthis._commands[name](...(args));\r\n\t}\r\n\tparse(d) {\r\n\t\tconst ops = this._ops = [];\r\n\t\tconst tokens = pathTokens(d);\r\n\t\ttry {\r\n\t\t\tlet cmd;\r\n\t\t\tlet subsequentCommand;\r\n\t\t\twhile ((cmd = tokens.next())) {\r\n\t\t\t\tif (!isNaN(cmd - 0)) {\r\n\t\t\t\t\tlet fst = true;\r\n\t\t\t\t\tconst argsProvider = {\r\n\t\t\t\t\t\tnext() {\r\n\t\t\t\t\t\t\tif (fst) {\r\n\t\t\t\t\t\t\t\tfst = false;\r\n\t\t\t\t\t\t\t\treturn cmd;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn tokens.next();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tsubsequentCommand = command(this, subsequentCommand, argsProvider);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsubsequentCommand = command(this, cmd, tokens);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tconsole.log('Error: ' + d);\r\n\t\t\tthrow e;\r\n\t\t}\r\n\t\treturn ops;\r\n\t}\r\n}\r\n\r\nmodule.exports = PathCommandsParser;","'use strict';\r\n\r\n//see https://github.com/typekit/webfontloader\r\nfunction computeStyle(font) {\r\n\treturn [{\r\n\t\tdisplay: 'block',\r\n\t\tposition: 'absolute',\r\n\t\ttop: '-9999px',\r\n\t\tleft: '-9999px',\r\n\t\twidth: 'auto',\r\n\t\theight: 'auto',\r\n\t\tmargin: '0',\r\n\t\tpadding: '0',\r\n\t\t'white-space': 'nowrap',\r\n\t\tfont,\r\n\t}, {\r\n\t\t'font-variant': 'normal',\r\n\t\t'font-size': '300px',\r\n\t\t'font-style': 'normal',\r\n\t\t'font-weight': '400',\r\n\t\t'line-height': 'normal',\r\n\t}];\r\n}\r\n\r\nclass FontRuler {\r\n\tconstructor(font, testStr) {\r\n\t\tconst e = document.createElement('span');\r\n\t\te.setAttribute('aria-hidden', 'true');\r\n\t\te.textContent = testStr || 'BESbswy';\r\n\r\n\t\tcomputeStyle(font).forEach((style) => {\r\n\t\t\tfor (const key in style) {\r\n\t\t\t\te.style[key] = style[key];\r\n\t\t\t}\r\n\t\t});\r\n\t\tdocument.body.appendChild(e);\r\n\t\tthis.el_ = e;\r\n\t}\r\n\tgetWidth() {\r\n\t\treturn this.el_.offsetWidth;\r\n\t}\r\n\tremove() {\r\n\t\tdocument.body.removeChild(this.el_);\r\n\t}\r\n}\r\n\r\nmodule.exports = FontRuler;\r\n\r\n\r\n","'use strict';\r\n\r\n//see https://github.com/typekit/webfontloader\r\n\r\n//http://defghi1977.html.xdomain.jp/tech/canvasMemo/canvasMemo.htm\r\nconst FontRuler = require('./FontRuler');\r\n\r\n\r\nconst LastResortFonts = {\r\n\tSERIF: 'serif',\r\n\tSANS_SERIF: 'sans-serif'\r\n};\r\n\r\n\r\nconst watchRunners = {};\r\n\r\nclass FontWatchRunner {\r\n\tstatic load(font, testStr, activeCallback, inactiveCallback) {\r\n\t\tconst c = watchRunners[font] || (watchRunners[font] = {});\r\n\t\ttestStr = testStr + '';\r\n\t\tlet runner;\r\n\t\tif (c[testStr]) {\r\n\t\t\trunner = c[testStr];\r\n\t\t} else {\r\n\t\t\trunner = (c[testStr] = new FontWatchRunner(font, testStr));\r\n\t\t}\r\n\t\trunner.then(activeCallback, inactiveCallback);\r\n\t}\r\n\tconstructor(font, testStr) {\r\n\t\tthis.activeCallbacks = [];\r\n\t\tthis.inactiveCallbacks = [];\r\n\t\tthis.status = null;\r\n\t\tthis.lastResortWidths_ = {};\r\n\r\n\t\tthis.fontRulerA_ = new FontRuler(font + ',' + LastResortFonts.SERIF, testStr);\r\n\t\tthis.fontRulerB_ = new FontRuler(font + ',' + LastResortFonts.SANS_SERIF, testStr);\r\n\t\tconst lastResortRulerA = new FontRuler('4px ' + LastResortFonts.SERIF, testStr);\r\n\t\tconst lastResortRulerB = new FontRuler('4px ' + LastResortFonts.SANS_SERIF, testStr);\r\n\r\n\t\t//start\r\n\t\tthis.lastResortWidths_[LastResortFonts.SERIF] = lastResortRulerA.getWidth();\r\n\t\tthis.lastResortWidths_[LastResortFonts.SANS_SERIF] = lastResortRulerB.getWidth();\r\n\r\n\t\tlastResortRulerA.remove();\r\n\t\tlastResortRulerB.remove();\r\n\r\n\t\tthis.started_ = Date.now();\r\n\r\n\t\tthis.check_();\r\n\t}\r\n\tthen(activeCallback, inactiveCallback) {\r\n\t\tif (this.status) {\r\n\t\t\tif (this.status !== 'ng') {\r\n\t\t\t\tactiveCallback();\r\n\t\t\t} else {\r\n\t\t\t\tinactiveCallback();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.activeCallbacks.push(activeCallback);\r\n\t\t\tthis.inactiveCallbacks.push(inactiveCallback);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\tcheck_() {\r\n\t\tconst widthA = this.fontRulerA_.getWidth();\r\n\t\tconst widthB = this.fontRulerB_.getWidth();\r\n\r\n\t\tif (this.isFallbackFont_(widthA, widthB) || this.isLastResortFont_(widthA, widthB)) {\r\n\t\t\tif (Date.now() - this.started_ >= 3000) { // timeout\r\n\t\t\t\tif (this.isLastResortFont_(widthA, widthB)) {\r\n\t\t\t\t\tthis.finish_(this.activeCallbacks);\r\n\t\t\t\t\tthis.status = 'ok';\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.finish_(this.inactiveCallbacks);\r\n\t\t\t\t\tthis.status = 'ng';\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.check_();\r\n\t\t\t\t}, 50);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tthis.finish_(this.activeCallbacks);\r\n\t\t\tthis.status = 'ok';\r\n\t\t}\r\n\t}\r\n\tisFallbackFont_(a, b) {\r\n\t\treturn this.widthMatches_(a, LastResortFonts.SERIF) && this.widthMatches_(b, LastResortFonts.SANS_SERIF);\r\n\t}\r\n\twidthsMatchLastResortWidths_(a, b) {\r\n\t\tfor (const font in LastResortFonts) {\r\n\t\t\tif (LastResortFonts.hasOwnProperty(font)) {\r\n\t\t\t\tif (this.widthMatches_(a, LastResortFonts[font]) &&\r\n\t\t\t\t\t\tthis.widthMatches_(b, LastResortFonts[font])) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\twidthMatches_(width, lastResortFont) {\r\n\t\treturn width === this.lastResortWidths_[lastResortFont];\r\n\t}\r\n\tisLastResortFont_(a, b) {\r\n\t\treturn hasWebKitFallbackBug() && this.widthsMatchLastResortWidths_(a, b);\r\n\t}\r\n\tfinish_(callbacks) {\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.fontRulerA_.remove();\r\n\t\t\tthis.fontRulerB_.remove();\r\n\t\t\tcallbacks.forEach((cb) => cb());\r\n\t\t}, 0);\r\n\t}\r\n}\r\n\r\nlet HAS_WEBKIT_FALLBACK_BUG = null;\r\nfunction hasWebKitFallbackBug() {\r\n\tif (HAS_WEBKIT_FALLBACK_BUG === null) {\r\n\t\tconst match = /AppleWebKit\\/([0-9]+)(?:\\.([0-9]+))/.exec(window.navigator.userAgent);\r\n\r\n\t\tHAS_WEBKIT_FALLBACK_BUG = !!match &&\r\n\t\t\t(parseInt(match[1], 10) < 536 ||\r\n\t\t\t(parseInt(match[1], 10) === 536 &&\r\n\t\t\tparseInt(match[2], 10) <= 11));\r\n\t}\r\n\treturn HAS_WEBKIT_FALLBACK_BUG;\r\n}\r\n\r\nmodule.exports = FontWatchRunner;\r\n","'use strict';\r\n\r\nfunction normalize(options) {\r\n\tif (!options) {\r\n\t\treturn [];\r\n\t}\r\n\tif (Array.isArray(options)) {\r\n\t\treturn options;\r\n\t}\r\n\tif (typeof options === 'string') {\r\n\t\treturn normalize(JSON.parse(options));\r\n\t}\r\n\tconst result = [];\r\n\tfor (const k in options) {\r\n\t\tresult.push({\r\n\t\t\tvalue: k,\r\n\t\t\tcaption: options[k]\r\n\t\t});\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nmodule.exports = {\r\n\tnormalize,\r\n};\r\n","'use strict';\r\n\r\nfunction getPath2D() {\r\n\t//return require('./legacy/canvas/Path2D');\r\n\treturn window.Path2D || require('./legacy/canvas/Path2D');\r\n}\r\n\r\nmodule.exports = {\r\n\tfill(module, ctx, x, y, w, h) {\r\n\t\tctx.save();\r\n\t\ttry {\r\n\t\t\tconst {width, height} = module;\r\n\t\t\tconst {ud: upsideDown, x: offsetX = 0, y: offsetY = 0} = module;\r\n\t\t\tw = w || width;\r\n\t\t\th = h || height;\r\n\t\t\tconst xrate = w / width;\r\n\t\t\tconst yrate = h / (upsideDown ? -height : height);\r\n\t\t\tx = x || 0;\r\n\t\t\ty = upsideDown ? ((y || 0) + (-height * yrate)) : (y || 0);\r\n\r\n\t\t\tctx.translate(x, y);\r\n\t\t\tctx.scale(xrate, yrate);\r\n\t\t\tif (offsetX !== 0 || offsetY !== 0) {\r\n\t\t\t\tctx.translate(offsetX, offsetY);\r\n\t\t\t}\r\n\t\t\tconst Path2D = getPath2D();\r\n\t\t\tmodule.path2d = module.path2d || (new Path2D(module.d));\r\n\t\t\tctx.fill(module.path2d);\r\n\t\t} finally {\r\n\t\t\tctx.restore();\r\n\t\t}\r\n\t},\r\n\tget Path2D() {\r\n\t\treturn getPath2D();\r\n\t},\r\n};\r\n","'use strict';\r\n{\r\n\tconst {isPromise} = require('./utils');\r\n\r\n\tfunction wait(val) {\r\n\t\treturn val.then((v) => {\r\n\t\t\tif (isPromise(v)) {\r\n\t\t\t\treturn wait(v);\r\n\t\t\t} else {\r\n\t\t\t\treturn v;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tfunction createArray(get, length) {\r\n\t\tconst array = new Array(length);\r\n\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\tarray[i] = get(i);\r\n\t\t}\r\n\t\treturn array;\r\n\t}\r\n\tfunction createArrayPromise(get, getField, length) {\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tconst plist = [];\r\n\t\t\tconst array = new Array(length);\r\n\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\tconst data = get(i);\r\n\t\t\t\tconst record = {\r\n\t\t\t\t\tv: data,\r\n\t\t\t\t\tf: data\r\n\t\t\t\t};\r\n\t\t\t\tarray[i] = record;\r\n\t\t\t\tif (isPromise(data)) {\r\n\t\t\t\t\tplist.push(wait(data).then((v) => {\r\n\t\t\t\t\t\trecord.v = v;\r\n\t\t\t\t\t\trecord.f = v;\r\n\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tPromise.all(plist).then(\r\n\t\t\t\t\t() => setArrayField(array, getField)\r\n\t\t\t).then(resolve);\r\n\t\t});\r\n\t}\r\n\tfunction setArrayField(array, getField) {\r\n\t\tif (!getField) {\r\n\t\t\treturn Promise.resolve(array);\r\n\t\t}\r\n\t\treturn new Promise((resolve) => {\r\n\t\t\tconst length = array.length;\r\n\t\t\tconst plist = [];\r\n\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\tconst record = array[i];\r\n\t\t\t\trecord.f = getField(record.v);\r\n\t\t\t\tif (isPromise(record.f)) {\r\n\t\t\t\t\tplist.push(wait(record.f).then((v) => {\r\n\t\t\t\t\t\trecord.f = v;\r\n\t\t\t\t\t}));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tPromise.all(plist).then(() => resolve(array));\r\n\t\t});\r\n\t}\r\n\tconst sort = {\r\n\t\tsort(get, set, length, compare, getField) {\r\n\t\t\tconst old = createArray(get, length);\r\n\t\t\tif (getField) {\r\n\t\t\t\told.sort((r1, r2) => compare(getField(r1), getField(r2)));\r\n\t\t\t} else {\r\n\t\t\t\told.sort(compare);\r\n\t\t\t}\r\n\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\tset(i, old[i]);\r\n\t\t\t}\r\n\t\t},\r\n\t\tsortArray(array, compare) {\r\n\t\t\tArray.prototype.sort.call(array, compare);\r\n\t\t},\r\n\t\tsortPromise(get, set, length, compare, getField) {\r\n\t\t\tif (window.Promise) {\r\n\t\t\t\treturn createArrayPromise(get, getField, length).then((array) => {\r\n\t\t\t\t\tarray.sort((r1, r2) => compare(r1.f, r2.f));\r\n\t\t\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\t\t\tset(i, array[i].v);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tsort.sort(get, set, length, compare, getField);\r\n\t\t\t\tconst dummyPromise = {\r\n\t\t\t\t\tthen(fn) {\r\n\t\t\t\t\t\tfn();\r\n\t\t\t\t\t\treturn dummyPromise;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcatch() {\r\n\t\t\t\t\t\treturn dummyPromise;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\treturn dummyPromise;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\tmodule.exports = sort;\r\n}","\nvar content = require(\"!!../../../node_modules/css-loader/index.js?minimize!./style.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js?minimize!./style.css\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js?minimize!./style.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","'use strict';\r\n{\r\n\tfunction getScrollBarWidth() {\r\n\t\tconst dummy = document.createElement('div');\r\n\t\tconst {style} = dummy;\r\n\t\tstyle.position = 'absolute';\r\n\t\tstyle.height = '9999px';\r\n\t\tstyle.width = 'calc(100vw - 100%)';\r\n\t\tstyle.opacity = 0;\r\n\t\tdummy.textContent = 'x';\r\n\t\tdocument.body.appendChild(dummy);\r\n\t\tconst {width} = document.defaultView.getComputedStyle(dummy, '');\r\n\t\tdocument.body.removeChild(dummy);\r\n\t\treturn parseInt(width, 10);\r\n\t}\r\n\r\n\tlet SCROLLBAR_SIZE;\r\n\tconst initDocument = () => {\r\n\t\trequire('./style.css');\r\n\t\tSCROLLBAR_SIZE = getScrollBarWidth() || 10;\r\n\t\tconst style = document.createElement('style');\r\n\t\tstyle.setAttribute('type', 'text/css');\r\n\t\tstyle.setAttribute('data-name', 'cheetah-grid');\r\n\t\tstyle.innerHTML =\r\n\t\t`\r\n.cheetah-grid .grid-scroll-end-point {\r\n\twidth: ${SCROLLBAR_SIZE}px;\r\n\theight: ${SCROLLBAR_SIZE}px;\r\n}\r\n.cheetah-grid > canvas {\r\n\twidth: -webkit-calc(100% - ${SCROLLBAR_SIZE}px);\r\n\twidth: calc(100% - ${SCROLLBAR_SIZE}px);\r\n\theight: -webkit-calc(100% - ${SCROLLBAR_SIZE}px);\r\n\theight: calc(100% - ${SCROLLBAR_SIZE}px);\r\n}\r\n\t\t`;\r\n\r\n\t\tdocument.head.appendChild(style);\r\n\t};\r\n\r\n\tconst style = {\r\n\t\tinitDocument() {\r\n\t\t\tstyle.initDocument = () => {};\r\n\t\t\tinitDocument();\r\n\t\t},\r\n\t\tgetScrollBarSize() {\r\n\t\t\treturn SCROLLBAR_SIZE;\r\n\t\t}\r\n\t};\r\n\r\n\tmodule.exports = style;\r\n}","'use strict';\r\n{\r\n\tconst Symbol = window.Symbol ? window.Symbol : (() => {\r\n\t\tlet nextId = 1;\r\n\t\treturn (name) => {\r\n\t\t\tconst id = nextId++;\r\n\t\t\tif (name) {\r\n\t\t\t\treturn ` $$$ ${name} - ${id} $$$ `;\r\n\t\t\t} else {\r\n\t\t\t\treturn ` $$$ ${id} $$$ `;\r\n\t\t\t}\r\n\t\t};\r\n\t})();\r\n\tconst mem = {};\r\n\r\n\tmodule.exports = {\r\n\t\tget(name) {\r\n\t\t\tif (name) {\r\n\t\t\t\treturn mem[name] ? mem[name] : (mem[name] = Symbol(name));\r\n\t\t\t} else {\r\n\t\t\t\treturn Symbol();\r\n\t\t\t}\r\n\t\t},\r\n\t\tget PROTECTED_SYMBOL() {\r\n\t\t\treturn this.get('protected');\r\n\t\t},\r\n\t\tget CHECK_COLUMN_STATE_ID() {\r\n\t\t\treturn this.get('chkcol.stateID');\r\n\t\t},\r\n\t\tget BUTTON_COLUMN_STATE_ID() {\r\n\t\t\treturn this.get('btncol.stateID');\r\n\t\t},\r\n\t\tget COLUMN_FADEIN_STATE_ID() {\r\n\t\t\treturn this.get('col.fadein_stateID');\r\n\t\t},\r\n\t\tget BRANCH_GRAPH_COLUMN_STATE_ID() {\r\n\t\t\treturn this.get('branch_graph_col.stateID');\r\n\t\t},\r\n\t\tget SMALL_DIALOG_INPUT_EDITOR_STATE_ID() {\r\n\t\t\treturn this.get('small_dialog_input_editor.stateID');\r\n\t\t},\r\n\t\tget INLINE_INPUT_EDITOR_STATE_ID() {\r\n\t\t\treturn this.get('inline_input_editor.stateID');\r\n\t\t},\r\n\t\tget INLINE_MENU_EDITOR_STATE_ID() {\r\n\t\t\treturn this.get('inline_menu_editor.stateID');\r\n\t\t}\r\n\t};\r\n\r\n}","'use strict';\r\n{\r\n\tlet arrayFind;\r\n\tlet arrayFindIndex;\r\n\tconst array = {\r\n\t\tget find() {\r\n\t\t\tif (arrayFind) {\r\n\t\t\t\treturn arrayFind;\r\n\t\t\t}\r\n\t\t\tif (Array.prototype.find) {\r\n\t\t\t\tarrayFind = (arr, predicate) => Array.prototype.find.call(arr, predicate);\r\n\t\t\t} else {\r\n\t\t\t\tarrayFind = (arr, predicate) => {\r\n\t\t\t\t\tconst index = array.findIndex(arr, predicate);\r\n\t\t\t\t\treturn index >= 0 ? arr[index] : undefined;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn arrayFind;\r\n\t\t},\r\n\t\tget findIndex() {\r\n\t\t\tif (arrayFindIndex) {\r\n\t\t\t\treturn arrayFindIndex;\r\n\t\t\t}\r\n\t\t\tif (Array.prototype.findIndex) {\r\n\t\t\t\tarrayFindIndex = (arr, predicate) => Array.prototype.findIndex.call(arr, predicate);\r\n\t\t\t} else {\r\n\t\t\t\tarrayFindIndex = (arr, predicate) => {\r\n\t\t\t\t\tconst length = arr.length;\r\n\t\t\t\t\tfor (let i = 0; i < length; i++) {\r\n\t\t\t\t\t\tconst value = arr[i];\r\n\t\t\t\t\t\tif (predicate(value, i, arr)) {\r\n\t\t\t\t\t\t\treturn i;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn -1;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t\treturn arrayFindIndex;\r\n\t\t},\r\n\t};\r\n\t\r\n\tfunction isDef(data) {\r\n\t\treturn data !== null && typeof data !== 'undefined';\r\n\t}\r\n\tconst ua = window.navigator.userAgent.toLowerCase();\r\n\tconst IE = (ua.match(/(msie)/) || ua.match(/trident/));\r\n\tconst Chrome = (ua.indexOf('chrome') > -1) && (ua.indexOf('edge') === -1);\r\n\tconst Firefox = (ua.indexOf('firefox') > -1);\r\n\r\n\tfunction setReadonly(obj, name, value) {\r\n\t\tObject.defineProperty(obj, name, {\r\n\t\t\tenumerable: false,\r\n\t\t\tconfigurable: true,\r\n\t\t\tvalue,\r\n\t\t});\r\n\t}\r\n\r\n\tfunction each(obj, fn) {\r\n\t\tfor (const key in obj) {\r\n\t\t\tfn(obj[key], key, obj);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction isObject(obj) {\r\n\t\treturn obj === Object(obj);\r\n\t}\r\n\r\n\tfunction extend(...args) {\r\n\t\tconst result = {};\r\n\t\targs.forEach((source) => {\r\n\t\t\tfor (const key in source) {\r\n\t\t\t\tObject.defineProperty(result, key, {\r\n\t\t\t\t\tget() {\r\n\t\t\t\t\t\treturn source[key];\r\n\t\t\t\t\t},\r\n\t\t\t\t\tset(val) {\r\n\t\t\t\t\t\tsource[key] = val;\r\n\t\t\t\t\t},\r\n\t\t\t\t\tconfigurable: true,\r\n\t\t\t\t\tenumerable: true,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn result;\r\n\t}\r\n\tfunction isDescendantElement(root, target) {\r\n\t\twhile (target.parentElement) {\r\n\t\t\tconst p = target.parentElement;\r\n\t\t\tif (root === p) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\ttarget = p;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\tfunction applyChainSafe(obj, fn, ...names) {\r\n\t\tlet value = obj;\r\n\t\tfor (let i = 0; i < names.length && isDef(value); i++) {\r\n\t\t\tvalue = fn(value, names[i]);\r\n\t\t}\r\n\t\treturn value;\r\n\t}\r\n\tfunction getChainSafe(obj, ...names) {\r\n\t\treturn applyChainSafe(obj, (val, name) => val[name], ...names);\r\n\t}\r\n\tfunction getOrApply(value, ...args) {\r\n\t\tif (typeof value === 'function') {\r\n\t\t\treturn value(...args);\r\n\t\t} else {\r\n\t\t\treturn value;\r\n\t\t}\r\n\t}\r\n\tfunction endsWith(str, searchString, position) {\r\n\t\tconst subjectString = str.toString();\r\n\t\tif (typeof position !== 'number' || !isFinite(position) || Math.floor(position) !== position || position > subjectString.length) {\r\n\t\t\tposition = subjectString.length;\r\n\t\t}\r\n\t\tposition -= searchString.length;\r\n\t\tconst lastIndex = subjectString.lastIndexOf(searchString, position);\r\n\t\treturn lastIndex !== -1 && lastIndex === position;\r\n\t}\r\n\tconst isPromise = (data) => data && typeof data.then === 'function';\r\n\tconst then = (result, callback) => isPromise(result) ? result.then((r) => callback(r)) : callback(result);\r\n\tfunction getMouseButtons(e) {\r\n\t\tif (isDef(e.buttons)) {\r\n\t\t\treturn e.buttons;\r\n\t\t}\r\n\t\t/*for legacy*/\r\n\t\tif (isDef(e.which)) {\r\n\t\t\tif (e.which === 3) { //right?\r\n\t\t\t\treturn 4;\r\n\t\t\t}\r\n\t\t\tif (e.which === 2) { //middle?\r\n\t\t\t\treturn 4;\r\n\t\t\t}\r\n\t\t\treturn e.which;//left or no\r\n\t\t}\r\n\t\t\r\n\t\tif (e.button === 0 || e.button === 1) {\r\n\t\t\treturn 1;//candidate left\r\n\t\t}\r\n\t\tif (e.button === 2) {\r\n\t\t\treturn 2;// right\r\n\t\t}\r\n\t\treturn 0;//no or middle?\r\n\t}\r\n\tfunction getKeyCode(e) {\r\n\t\treturn e.keyCode || e.which;\r\n\t}\r\n\tfunction isTouchEvent(e) {\r\n\t\treturn !!e.changedTouches;\r\n\t}\r\n\tfunction getIgnoreCase(obj, name) {\r\n\t\tif (obj[name]) {\r\n\t\t\treturn obj[name];\r\n\t\t}\r\n\t\tconst l = name.toLowerCase();\r\n\t\tif (obj[l]) {\r\n\t\t\treturn obj[l];\r\n\t\t}\r\n\t\tconst u = name.toLowerCase();\r\n\t\tif (obj[u]) {\r\n\t\t\treturn obj[u];\r\n\t\t}\r\n\t\tfor (const k in obj) {\r\n\t\t\tif (k.toLowerCase() === l) {\r\n\t\t\t\treturn obj[k];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn undefined;\r\n\t}\r\n\tfunction cancel(e) {\r\n\t\te.preventDefault();\r\n\t\te.stopPropagation();\r\n\t}\r\n\r\n\r\n\tfunction toBoxArray(obj) {\r\n\t\tif (!Array.isArray(obj)) {\r\n\t\t\treturn [obj/*top*/, obj/*right*/, obj/*bottom*/, obj/*left*/];\r\n\t\t}\r\n\t\tif (obj.length === 3) {\r\n\t\t\treturn [obj[0]/*top*/, obj[1]/*right*/, obj[2]/*bottom*/, obj[1]/*left*/];\r\n\t\t}\r\n\t\tif (obj.length === 2) {\r\n\t\t\treturn [obj[0]/*top*/, obj[1]/*right*/, obj[0]/*bottom*/, obj[1]/*left*/];\r\n\t\t}\r\n\t\tif (obj.length === 1) {\r\n\t\t\treturn [obj[0]/*top*/, obj[0]/*right*/, obj[0]/*bottom*/, obj[0]/*left*/];\r\n\t\t}\r\n\t\treturn obj;\r\n\t}\r\n\r\n\t// Chrome 33554431\r\n\t// FireFox 17895588\r\n\t// IE 10737433\r\n\tmodule.exports = {\r\n\t\tisDef,\r\n\t\tbrowser: {\r\n\t\t\tIE,\r\n\t\t\tChrome,\r\n\t\t\tFirefox,\r\n\t\t\theightLimit: Chrome ? 33554431\r\n\t\t\t: Firefox ? 17895588\r\n\t\t\t: 10737433 // default IE limit\r\n\t\t},\r\n\t\textend,\r\n\t\tisDescendantElement,\r\n\t\tgetChainSafe,\r\n\t\tapplyChainSafe,\r\n\t\tgetOrApply,\r\n\t\tgetIgnoreCase,\r\n\t\tisPromise,\r\n\t\tthen,\r\n\t\tarray,\r\n\t\tobj: {\r\n\t\t\tsetReadonly,\r\n\t\t\teach,\r\n\t\t\tisObject,\r\n\t\t},\r\n\t\tstr: {\r\n\t\t\tendsWith\r\n\t\t},\r\n\t\tevent: {\r\n\t\t\tgetMouseButtons,\r\n\t\t\tgetKeyCode,\r\n\t\t\tisTouchEvent,\r\n\t\t\tcancel,\r\n\t\t},\r\n\t\tstyle: {\r\n\t\t\ttoBoxArray,\r\n\t\t},\r\n\t\temptyFn() {},\r\n\t};\r\n}","'use strict';\r\n\r\nconst {extend} = require('../internal/utils');\r\nconst DrawGrid = require('../core/DrawGrid');\r\nconst EVENT_TYPE = extend(DrawGrid.EVENT_TYPE, {\r\n\tCHANGED_VALUE: 'changed_value',\r\n});\r\nmodule.exports = EVENT_TYPE;","'use strict';\r\n\r\n{\r\n\tconst core = require('./core');\r\n\tconst tools = require('./tools');\r\n\tconst columns = require('./columns');\r\n\tconst themes = require('./themes');\r\n\tconst data = require('./data');\r\n\t\r\n\tconst ListGrid = require('./ListGrid');\r\n\tconst GridCanvasHelper = require('./GridCanvasHelper');\r\n\t\r\n\tconst icons = require('./icons');\r\n\tconst register = require('./register');\r\n\t\r\n\t/**\r\n\t * Cheetah Grid\r\n\t * @type {Object}\r\n\t * @namespace cheetahGrid\r\n\t */\r\n\tmodule.exports = {\r\n\t\tcore,\r\n\t\ttools,\r\n\r\n\t\t// impl Grids\r\n\t\tListGrid,\r\n\r\n\t\t// objects\r\n\t\tcolumns,\r\n\t\tthemes,\r\n\t\tdata,\r\n\r\n\t\t// helper\r\n\t\tGridCanvasHelper,\r\n\t\tget icons() {\r\n\t\t\treturn icons.get();\r\n\t\t},\r\n\r\n\t\t//plugin registers\r\n\t\tregister,\r\n\r\n\t\tget _internal() {\r\n\t\t\tconsole.warn('use internal!!');\r\n\t\t\treturn {\r\n\t\t\t\tcolor: require('./internal/color'),\r\n\t\t\t\tsort: require('./internal/sort'),\r\n\t\t\t\tcalc: require('./internal/calc'),\r\n\t\t\t\tsymbolManager: require('./internal/symbolManager'),\r\n\t\t\t\tpath2DManager: require('./internal/path2DManager'),\r\n\t\t\t};\r\n\t\t}\r\n\t};\r\n}","'use strict';\r\n\r\nmodule.exports = {};","'use strict';\r\n\r\nmodule.exports = {};","'use strict';\r\n\r\nconst themePlugins = require('./plugins/themes');\r\nconst iconPlugins = require('./plugins/icons');\r\n\r\nfunction register(obj, name, value) {\r\n\tif (value) {\r\n\t\tconst old = obj[name];\r\n\t\tobj[name] = value;\r\n\t\treturn old;\r\n\t} else {\r\n\t\treturn obj[name];\r\n\t}\r\n}\r\nfunction registers(obj, values) {\r\n\tfor (const k in values) {\r\n\t\tobj[k] = values[k];\r\n\t}\r\n}\r\nmodule.exports = {\r\n\ttheme(name, theme) {\r\n\t\treturn register(themePlugins, name, theme);\r\n\t},\r\n\ticon(name, icon) {\r\n\t\treturn register(iconPlugins, name, icon);\r\n\t},\r\n\ticons(icons) {\r\n\t\tregisters(iconPlugins, icons);\r\n\t},\r\n};","'use strict';\r\n{\r\n\tconst {extend, getIgnoreCase} = require('./internal/utils');\r\n\tconst theme = require('./themes/theme');\r\n\tconst plugins = require('./plugins/themes');\r\n\tconst BASIC = theme.create(require('./themes/BASIC'));\r\n\tconst MATERIAL_DESIGN = theme.create(require('./themes/MATERIAL_DESIGN'));\r\n\r\n\tconst builtin = {\r\n\t\tBASIC,\r\n\t\tMATERIAL_DESIGN,\r\n\t};\r\n\tlet defTheme = theme.create({});\r\n\t/**\r\n\t * themes\r\n\t * @type {Object}\r\n\t * @namespace cheetahGrid.themes\r\n\t * @memberof cheetahGrid\r\n\t */\r\n\tconst themes = {\r\n\t\tget default() {\r\n\t\t\treturn defTheme;\r\n\t\t},\r\n\t\tset default(defaultTheme) {\r\n\t\t\tdefTheme = defaultTheme;\r\n\t\t},\r\n\t\ttheme,\r\n\t\tof(value) {\r\n\t\t\tif (!value) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\tif (typeof value === 'string') {\r\n\t\t\t\tconst t = getIgnoreCase(themes.choices, value);\r\n\t\t\t\tif (t) {\r\n\t\t\t\t\treturn t;\r\n\t\t\t\t}\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn value;\r\n\t\t},\r\n\t\t/**\r\n\t\t * @namespace cheetahGrid.themes.choices\r\n\t\t */\r\n\t\tget choices() {\r\n\t\t\treturn extend(builtin, plugins);\r\n\t\t},\r\n\t};\r\n\tmodule.exports = themes;\r\n}","/*eslint no-bitwise:0*/\r\n'use strict';\r\nfunction DEFAULT_BG_COLOR(args) {\r\n\tconst {\r\n\t\trow,\r\n\t\tgrid: {frozenRowCount}\r\n\t} = args;\r\n\tif (!((row - frozenRowCount) & 1)) {\r\n\t\treturn '#FFF';\r\n\t} else {\r\n\t\treturn '#F6F6F6';\r\n\t}\r\n}\r\nconst cacheLinearGradient = {};\r\nfunction getLinearGradient(context, left, top, right, bottom, colorStops) {\r\n\tlet stop;\r\n\tconst stopsKey = [];\r\n\tfor (stop in colorStops) {\r\n\t\tstopsKey.push(`${stop}@${colorStops[stop]}`);\r\n\t}\r\n\tconst key = `${left}/${top}/${right}/${bottom}/${stopsKey.join(',')}`;\r\n\tconst ret = cacheLinearGradient[key];\r\n\tif (ret) {\r\n\t\treturn ret;\r\n\t}\r\n\tconst grad = context.createLinearGradient(left, top, left, bottom);\r\n\tfor (stop in colorStops) {\r\n\t\tgrad.addColorStop(stop, colorStops[stop]);\r\n\t}\r\n\treturn (cacheLinearGradient[key] = grad);\r\n}\r\nfunction FROZEN_ROWS_BG_COLOR(args) {\r\n\tconst {\r\n\t\tcol,\r\n\t\tgrid,\r\n\t\tgrid: {frozenRowCount},\r\n\t\tcontext\r\n\t} = args;\r\n\tconst {left, top} = grid.getCellRelativeRect(col, 0);\r\n\tconst {bottom} = grid.getCellRelativeRect(col, frozenRowCount - 1);\r\n\r\n\treturn getLinearGradient(context, left, top, left, bottom, {0: '#FFF', 1: '#D3D3D3'});\r\n}\r\n/**\r\n * basic theme\r\n * @name BASIC\r\n * @type {Object}\r\n * @memberof cheetahGrid.themes.choices\r\n */\r\nmodule.exports = {\r\n\tcolor: '#000',\r\n\tdefaultBgColor: DEFAULT_BG_COLOR,\r\n\tfrozenRowsBgColor: FROZEN_ROWS_BG_COLOR,\r\n\thiliteBorderColor: '#5E9ED6',\r\n\tselectionBgColor: '#CCE0FF',\r\n\tborderColor: '#000',\r\n\tcheckbox: {\r\n\t\tuncheckBgColor: '#FFF',\r\n\t\tcheckBgColor: 'rgb(76, 73, 72)',\r\n\t},\r\n\tbutton: {\r\n\t\tcolor: '#FFF',\r\n\t\tbgColor: '#2196F3',\r\n\t},\r\n\tunderlayBackgroundColor: '#F6F6F6',\r\n};","/*eslint no-bitwise:0*/\r\n'use strict';\r\n\r\nfunction FROZEN_ROWS_BORDER_COLOR(args) {\r\n\tconst {\r\n\t\trow,\r\n\t\tgrid: {frozenRowCount}\r\n\t} = args;\r\n\tif (frozenRowCount - 1 === row) {\r\n\t\treturn ['#f2f2f2', '#f2f2f2', '#ccc7c7', '#f2f2f2'];\r\n\t} else {\r\n\t\treturn ['#f2f2f2'];\r\n\t}\r\n}\r\nfunction BORDER_COLOR(args) {\r\n\tconst {\r\n\t\tcol,\r\n\t\tgrid: {colCount}\r\n\t} = args;\r\n\tif (colCount - 1 === col) {\r\n\t\treturn ['#ccc7c7', '#f2f2f2', '#ccc7c7', null];\r\n\t} else {\r\n\t\treturn ['#ccc7c7', null];\r\n\t}\r\n}\r\n/**\r\n * material design theme\r\n * @name MATERIAL_DESIGN\r\n * @type {Object}\r\n * @memberof cheetahGrid.themes.choices\r\n */\r\nmodule.exports = {\r\n\tcolor: 'rgba(0, 0, 0, 0.87)',\r\n\tdefaultBgColor: '#FFF',\r\n\tfrozenRowsBgColor: '#FFF',\r\n\tfrozenRowsColor: 'rgba(0, 0, 0, 0.54)',\r\n\thiliteBorderColor: '#5E9ED6',\r\n\tselectionBgColor: '#CCE0FF',\r\n\tborderColor: BORDER_COLOR,\r\n\tfrozenRowsBorderColor: FROZEN_ROWS_BORDER_COLOR,\r\n\tcheckbox: {\r\n\t\tuncheckBgColor: '#FFF',\r\n\t\tcheckBgColor: 'rgb(76, 73, 72)',\r\n\t\tborderColor: 'rgba(0, 0, 0, 0.26)',\r\n\t},\r\n\tbutton: {\r\n\t\tcolor: '#FFF',\r\n\t\tbgColor: '#2196F3',\r\n\t},\r\n\tunderlayBackgroundColor: '#FFF',\r\n};","/*eslint no-bitwise:0*/\r\n'use strict';\r\n{\r\n\tconst {getChainSafe} = require('../internal/utils');\r\n\tconst defaultTheme = require('./MATERIAL_DESIGN');\r\n\r\n\tfunction getProp(obj, superObj, names, defNames) {\r\n\t\treturn getChainSafe(obj, ...names) ||\r\n\t\t(defNames && getChainSafe(obj, ...defNames)) ||\r\n\t\tgetChainSafe(superObj, ...names);\r\n\t}\r\n\tfunction createTheme(obj = {}, superTheme = defaultTheme) {\r\n\t\treturn {\r\n\t\t\tget font() {\r\n\t\t\t\treturn getProp(obj, superTheme, ['font']);\r\n\t\t\t},\r\n\t\t\tget underlayBackgroundColor() {\r\n\t\t\t\treturn getProp(obj, superTheme, ['underlayBackgroundColor']);\r\n\t\t\t},\r\n\t\t\t// color\r\n\t\t\tget color() {\r\n\t\t\t\treturn getProp(obj, superTheme, ['color']);\r\n\t\t\t},\r\n\t\t\tget frozenRowsColor() {\r\n\t\t\t\treturn getProp(obj, superTheme, ['frozenRowsColor'], ['color']);\r\n\t\t\t},\r\n\t\t\t// background\r\n\t\t\tget defaultBgColor() {\r\n\t\t\t\treturn getProp(obj, superTheme, ['defaultBgColor']);\r\n\t\t\t},\r\n\t\t\tget frozenRowsBgColor() {\r\n\t\t\t\treturn getProp(obj, superTheme, ['frozenRowsBgColor'], ['defaultBgColor']);\r\n\t\t\t},\r\n\t\t\tget selectionBgColor() {\r\n\t\t\t\treturn getProp(obj, superTheme, ['selectionBgColor'], ['defaultBgColor']);\r\n\t\t\t},\r\n\t\t\t// border\r\n\t\t\tget borderColor() {\r\n\t\t\t\treturn getProp(obj, superTheme, ['borderColor']);\r\n\t\t\t},\r\n\t\t\tget frozenRowsBorderColor() {\r\n\t\t\t\treturn getProp(obj, superTheme, ['frozenRowsBorderColor'], ['borderColor']);\r\n\t\t\t},\r\n\t\t\tget hiliteBorderColor() {\r\n\t\t\t\treturn getProp(obj, superTheme, ['hiliteBorderColor'], ['borderColor']);\r\n\t\t\t},\r\n\t\t\tget checkbox() {\r\n\t\t\t\treturn this._checkbox || (this._checkbox = {\r\n\t\t\t\t\tget uncheckBgColor() {\r\n\t\t\t\t\t\treturn getProp(obj, superTheme, ['checkbox', 'uncheckBgColor'], ['defaultBgColor']);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tget checkBgColor() {\r\n\t\t\t\t\t\treturn getProp(obj, superTheme, ['checkbox', 'checkBgColor'], ['defaultBgColor']);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tget borderColor() {\r\n\t\t\t\t\t\treturn getProp(obj, superTheme, ['checkbox', 'borderColor'], ['borderColor']);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tget button() {\r\n\t\t\t\treturn this._button || (this._button = {\r\n\t\t\t\t\tget color() {\r\n\t\t\t\t\t\treturn getProp(obj, superTheme, ['button', 'color'], ['color']);\r\n\t\t\t\t\t},\r\n\t\t\t\t\tget bgColor() {\r\n\t\t\t\t\t\treturn getProp(obj, superTheme, ['button', 'bgColor'], ['defaultBgColor']);\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\textends(obj) {\r\n\t\t\t\treturn createTheme(obj, this);\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * theme object\r\n\t * @type {Object}\r\n\t * @namespace cheetahGrid.themes.theme\r\n\t * @memberof cheetahGrid.themes\r\n\t */\r\n\tmodule.exports = {\r\n\t\tcreate(obj) {\r\n\t\t\treturn createTheme(obj);\r\n\t\t}\r\n\t};\r\n}","'use strict';\r\n{\r\n\tconst canvashelper = require('./tools/canvashelper');\r\n\r\n\t/**\r\n\t * tools\r\n\t * @type {Object}\r\n\t * @namespace cheetahGrid.tools\r\n\t * @memberof cheetahGrid\r\n\t */\r\n\tmodule.exports = {\r\n\t\tcanvashelper,\r\n\t};\r\n}","'use strict';\r\n{\r\n\tconst {calcBasePosition, calcStartPosition} = require('../internal/canvases');\r\n\tconst {ceil, PI} = Math;\r\n\r\n\tfunction strokeColorsRect(ctx, borderColors, left, top, width, height) {\r\n\t\tfunction strokeRectLines(positions) {\r\n\t\t\tfor (let i = 0; i < borderColors.length; i++) {\r\n\t\t\t\tconst color = borderColors[i];\r\n\t\t\t\tconst preColor = borderColors[i - 1];\r\n\t\t\t\tif (color) {\r\n\t\t\t\t\tif (preColor !== color) {\r\n\t\t\t\t\t\tif (preColor) {\r\n\t\t\t\t\t\t\tctx.strokeStyle = preColor;\r\n\t\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst pos1 = positions[i];\r\n\t\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\t\tctx.moveTo(pos1.x, pos1.y);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst pos2 = positions[i + 1];\r\n\t\t\t\t\tctx.lineTo(pos2.x, pos2.y);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tif (preColor) {\r\n\t\t\t\t\t\tctx.strokeStyle = preColor;\r\n\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconst preColor = borderColors[borderColors.length - 1];\r\n\t\t\tif (preColor) {\r\n\t\t\t\tctx.strokeStyle = preColor;\r\n\t\t\t\tctx.stroke();\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (borderColors[0] === borderColors[1] &&\r\n\t\t\tborderColors[0] === borderColors[2] &&\r\n\t\t\tborderColors[0] === borderColors[3]) {\r\n\t\t\tif (borderColors[0]) {\r\n\t\t\t\tctx.strokeStyle = borderColors[0];\r\n\t\t\t\tctx.strokeRect(left, top, width, height);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tstrokeRectLines([\r\n\t\t\t\t{x: left, y: top},\r\n\t\t\t\t{x: left + width, y: top},\r\n\t\t\t\t{x: left + width, y: top + height},\r\n\t\t\t\t{x: left, y: top + height},\r\n\t\t\t\t{x: left, y: top},\r\n\t\t\t]);\r\n\t\t}\r\n\t}\r\n\tfunction roundRect(ctx, left, top, width, height, radius) {\r\n\t\tctx.beginPath();\r\n\t\tctx.arc(left + radius, top + radius, radius, -PI, -0.5 * PI, false);\r\n\t\tctx.arc(left + width - radius, top + radius, radius, -0.5 * PI, 0, false);\r\n\t\tctx.arc(left + width - radius, top + height - radius, radius, 0, 0.5 * PI, false);\r\n\t\tctx.arc(left + radius, top + height - radius, radius, 0.5 * PI, PI, false);\r\n\t\tctx.closePath();\r\n\t}\r\n\tfunction fillRoundRect(ctx, left, top, width, height, radius) {\r\n\t\troundRect(ctx, left, top, width, height, radius);\r\n\t\tctx.fill();\r\n\t}\r\n\tfunction strokeRoundRect(ctx, left, top, width, height, radius) {\r\n\t\troundRect(ctx, left, top, width, height, radius);\r\n\t\tctx.stroke();\r\n\t}\r\n\tfunction fillTextRect(ctx, text, left, top, width, height,\r\n\t\t\t{\r\n\t\t\t\toffset = 2,\r\n\t\t\t\tpadding,\r\n\t\t\t} = {}) {\r\n\t\tconst rect = {\r\n\t\t\tleft,\r\n\t\t\ttop,\r\n\t\t\twidth,\r\n\t\t\theight,\r\n\t\t\tright: left + width,\r\n\t\t\tbottom: top + height,\r\n\t\t};\r\n\t\tctx.save();\r\n\t\ttry {\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.rect(rect.left, rect.top, rect.width, rect.height);\r\n\t\t\t//clip\r\n\t\t\tctx.clip();\r\n\r\n\t\t\t//\r\n\t\t\tconst pos = calcBasePosition(ctx, rect, {\r\n\t\t\t\toffset,\r\n\t\t\t\tpadding\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tctx.fillText(text, pos.x, pos.y);\r\n\t\t} finally {\r\n\t\t\tctx.restore();\r\n\t\t}\r\n\t}\r\n\tfunction drawInlineImageRect(ctx, image,\r\n\t\t\tsrcLeft, srcTop, srcWidth, srcHeight,\r\n\t\t\tdestWidth, destHeight,\r\n\t\t\tleft, top, width, height,\r\n\t\t\t{\r\n\t\t\t\toffset = 2,\r\n\t\t\t\tpadding,\r\n\t\t\t} = {}) {\r\n\t\tconst rect = {\r\n\t\t\tleft,\r\n\t\t\ttop,\r\n\t\t\twidth,\r\n\t\t\theight,\r\n\t\t\tright: left + width,\r\n\t\t\tbottom: top + height,\r\n\t\t};\r\n\t\tctx.save();\r\n\t\ttry {\r\n\t\t\tctx.beginPath();\r\n\t\t\tctx.rect(rect.left, rect.top, rect.width, rect.height);\r\n\t\t\t//clip\r\n\t\t\tctx.clip();\r\n\r\n\t\t\t//\r\n\t\t\tconst pos = calcStartPosition(ctx, rect, destWidth, destHeight, {\r\n\t\t\t\toffset,\r\n\t\t\t\tpadding\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tctx.drawImage(image,\r\n\t\t\t\t\tsrcLeft, srcTop, srcWidth, srcHeight,\r\n\t\t\t\t\tpos.x, pos.y, destWidth, destHeight\r\n\t\t\t);\r\n\t\t} finally {\r\n\t\t\tctx.restore();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Returns an object containing the width of the checkbox.\r\n\t * @param  {CanvasRenderingContext2D} ctx canvas context\r\n\t * @return {Object} Object containing the width of the checkbox\r\n\t * @memberof cheetahGrid.tools.canvashelper\r\n\t */\r\n\tfunction measureCheckbox(ctx) {\r\n\t\treturn {\r\n\t\t\twidth: ctx.measureText('').width\r\n\t\t};\r\n\t}\r\n\t\t\r\n\t/**\r\n\t * draw Checkbox\r\n\t * @param  {CanvasRenderingContext2D} ctx canvas context\r\n\t * @param  {number} x The x coordinate where to start drawing the checkbox (relative to the canvas)\r\n\t * @param  {number} y The y coordinate where to start drawing the checkbox (relative to the canvas)\r\n\t * @param  {boolean|number} check checkbox check status\r\n\t * @param  {object} option option\r\n\t * @return {void}\r\n\t * @memberof cheetahGrid.tools.canvashelper\r\n\t */\r\n\tfunction drawCheckbox(ctx, x, y, check,\r\n\t\t\t{\r\n\t\t\t\tuncheckBgColor = '#FFF',\r\n\t\t\t\tcheckBgColor = 'rgb(76, 73, 72)',\r\n\t\t\t\tborderColor = '#000',\r\n\t\t\t\tboxSize = measureCheckbox(ctx).width,\r\n\t\t\t} = {}) {\r\n\t\tconst checkPoint = typeof check === 'number' ? (check > 1 ? 1 : check) : 1;\r\n\r\n\t\tctx.save();\r\n\t\ttry {\r\n\t\t\tctx.fillStyle = check ? checkBgColor : uncheckBgColor;\r\n\t\t\t\r\n\t\t\tfillRoundRect(\r\n\t\t\t\t\tctx,\r\n\t\t\t\t\tceil(x) - 1,\r\n\t\t\t\t\tceil(y) - 1,\r\n\t\t\t\t\tceil(boxSize + 1),\r\n\t\t\t\t\tceil(boxSize + 1),\r\n\t\t\t\t\tboxSize / 5\r\n\t\t\t);\r\n\t\t\tctx.lineWidth = 1;\r\n\t\t\tctx.strokeStyle = borderColor;\r\n\t\t\tstrokeRoundRect(\r\n\t\t\t\t\tctx,\r\n\t\t\t\t\tceil(x) - 0.5,\r\n\t\t\t\t\tceil(y) - 0.5,\r\n\t\t\t\t\tceil(boxSize),\r\n\t\t\t\t\tceil(boxSize),\r\n\t\t\t\t\tboxSize / 5\r\n\t\t\t);\r\n\t\t\tif (check) {\r\n\t\t\t\tctx.lineWidth = ceil(boxSize / 10);\r\n\t\t\t\tctx.strokeStyle = uncheckBgColor;\r\n\t\t\t\tlet leftWidth = boxSize / 4;\r\n\t\t\t\tlet rightWidth = boxSize / 2 * 0.9;\r\n\t\t\t\tconst leftLeftPos = x + boxSize * 0.2;\r\n\t\t\t\tconst leftTopPos = y + boxSize / 2;\r\n\r\n\t\t\t\tif (checkPoint < 0.5) {\r\n\t\t\t\t\tleftWidth = leftWidth * (checkPoint * 2);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tctx.beginPath();\r\n\t\t\t\tctx.moveTo(leftLeftPos, leftTopPos);\r\n\t\t\t\tctx.lineTo(leftLeftPos + leftWidth, leftTopPos + leftWidth);\r\n\t\t\t\tif (checkPoint > 0.5) {\r\n\t\t\t\t\tif (checkPoint < 1) {\r\n\t\t\t\t\t\trightWidth = rightWidth * ((checkPoint - 0.5) * 2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tctx.lineTo(leftLeftPos + leftWidth + rightWidth, leftTopPos + leftWidth - rightWidth);\r\n\t\t\t\t}\r\n\t\t\t\tctx.stroke();\r\n\t\t\t}\r\n\t\t} finally {\r\n\t\t\tctx.restore();\r\n\t\t}\r\n\t}\r\n\tfunction drawButton(ctx, left, top, width, height, option = {}) {\r\n\t\tconst {\r\n\t\t\tbackgroundColor = '#FFF',\r\n\t\t\tbgColor = backgroundColor,\r\n\t\t\tradius = 4,\r\n\t\t\tshadow = {},\r\n\t\t} = option;\r\n\t\tctx.save();\r\n\t\ttry {\r\n\t\t\tctx.fillStyle = bgColor;\r\n\r\n\t\t\tif (shadow) {\r\n\t\t\t\tconst {\r\n\t\t\t\t\tcolor = 'rgba(0, 0, 0, 0.24)',\r\n\t\t\t\t\tblur = 1,\r\n\t\t\t\t\toffsetX = 0,\r\n\t\t\t\t\toffsetY = 2,\r\n\t\t\t\t\toffset: {\r\n\t\t\t\t\t\tx: ox = offsetX,\r\n\t\t\t\t\t\ty: oy = offsetY\r\n\t\t\t\t\t} = {},\r\n\t\t\t\t} = shadow;\r\n\t\t\t\tctx.shadowColor = color;\r\n\t\t\t\tctx.shadowBlur = blur; //\r\n\t\t\t\tctx.shadowOffsetX = ox;\r\n\t\t\t\tctx.shadowOffsetY = oy;\r\n\t\t\t}\r\n\r\n\t\t\tfillRoundRect(\r\n\t\t\t\t\tctx,\r\n\t\t\t\t\tceil(left),\r\n\t\t\t\t\tceil(top),\r\n\t\t\t\t\tceil(width),\r\n\t\t\t\t\tceil(height),\r\n\t\t\t\t\tradius\r\n\t\t\t);\r\n\t\t} finally {\r\n\t\t\tctx.restore();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * canvashelper\r\n\t * @type {Object}\r\n\t * @namespace cheetahGrid.tools.canvashelper\r\n\t * @memberof cheetahGrid.tools\r\n\t */\r\n\tconst canvashelper = {\r\n\t\troundRect,\r\n\t\tfillRoundRect,\r\n\t\tstrokeRoundRect,\r\n\t\tdrawCheckbox,\r\n\t\tmeasureCheckbox,\r\n\t\tfillTextRect,\r\n\t\tdrawButton,\r\n\t\tdrawInlineImageRect,\r\n\t\tstrokeColorsRect,\r\n\t};\r\n\r\n\r\n\tmodule.exports = canvashelper;\r\n}"],"sourceRoot":""}